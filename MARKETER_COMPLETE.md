# ‚úÖ Marketer (–ü–æ—Å—Ç–µ—Ä) - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`services/marketer/poster.py`** - –ú–æ–¥—É–ª—å SmartPoster (330+ —Å—Ç—Ä–æ–∫)
2. **`config/marketing_posts.json`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∏—à
3. **`MARKETER_SETUP.md`** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. –û–±–Ω–æ–≤–ª–µ–Ω—ã **`crontab.*`** —Ñ–∞–π–ª—ã —Å –∑–∞–¥–∞—á–∞–º–∏ –ø–æ—Å—Ç–∏–Ω–≥–∞

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ ‚úÖ
- ‚úÖ –ü–æ–∏—Å–∫ –≥—Ä—É–ø–ø —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `joined`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ warm-up –ø–µ—Ä–∏–æ–¥–∞ (`warmup_ends_at < NOW()`)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (`assigned_account_id`)
- ‚úÖ –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ (2 –ø–æ—Å—Ç–∞/–≥—Ä—É–ø–ø—É, 20 –ø–æ—Å—Ç–æ–≤/–∞–∫–∫–∞—É–Ω—Ç)

### 2. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ ‚úÖ
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ + —Ñ–æ—Ç–æ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–∞ (–µ—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ—Ç)
- ‚úÖ –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ—Å—Ç–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `last_post_at`

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚úÖ
- ‚úÖ FloodWait: –ø–æ–º–µ—Ç–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞, –ø—Ä–æ–ø—É—Å–∫ –≥—Ä—É–ø–ø—ã
- ‚úÖ ChatWriteForbiddenError: –≥—Ä—É–ø–ø–∞ ‚Üí `banned`
- ‚úÖ UserBannedInChannelError: –≥—Ä—É–ø–ø–∞ ‚Üí `banned`
- ‚úÖ –ó–∞–ø–∏—Å—å –≤ `post_history` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `DbManager.get_groups_ready_for_posting()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `DbManager.record_post()` –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `DbManager.set_account_flood_wait()` –¥–ª—è FloodWait
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–∑ `accounts_config.json`

## üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ Cron

### Bali
- **Marketer**: –í 10:00 –∏ 16:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ (`0 10,16 * * *`)

### Ukraine
- **Marketer**: –í 09:00 –∏ 18:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ (`0 9,18 * * *`)

## üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏—Å—Ç–µ–º—ã

```
Scout (–ü–∞—Ä—Å–µ—Ä)
    ‚Üì
–ë–î: status='new'
    ‚Üì
Smart Joiner (–í—Å—Ç—É–ø–∞—Ç–æ—Ä)
    ‚Üì
–ë–î: status='joined', warmup_ends_at = NOW() + 24h
    ‚Üì
[–û–∂–∏–¥–∞–Ω–∏–µ 24 —á–∞—Å–∞]
    ‚Üì
Marketer (–ü–æ—Å—Ç–µ—Ä)
    ‚Üì
–ë–î: last_post_at = NOW(), –∑–∞–ø–∏—Å—å –≤ post_history
    ‚Üì
Secretary (–°–µ–∫—Ä–µ—Ç–∞—Ä—å) - –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –¢–µ—Å—Ç –ø–æ—Å—Ç–∏–Ω–≥–∞
docker exec bali-marketer python3 /app/services/marketer/poster.py bali_rent 5
docker exec ukraine-marketer python3 /app/services/marketer/poster.py ukraine_cars 5
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

Cron –∑–∞–¥–∞—á–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
./install-cron.sh
# –∏–ª–∏
crontab crontab.combined
```

## üìä –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config/marketing_posts.json` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤ –∏ —Ñ–æ—Ç–æ.

**–ü—É—Ç–∏ –∫ —Ñ–æ—Ç–æ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/app/assets/` (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ `data/{PROJECT_NAME}/assets/`)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `null` –¥–ª—è –ø–æ—Å—Ç–æ–≤ –±–µ–∑ —Ñ–æ—Ç–æ

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–∫–Ω—É—Ç–∞:
1. ‚úÖ Scout –Ω–∞—Ö–æ–¥–∏—Ç –≥—Ä—É–ø–ø—ã
2. ‚úÖ Joiner –≤—Å—Ç—É–ø–∞–µ—Ç –∏ –≥—Ä–µ–µ—Ç
3. ‚úÖ Marketer –ø–æ—Å—Ç–∏—Ç —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
4. ‚úÖ Secretary –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ `data/{PROJECT_NAME}/assets/` –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ! üöÄ
