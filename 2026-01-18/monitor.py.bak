from telethon import TelegramClient, events
from telethon.tl.types import PeerChannel, PeerChat, PeerUser
import re
from patterns import PATTERNS, NICHES_KEYWORDS, SPAM_FILTERS
from datetime import datetime
import asyncio
import logging
import json
from config import API_ID, API_HASH, PHONE_NUMBER, MONITORING_CONFIG, BOT_TOKEN, DB_DSN
from aiogram import Bot, Dispatcher, types
from aiogram.dispatcher.filters import Command
from aiogram.types import Message
from database import Database
from content import MONITORING_TOPICS
from typing import Dict, List, Set
from ai_classifier import AIClassifier
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram.utils.exceptions import TelegramAPIError

logger = logging.getLogger(__name__)

class MessageMonitor:
    def __init__(self, bot: Bot, db, openai_api_key: str = None):
        self.bot = bot
        self.db = db
        self.listening_chats = MONITORING_CONFIG["listening_chats"]
        self.disallowed_keywords = MONITORING_CONFIG["disallowed_keywords"]
        self.disallowed_users = MONITORING_CONFIG["disallowed_users"]
        self.user_keywords: Dict[int, Dict[str, List[str]]] = {}
        self.topic_keywords: Dict[str, Set[str]] = {}
        self.user_topics: Dict[int, Set[str]] = {}
        self.user_settings: Dict[int, Dict] = {}
        self.message_queue: Dict[int, List[str]] = {}
        self.message_cache: Dict[str, Set[int]] = {}  # Cache for processed messages
        self.subscribers: Dict[int, Set[str]] = {}  # user_id -> set of niches
        self.patterns = NICHES_KEYWORDS  # –ò—Å–ø–æ–ª—å–∑—É–µ–º NICHES_KEYWORDS –≤–º–µ—Å—Ç–æ PATTERNS
        
        # ‚ö° –ö–û–ú–ü–ò–õ–Ø–¶–ò–Ø –ü–ê–¢–¢–ï–†–ù–û–í –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ - –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –æ–±—ä–µ–∫—Ç—ã Regex –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        self._compile_patterns()
        
        self._load_topics()
        
        # –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        self.message_hashes: Dict[str, datetime] = {}  # message_hash -> timestamp (–¥–ª—è process_message_from_subscriber)
        self.global_message_text_hashes: Dict[str, datetime] = {}  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –ø–æ —Ç–µ–∫—Å—Ç—É (–±–µ–∑ sender_id –∏ chat_title)
        self.duplicate_window = 3600  # 1 —á–∞—Å - –æ–∫–Ω–æ –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
        
        # AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        self.ai_classifier = None
        if openai_api_key:
            try:
                self.ai_classifier = AIClassifier(openai_api_key)
                logger.info("ü§ñ AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
            except Exception as e:
                logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä: {e}")
                self.ai_classifier = None

    def _create_message_hash(self, message_text: str, sender_id: int) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ö–µ—à —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        –£–±–∏—Ä–∞–µ—Ç markdown –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        """
        import hashlib
        import re
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç: —É–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        normalized_text = re.sub(r'\*+', '', message_text)  # –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏
        normalized_text = re.sub(r'_+', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
        normalized_text = re.sub(r'`+', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        normalized_text = re.sub(r'\\', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
        normalized_text = ' '.join(normalized_text.lower().split())
        # –°–æ–∑–¥–∞–µ–º —Ö–µ—à –∏–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        # –û–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω —Ö–µ—à –≤–æ –≤—Å–µ—Ö —á–∞—Ç–∞—Ö
        hash_input = f"{normalized_text}:{sender_id}"
        return hashlib.md5(hash_input.encode('utf-8')).hexdigest()
    
    def _create_text_only_hash(self, message_text: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç —Ö–µ—à —Å–æ–æ–±—â–µ–Ω–∏—è –¢–û–õ–¨–ö–û –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞ (–±–µ–∑ sender_id –∏ chat_title)
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö —á–∞—Ç–æ–≤
        """
        import hashlib
        import re
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç: —É–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        normalized_text = re.sub(r'\*+', '', message_text)  # –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏
        normalized_text = re.sub(r'_+', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
        normalized_text = re.sub(r'`+', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        normalized_text = re.sub(r'\\', '', normalized_text)  # –£–±–∏—Ä–∞–µ–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –ª—É—á—à–µ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
        normalized_text = re.sub(r'[üÜòüö®‚ö†Ô∏èüîîüí¨üìùüë§üí¨üîóüìÇüîçüíº‚úÖ‚ùåüö´üîπ‚ñ™Ô∏èü§ùüí™]+', '', normalized_text)
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
        normalized_text = ' '.join(normalized_text.lower().split())
        # –°–æ–∑–¥–∞–µ–º —Ö–µ—à —Ç–æ–ª—å–∫–æ –∏–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        return hashlib.md5(normalized_text.encode('utf-8')).hexdigest()
    
    def _is_global_duplicate_text(self, message_text: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –¥—É–±–ª–∏–∫–∞—Ç–æ–º (–ø–æ —Ç–µ–∫—Å—Ç—É, –±–µ–∑ —É—á–µ—Ç–∞ sender_id –∏ chat_title)
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö —á–∞—Ç–æ–≤
        """
        text_hash = self._create_text_only_hash(message_text)
        current_time = datetime.now()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–æ–π —Ö–µ—à –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –∫—ç—à–µ
        if text_hash in self.global_message_text_hashes:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—Å—Ç–∞—Ä–µ–ª –ª–∏ —Ö–µ—à
            if (current_time - self.global_message_text_hashes[text_hash]).total_seconds() < self.duplicate_window:
                logger.info(f"üîÑ –ù–∞–π–¥–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –¥—É–±–ª–∏–∫–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Ä–∞–∑–Ω—ã—Ö —á–∞—Ç–æ–≤)")
                return True
        
        # –ï—Å–ª–∏ —Ö–µ—à–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω —É—Å—Ç–∞—Ä–µ–ª, –æ–±–Ω–æ–≤–ª—è–µ–º –∫—ç—à
        self.global_message_text_hashes[text_hash] = current_time
        
        # –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ö–µ—à–∏ (—Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
        old_hashes = []
        for hash_key, timestamp in self.global_message_text_hashes.items():
            if (current_time - timestamp).total_seconds() > 86400:  # 24 —á–∞—Å–∞
                old_hashes.append(hash_key)
        
        for hash_key in old_hashes:
            del self.global_message_text_hashes[hash_key]
        
        return False

    def _is_duplicate_message(self, message_text: str, sender_id: int) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–º
        """
        message_hash = self._create_message_hash(message_text, sender_id)
        current_time = datetime.now()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–æ–π —Ö–µ—à –≤ –∫—ç—à–µ
        if message_hash in self.message_hashes:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—Å—Ç–∞—Ä–µ–ª –ª–∏ —Ö–µ—à
            if (current_time - self.message_hashes[message_hash]).total_seconds() < self.duplicate_window:
                logger.info(f"üîÑ –ù–∞–π–¥–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {sender_id}")
                return True
        
        # –ï—Å–ª–∏ —Ö–µ—à–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω —É—Å—Ç–∞—Ä–µ–ª, –æ–±–Ω–æ–≤–ª—è–µ–º –∫—ç—à
        self.message_hashes[message_hash] = current_time
        
        # –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ö–µ—à–∏ (—Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
        old_hashes = []
        for hash_key, timestamp in self.message_hashes.items():
            if (current_time - timestamp).total_seconds() > 86400:  # 24 —á–∞—Å–∞
                old_hashes.append(hash_key)
        
        for hash_key in old_hashes:
            del self.message_hashes[hash_key]
        
        return False

    def _compile_patterns(self):
        """
        –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ NICHES_KEYWORDS –≤ –æ–±—ä–µ–∫—Ç—ã Regex –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏.
        –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞.
        self.patterns —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω NICHES_KEYWORDS (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ __init__).
        """
        self.compiled_patterns = {}
        # self.patterns —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω NICHES_KEYWORDS (–ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–Ω –Ω–µ –ø—É—Å—Ç–æ–π)
        if not self.patterns:
            logger.error("‚ùå –û–®–ò–ë–ö–ê: self.patterns –ø—É—Å—Ç–æ–π! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ __init__ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: self.patterns = NICHES_KEYWORDS")
            return
        
        for niche, patterns_list in self.patterns.items():
            self.compiled_patterns[niche] = []
            for pattern in patterns_list:
                try:
                    # re.IGNORECASE –¥–µ–ª–∞–µ—Ç –ø–æ–∏—Å–∫ –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É (–§–æ—Ç–æ–≥—Ä–∞—Ñ = —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ)
                    self.compiled_patterns[niche].append(re.compile(pattern, re.IGNORECASE))
                except re.error as e:
                    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ regex –¥–ª—è –Ω–∏—à–∏ {niche}: {pattern} -> {e}")
        
        total_patterns = sum(len(patterns) for patterns in self.compiled_patterns.values())
        logger.info(f"‚ö° –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã. –í—Å–µ–≥–æ –Ω–∏—à: {len(self.compiled_patterns)}, –≤—Å–µ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: {total_patterns}")

    async def _hybrid_classify_message(self, message_text: str, sender_username: str = None) -> Dict:
        """
        –ì–∏–±—Ä–∏–¥–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è: 
        1. –°–ù–ê–ß–ê–õ–ê –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SPAM_FILTERS –∏–∑ patterns.py
        2. –ü–û–¢–û–ú –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ NICHES_KEYWORDS
        3. –¢–û–õ–¨–ö–û –ï–°–õ–ò –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º AI
        –≠–ö–û–ù–û–ú–ò–Ø API: AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏
        """
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø] –ù–∞—á–∞–ª–æ –≥–∏–±—Ä–∏–¥–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è: {message_text[:100]}...")
        
        # –ü–†–û–í–ï–†–ö–ê –ù–ê –°–ü–ê–ú –£–ñ–ï –í–´–ü–û–õ–ù–ï–ù–ê –Ω–∞ —É—Ä–æ–≤–Ω–µ handle_source_message
        # –ù–µ –¥—É–±–ª–∏—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–µ—Å—å - —ç—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É –≤ 2 —Ä–∞–∑–∞
        logger.debug("‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ handle_source_message, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é")
        
        # -----------------------------------------------------------------
        # üè¢ –†–ê–ù–ù–Ø–Ø –ü–†–û–í–ï–†–ö–ê –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–´ (–ü–ï–†–í–û–ô, –¥–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫)
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã, –º–∞–≥–∞–∑–∏–Ω—ã, –∞–ø—Ç–µ–∫–∏ –∏ —Ç.–¥.
        # –µ—Å–ª–∏ –≤ –Ω–∏—Ö –ù–ï–¢ —Å–ª–æ–≤ –ø—Ä–æ –∂–∏–ª—å–µ (—Å–Ω—è—Ç—å/—Å–¥–∞—Ç—å/–∞—Ä–µ–Ω–¥–∞/–≤–∏–ª–ª–∞/–¥–æ–º/–∫–≤–∞—Ä—Ç–∏—Ä–∞)
        # -----------------------------------------------------------------
        text = message_text.lower()
        infrastructure_blacklist = [
            r'\b—Ç—Ü\b', r'—Ç–æ—Ä–≥–æ–≤[—ã–π—ã–π].*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤—ã–π\s+—Ü–µ–Ω—Ç—Ä',
            r'–º–æ–ª–ª', r'\bmall\b', r'—à–æ–ø–ø–∏–Ω–≥.*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤[–∞—è].*–ø–ª–æ—â–∞–¥–∫',
            r'–º–∞–≥–∞–∑–∏–Ω', r'—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç', r'–∞–ø—Ç–µ–∫[–∞—É]', r'—Ä–µ—Å—Ç–æ—Ä–∞–Ω', r'–∫–∞—Ñ–µ',
            r'–±–∞–Ω–∫', r'–±–∞–Ω–∫–æ–º–∞—Ç', r'–∞—Ç–º', r'–±–æ–ª—å–Ω–∏—Ü[–∞—É]', r'–∫–ª–∏–Ω–∏–∫[–∞—É]',
            r'—à–∫–æ–ª[–∞—É]', r'–¥–µ—Ç—Å–∫[–∏–π].*—Å–∞–¥', r'—Å–ø–æ—Ä—Ç–∑–∞–ª', r'—Ñ–∏—Ç–Ω–µ—Å',
            r'–∑–∞–ø—Ä–∞–≤–∫[–∞—É]', r'–±–µ–Ω–∑–æ–∫–æ–ª–æ–Ω–∫[–∞—É]', r'–∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å',
            r'–∫—Ç–æ\s+–∑–Ω–∞–µ—Ç\s+–≥–¥–µ', r'–≥–¥–µ\s+–Ω–∞–π—Ç–∏', r'–≥–¥–µ\s+–µ—Å—Ç—å'
        ]
        
        housing_keywords = [
            r'—Å–Ω—è—Ç—å', r'—Å–¥–∞—Ç—å', r'–∞—Ä–µ–Ω–¥[–∞—É]', r'–≤–∏–ª–ª[–∞—É]', r'\b–¥–æ–º\b', r'–∫–≤–∞—Ä—Ç–∏—Ä[–∞—É]',
            r'–∫–æ–º–Ω–∞—Ç[–∞—É]', r'–∂–∏–ª—å[–µ—ë]', r'–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'—Å—Ç—É–¥–∏[—è—é]', r'–∫–æ–Ω–¥–æ'
        ]
        
        has_infrastructure = any(re.search(bp, text, re.IGNORECASE) for bp in infrastructure_blacklist)
        has_housing = any(re.search(kw, text, re.IGNORECASE) for kw in housing_keywords)
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–æ–≤–∞ –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ò –Ω–µ—Ç —Å–ª–æ–≤ –ø—Ä–æ –∂–∏–ª—å–µ - –±–ª–æ–∫–∏—Ä—É–µ–º —Å—Ä–∞–∑—É
        if has_infrastructure and not has_housing:
            logger.info(f"üõë [–†–ê–ù–ù–Ø–Ø –ü–†–û–í–ï–†–ö–ê] –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ (–∑–∞–ø—Ä–æ—Å –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É/–º–∞–≥–∞–∑–∏–Ω—ã, –∞ –Ω–µ –∂–∏–ª—å–µ): {message_text[:100]}")
            return {
                "message_type": "–ü–û–ò–°–ö",
                "is_spam": False,
                "niches": [],
                "context": "–ó–∞–ø—Ä–æ—Å –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (–º–∞–≥–∞–∑–∏–Ω—ã/–¢–¶/–∞–ø—Ç–µ–∫–∏), –∞ –Ω–µ –∂–∏–ª—å–µ",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 0,
                "reason": "Infrastructure filter (early check)"
            }
        # -----------------------------------------------------------------
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–æ–≤ (–Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º)
        welcome_bot_patterns = [
            r'–¥–æ–±—Ä–æ\s+–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å', r'–¥–æ–±—Ä–æ\s+–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å\s+–≤\s+–≥—Ä—É–ø–ø—É', r'welcome\s+to',
            r'–¥–æ–±—Ä–æ\s+–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å.*–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', r'–¥–æ–±—Ä–æ\s+–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å.*–±–∞–ª–∏',
            r'–Ω–µ\s+–Ω—É–∂–Ω–æ\s+–±—ã—Ç—å\s+–≥–µ–Ω–∏–µ–º.*–º–Ω–æ–≥–æ\s+–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å',  # –°–ø–∞–º-—Ä–µ–∫–ª–∞–º–∞ –≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è—Ö
        ]
        text_lower_check = message_text.lower()
        for pattern in welcome_bot_patterns:
            if re.search(pattern, text_lower_check, re.IGNORECASE):
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —ç—Ç–æ –æ—Ç –±–æ—Ç–∞ (ChatKeeperBot, FriendlyAdminBot –∏ —Ç.–¥.)
                if sender_username and ('bot' in sender_username.lower() or 'keeper' in sender_username.lower()):
                    logger.info(f"üö´ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞: {sender_username}")
                # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞–π–¥–µ–Ω
                return {
                    "message_type": "–û–ë–©–ï–ù–ò–ï",
                    "is_spam": False,
                    "niches": [],
                    "context": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞",
                    "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                    "budget": "",
                    "confidence": 100,
                    "reason": "Welcome bot message"
                }

        # 1.5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –∫–∞–Ω–∞–ª–æ–≤/—Å—Å—ã–ª–æ–∫ (–Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º)
        # –¢–∞–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –º–Ω–æ–≥–æ @username, —ç–º–æ–¥–∑–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
        username_count = len(re.findall(r'@\w+', message_text))
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏ –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ (–≤–∫–ª—é—á–∞—è –≤—Å–µ Unicode —ç–º–æ–¥–∑–∏)
        emoji_count = sum(1 for c in message_text if (ord(c) > 0x1F600 and ord(c) < 0x1F64F) or 
                                                      (ord(c) > 0x1F300 and ord(c) < 0x1F5FF) or
                                                      (ord(c) > 0x1F680 and ord(c) < 0x1F6FF) or
                                                      (ord(c) > 0x1F1E0 and ord(c) < 0x1F1FF) or
                                                      (ord(c) > 0x2600 and ord(c) < 0x26FF) or
                                                      (ord(c) > 0x2700 and ord(c) < 0x27BF) or
                                                      c in ['üå¥', 'üèñ', 'üìÜ', 'üéâ', 'üè°', 'üöò', 'üõµ', '‚úàÔ∏è', 'üë®', 'üí∞', 'üíµ', 'üöÄ', 'üèó', 'üïâ', 'üßò', 'üë©', 'üíÑ', 'üëó', 'üíÜ', 'üíû', 'ü§µ', 'üíÉ', 'üß∏', 'ü•≠', 'üç±', 'üé•', 'üé≤', 'üèÑ', 'üó∫', 'üõí', 'üí∂', 'üì¶', '‚öôÔ∏è', 'üöï'])
        channel_list_keywords = [r'–¥–µ–ª–∏—Ç–µ—Å—å.*—Å—Å—ã–ª–∫', r'—Ä–∞–∑–≤–∏–≤–∞—Ç—å.*–∫–æ–º—å—é–Ω–∏—Ç–∏', r'—á–∞—Ç–∏–∫.*@', r'–∫–∞–Ω–∞–ª.*@', r'–≥—Ä—É–ø–ø[–∞—ã].*@']
        has_channel_list_keywords = any(re.search(kw, message_text.lower(), re.IGNORECASE) for kw in channel_list_keywords)
        
        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ @username (>= 5) –∏ –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ (>= 10) - —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤
        # –ò–ª–∏ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø—Ä–æ —Å–ø–∏—Å–∫–∏ –∫–∞–Ω–∞–ª–æ–≤
        if (username_count >= 5 and emoji_count >= 10) or (has_channel_list_keywords and username_count >= 3):
            logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–∞–Ω–∞–ª–æ–≤ (@username: {username_count}, —ç–º–æ–¥–∑–∏: {emoji_count}), –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º")
            return {
                "message_type": "–û–ë–©–ï–ù–ò–ï",
                "is_spam": False,
                "niches": [],
                "context": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–∞–Ω–∞–ª–æ–≤ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∏—à–∞–º)",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 90,
                "reason": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–∞–Ω–∞–ª–æ–≤"
            }
        
        # 1.6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∫–ª–∞–º—É —á–∞—Ç–æ–≤/–∫–∞–Ω–∞–ª–æ–≤ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∏—à–∞–º)
        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–ø–∞ "–≤ —á–∞—Ç–∏–∫–µ @username –æ—Ç–≤–µ—á–∞—é—Ç –≤—Ä–∞—á–∏" - —ç—Ç–æ —Ä–µ–∫–ª–∞–º–∞, –Ω–µ –ø–æ–∏—Å–∫ —É—Å–ª—É–≥
        chat_ad_patterns = [
            r'–≤\s+—á–∞—Ç–∏–∫[–µ–µ].*@\w+', r'–≤\s+—á–∞—Ç–µ.*@\w+', r'–≤\s+–∫–∞–Ω–∞–ª[–µ–µ].*@\w+',
            r'—á–∞—Ç–∏–∫.*@\w+.*–æ—Ç–≤–µ—á–∞—é—Ç', r'–≤\s+–Ω–µ–º.*–æ—Ç–≤–µ—á–∞—é—Ç', r'–≤\s+–Ω–µ–º.*–≤—Ä–∞—á',
            r'–≥–æ—Ç–æ–≤—ã.*–ø–æ–º–æ—á—å.*@\w+', r'–≤—Å–µ–≥–¥–∞.*–º–æ–≥—É—Ç.*–ø–æ–º–æ—á—å.*@\w+'
        ]
        for pattern in chat_ad_patterns:
            if re.search(pattern, message_text.lower(), re.IGNORECASE):
                logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–µ–∫–ª–∞–º–∞ —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞, –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º: {message_text[:100]}...")
                return {
                    "message_type": "–û–ë–©–ï–ù–ò–ï",
                    "is_spam": False,
                    "niches": [],
                    "context": "–†–µ–∫–ª–∞–º–∞ —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∏—à–∞–º)",
                    "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                    "budget": "",
                    "confidence": 90,
                    "reason": "–†–µ–∫–ª–∞–º–∞ —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞"
            }

        # 2. –ë–∞–∑–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º (–°–ù–ê–ß–ê–õ–ê –ø–∞—Ç—Ç–µ—Ä–Ω—ã, —á—Ç–æ–±—ã —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –Ω–∞ API)
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –ù–∞—á–∏–Ω–∞—é –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º")
        text = message_text.lower()
        found_niches = set()
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –¢–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (lowercase): {text[:100]}...")
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –∏—â–µ—Ç –ø–æ–≤–∞—Ä–∞/–∫–µ–π—Ç–µ—Ä–∏–Ω–≥/—É—Å–ª—É–≥–∏ –¥–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - —ç—Ç–æ –ù–ï "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"
        # –î–∞–∂–µ –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å —Å–ª–æ–≤–æ "–≤–∏–ª–ª–∞", —ç—Ç–æ –Ω–µ –ø—Ä–æ –∞—Ä–µ–Ω–¥—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
        chef_search_patterns = [
            r'–∏—â—É\s+–ø–æ–≤–∞—Ä', r'–Ω—É–∂–µ–Ω\s+–ø–æ–≤–∞—Ä', r'–∫–æ–Ω—Ç–∞–∫—Ç\s+–ø–æ–≤–∞—Ä', r'–µ—Å—Ç—å\s+.*–ø–æ–≤–∞—Ä',
            r'–ø–æ–≤–∞—Ä.*–¥–ª—è\s+–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è', r'–ø–æ–≤–∞—Ä.*–Ω–∞\s+–≤–∏–ª–ª', r'–∫–µ–π—Ç–µ—Ä–∏–Ω–≥', r'catering',
            r'–¥–ª—è\s+–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.*–ø–æ–≤–∞—Ä', r'—Ä–∞–±–æ—Ç–∞\s+–Ω–∞\s+–≤–∏–ª–ª.*–ø–æ–≤–∞—Ä',
        ]
        is_chef_search = any(re.search(pattern, text, re.IGNORECASE) for pattern in chef_search_patterns)
        
        if is_chef_search:
            logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–∏—Å–∫ –ø–æ–≤–∞—Ä–∞/–∫–µ–π—Ç–µ—Ä–∏–Ω–≥–∞, –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ '–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏'")
            # –ù–µ –¥–æ–±–∞–≤–ª—è–µ–º "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –µ—ë –Ω–∞—à–ª–∏
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –Ω–∏—à, —Ç–∞–∫ –∫–∞–∫ –ø–æ–≤–∞—Ä –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–∏—à
            return {
                "message_type": "–ü–û–ò–°–ö",
                "is_spam": False,
                "niches": [],
                "context": "–ü–æ–∏—Å–∫ –ø–æ–≤–∞—Ä–∞/–∫–µ–π—Ç–µ—Ä–∏–Ω–≥–∞ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥–æ—Å—Ç—É–ø–Ω—ã–º –Ω–∏—à–∞–º)",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 80,
                "reason": "–ü–æ–∏—Å–∫ –ø–æ–≤–∞—Ä–∞ - –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥–æ—Å—Ç—É–ø–Ω—ã–º –Ω–∏—à–∞–º"
            }
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø—Ä–æ—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ —Ç–∞–±–∞–∫ –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–∞–ª—å—è–Ω–æ–≤ - —ç—Ç–æ –ù–ï "–ö–∞–ª—å—è–Ω—ã"
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ç–∞–±–∞–∫–∞, –Ω–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–∞–ª—å—è–Ω–æ–≤
        tobacco_patterns = [r'—Ç–∞–±–∞–∫', r'tabacco', r'dark\s+side', r'–∑–∞–∫–∞–∑–∞—Ç—å\s+—Ç–∞–±–∞–∫', r'–∫—É–ø–∏—Ç—å\s+—Ç–∞–±–∞–∫', r'–≥–¥–µ\s+—Ç–∞–±–∞–∫']
        has_tobacco = any(re.search(pattern, text, re.IGNORECASE) for pattern in tobacco_patterns)
        hookah_patterns = [r'–∫–∞–ª—å—è–Ω', r'–∫–∞–ª—å—è–Ω–Ω–∞—è', r'–∫–∞–ª—å—è–Ω\s+–±–∞—Ä', r'–∫–∞–ª—å—è–Ω\s+–Ω–∞\s+–¥–æ–º', r'–∑–∞–∫–∞–∑–∞—Ç—å\s+–∫–∞–ª—å—è–Ω']
        has_hookah = any(re.search(pattern, text, re.IGNORECASE) for pattern in hookah_patterns)
        
        if has_tobacco and not has_hookah:
            logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∞–±–∞–∫ –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–∞–ª—å—è–Ω–æ–≤, –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ '–ö–∞–ª—å—è–Ω—ã'")
            # –ù–µ –¥–æ–±–∞–≤–ª—è–µ–º "–ö–∞–ª—å—è–Ω—ã" –¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –µ—ë –Ω–∞—à–ª–∏
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –Ω–∏—à, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∞–±–∞–∫
            return {
                "message_type": "–û–ë–©–ï–ù–ò–ï",
                "is_spam": False,
                "niches": [],
                "context": "–í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∞–±–∞–∫ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —É—Å–ª—É–≥–∞–º –∫–∞–ª—å—è–Ω–æ–≤)",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 80,
                "reason": "–í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∞–±–∞–∫ - –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —É—Å–ª—É–≥–∞–º –∫–∞–ª—å—è–Ω–æ–≤"
            }
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ò—Å–∫–ª—é—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ –æ–±—É–≤—å, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, –æ–¥–µ–∂–¥—É, –º–µ–±–µ–ª—å, –±–∏–ª–µ—Ç—ã –∏ –¥—Ä—É–≥–∏–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"
        # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —è–≤–ª—è—é—Ç—Å—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é
        non_real_estate_patterns = [
            # –ë–∏–ª–µ—Ç—ã/–∫–æ–Ω—Ü–µ—Ä—Ç—ã/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
            r'–±–∏–ª–µ—Ç[–∞—ã—É]?\s+–Ω–∞\s+–∫–æ–Ω—Ü–µ—Ä—Ç', r'–±–∏–ª–µ—Ç[–∞—ã—É]?\s+–Ω–∞\s+–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏', r'–ø—Ä–æ–¥–∞–º\s+–±–∏–ª–µ—Ç', r'–ø—Ä–æ–¥–∞—é\s+–±–∏–ª–µ—Ç',
            r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+–∫–æ–Ω—Ü–µ—Ä—Ç', r'–∫–æ–Ω—Ü–µ—Ä—Ç–Ω[—ã–π–æ–≥–æ]?\s+–±–∏–ª–µ—Ç', r'—Ñ–∞–Ω–∑–æ–Ω[–∞—É—ã]?', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—è–Ω–≤–∞—Ä',
            r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—Ñ–µ–≤—Ä–∞–ª', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–º–∞—Ä—Ç', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∞–ø—Ä–µ–ª',
            r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–º–∞–π', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∏—é–Ω', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∏—é–ª',
            r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∞–≤–≥—É—Å—Ç', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—Å–µ–Ω—Ç—è–±—Ä', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–æ–∫—Ç—è–±—Ä',
            r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–Ω–æ—è–±—Ä', r'–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–¥–µ–∫–∞–±—Ä', r'–º–µ–ª–∞–¥–∑–µ', r'–∫–æ–Ω—Ü–µ—Ä—Ç\s+–º–µ–ª–∞–¥–∑–µ',
            # –û–±—É–≤—å
            r'–±–æ—Å–æ–Ω–æ–∂–∫[–∏—ã]?', r'—Ç—É—Ñ–ª[–∏—ã]?', r'–æ–±—É–≤[—å–∏]?', r'–∫—Ä–æ—Å—Å–æ–≤–∫[–∏—ã]?', r'—Å–∞–Ω–¥–∞–ª[–∏—ã]?',
            # –¢–µ—Ö–Ω–∏–∫–∞
            r'samsung\s+galaxy', r'iphone', r'ipad', r'–ø–ª–∞–Ω—à–µ—Ç', r'—Å–º–∞—Ä—Ç—Ñ–æ–Ω', r'—Ç–µ–ª–µ—Ñ–æ–Ω', r'–º–æ–±–∏–ª—å–Ω[—ã–π–æ–≥–æ]?\s+—Ç–µ–ª–µ—Ñ–æ–Ω',
            r'—ç–∫—Ä–∞–Ω\s+\d+', r'–∫–∞–º–µ—Ä[–∞—ã]?\s+\d+\s+–º–ø', r'–ø–∞–º—è—Ç—å\s+\d+/\d+', r'–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä\s+\d+',
            r'apple\s+pencil', r'procreate', r'ipad\s+pro', r'ipad\s+air', r'ipad\s+mini',
            r'–∑–∞—â–∏—Ç[–∞—ã]?\s+ip\d+', r'–ø–æ–¥–¥–µ—Ä–∂–∫[–∞—ã]?\s+5g',
            # –ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞
            r'–º–∞—Å—Ç–µ—Ä[–∞—ã]?\s+–ø–æ\s+—ç–ª–µ–∫—Ç—Ä–æ–ø–ª–∏—Ç', r'—ç–ª–µ–∫—Ç—Ä–æ–ø–ª–∏—Ç[–∞—ã]?', r'–ø–ª–∏—Ç[–∞—ã]?\s+–Ω–∞\s+–¥–æ–º',
            # –ú–µ–±–µ–ª—å (–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –î–û–ë–ê–í–õ–ï–ù–ò–ï - —É–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
            r'\b–¥–∏–≤–∞–Ω\b', r'\b–∫—Ä–æ–≤–∞—Ç—å\b', r'\b—Å—Ç–æ–ª\b', r'\b—Å—Ç—É–ª\b', r'\b—à–∫–∞—Ñ\b', r'\b–∫–æ–º–æ–¥\b', r'\b–ø–æ–ª–∫[–∞–∏—ã]?\b',
            r'\b–∫—Ä–µ—Å–ª[–æ–∞]?\b', r'–¥–∏–≤–∞–Ω.*—Å–µ–∫—Ü–∏', r'–º–æ–¥—É–ª—å–Ω[—ã–π—ã–µ].*—á–∞—Å—Ç–∏', r'–¥–∏–≤–∞–Ω.*–º–æ–¥—É–ª—å–Ω',
            r'\b–º–µ–±–µ–ª—å\b', r'\b–º–µ–±–µ–ª[—å–∏]?\b', r'–ø—Ä–æ–¥–∞–º.*–¥–∏–≤–∞–Ω', r'–ø—Ä–æ–¥–∞–º.*–∫—Ä–æ–≤–∞—Ç—å', r'–ø—Ä–æ–¥–∞–º.*—Å—Ç–æ–ª',
            r'–ø—Ä–æ–¥–∞–º.*–±–æ–ª—å—à[–æ–π—É—é].*–¥–∏–≤–∞–Ω', r'–ø—Ä–æ–¥–∞–º.*—É–¥–æ–±–Ω[—ã–π—É—é].*–¥–∏–≤–∞–Ω', r'–¥–∏–≤–∞–Ω.*–±–æ–ª—å—à[–æ–π—É—é]', r'–¥–∏–≤–∞–Ω.*—É–¥–æ–±–Ω[—ã–π—É—é]',
            # –û–¥–µ–∂–¥–∞
            r'—Å–≤–∏—Ç–µ—Ä', r'–æ–ª–∏–º–ø–∏–π–∫[–∞–∏—ã]?', r'—Ñ—É—Ç–±–æ–ª–∫[–∞–∏—ã]?', r'–¥–∂–∏–Ω—Å[—ã—ã]?', r'–±—Ä—é–∫[–∏—ã]?',
            r'—à–æ—Ä—Ç[—ã—ã]?', r'–ø–ª–∞—Ç—å[–µ—è]?', r'—é–±–∫[–∞–∏—ã]?', r'–±–ª—É–∑–∫[–∞–∏—ã]?', r'—Ä—É–±–∞—à–∫[–∞–∏—ã]?',
            r'–∫—É—Ä—Ç–∫[–∞–∏—ã]?', r'–ø–∞–ª—å—Ç[–æ–∞]?', r'–ø—É—Ö–æ–≤–∏–∫', r'–≤–µ—Ç—Ä–æ–≤–∫[–∞–∏—ã]?', r'—Ö—É–¥–∏',
            r'—Ç–æ–ª—Å—Ç–æ–≤–∫[–∞–∏—ã]?', r'–∫–æ—Ñ—Ç[–∞–∏—ã]?', r'–∫–∞—Ä–¥–∏–≥–∞–Ω', r'–∂–∞–∫–µ—Ç', r'–ø–∏–¥–∂–∞–∫',
            # –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ —É–∫—Ä–∞—à–µ–Ω–∏—è
            r'—Å—É–º–∫[–∞–∏—ã]?', r'—Ä—é–∫–∑–∞–∫', r'–∫–æ—à–µ–ª–µ–∫', r'–ø–æ—Ä—Ç—Ñ–µ–ª[—å–∏]?', r'—á–µ–º–æ–¥–∞–Ω',
            r'—Å–µ—Ä—å–≥[–∏—ã]?', r'–ø–∏—Ä—Å–∏–Ω–≥', r'–∫–æ–ª—å—Ü[–æ–∞]?', r'–±—Ä–∞—Å–ª–µ—Ç', r'—Ü–µ–ø–æ—á–∫[–∞–∏—ã]?',
            r'–æ–∂–µ—Ä–µ–ª—å[–µ—è]?', r'–∫—É–ª–æ–Ω', r'–ø–æ–¥–≤–µ—Å–∫[–∞–∏—ã]?', r'–±—É—Å[—ã—ã]?',
            r'—É–∫—Ä–∞—à–µ–Ω[–∏—è–∏–π]', r'–∫–æ–º–ø–ª–µ–∫—Ç\s+—É–∫—Ä–∞—à–µ–Ω', r'—á–æ–∫–µ—Ä', r'–≥–∞–ª—Å—Ç—É–∫', r'—Å–ª—ç–π–≤[-\s]?–±—Ä–∞—Å–ª–µ—Ç',
            r'—Ñ–∏–∞–Ω–∏—Ç[—ã—ã]?', r'akashi', r'—Å–µ—Ä–µ–±—Ä[–æ–∞]?', r'–∑–æ–ª–æ—Ç[–æ–∞]?',
            # –ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –ø–∞—Ä—Ñ—é–º–µ—Ä–∏—è
            r'–∫–æ–Ω—Å–∏–ª–ª–µ—Ä', r'—Ä—É–º—è–Ω–∞', r'–∫–æ—Å–º–µ—Ç–∏–∫[–∞–∏—ã]?', r'–º–∞–∫–∏—è–∂', r'tarte', r'roud',
            r'–ø–æ–º–∞–¥[–∞–∏—ã]?', r'—Ç—É—à—å', r'—Ç–æ–Ω–∞–ª—å–Ω[—ã–π–æ–≥–æ]?', r'–∫—Ä–µ–º\s+–¥–ª—è\s+–ª–∏—Ü', r'—Å—ã–≤–æ—Ä–æ—Ç–∫[–∞–∏—ã]?',
            r'–ø–∞—Ä—Ñ—é–º', r'–¥—É—Ö[–∏—ã]?', r'—Ç—É–∞–ª–µ—Ç–Ω[–∞—è—ã–µ]?\s+–≤–æ–¥[–∞—ã]?',
            # –î—Ä—É–≥–∏–µ —Ç–æ–≤–∞—Ä—ã
            r'—Ä–∞–∑–º–µ—Ä\s+[smlxl]', r'—Ä–∞–∑–º–µ—Ä\s+\d+', r'—Ä–∞–∑–º–µ—Ä\s+l', r'—Ä–∞–∑–º–µ—Ä\s+m', r'—Ä–∞–∑–º–µ—Ä\s+s',
            r'–Ω–æ—à–µ–Ω', r'—Å—Ç–∏—Ä–∞–Ω', r'–Ω–æ–≤[—ã–π–æ–≥–æ]?', r'–±/—É', r'–±\.—É\.',
        ]
        is_non_real_estate = any(re.search(pattern, text, re.IGNORECASE) for pattern in non_real_estate_patterns)
        
        if is_non_real_estate:
            logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ç–æ–≤–∞—Ä (–æ–±—É–≤—å/—Ç–µ–ª–µ—Ñ–æ–Ω/—Ç–µ—Ö–Ω–∏–∫–∞/–æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–∫–æ—Å–º–µ—Ç–∏–∫–∞/–º–µ–±–µ–ª—å), –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ '–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏'")
            # –£–¥–∞–ª—è–µ–º "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à, –µ—Å–ª–∏ –æ–Ω–∞ —Ç–∞–º –µ—Å—Ç—å
            found_niches.discard("–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏")
            logger.info(f"üîç –£–¥–∞–ª–µ–Ω–∞ –Ω–∏—à–∞ '–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏' - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ —Ç–æ–≤–∞—Ä, –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –µ—Å—Ç—å "–ø—Ä–æ–¥–∞–º" + –æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –Ω–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ - –∏—Å–∫–ª—é—á–∞–µ–º "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"
        if "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" in found_niches:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
            real_estate_keywords = [r'–∫–≤–∞—Ä—Ç–∏—Ä', r'–¥–æ–º', r'–≤–∏–ª–ª', r'–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', r'—É—á–∞—Å—Ç–æ–∫', r'–∑–µ–º–ª', r'—Ä–∏–µ–ª—Ç–æ—Ä']
            has_real_estate = any(re.search(keyword, text, re.IGNORECASE) for keyword in real_estate_keywords)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ–¥–µ–∂–¥—ã/–∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤/–∫–æ—Å–º–µ—Ç–∏–∫–∏
            clothing_keywords = [r'—Å–≤–∏—Ç–µ—Ä', r'–æ–ª–∏–º–ø–∏–π–∫', r'—Å—É–º–∫', r'—Å–µ—Ä—å–≥', r'–ø–∏—Ä—Å–∏–Ω–≥', r'—Ä–∞–∑–º–µ—Ä\s+[smlxl]', r'—Ä–∞–∑–º–µ—Ä\s+\d+', r'–Ω–æ—à–µ–Ω', r'—Å—Ç–∏—Ä–∞–Ω',
                               r'–∫–æ–Ω—Å–∏–ª–ª–µ—Ä', r'—Ä—É–º—è–Ω–∞', r'–∫–æ—Å–º–µ—Ç–∏–∫', r'–º–∞–∫–∏—è–∂', r'tarte', r'roud', r'–ø–æ–º–∞–¥', r'—Ç—É—à—å', r'—Ç–æ–Ω–∞–ª—å–Ω', r'–∫—Ä–µ–º\s+–¥–ª—è\s+–ª–∏—Ü']
            has_clothing = any(re.search(keyword, text, re.IGNORECASE) for keyword in clothing_keywords)
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–∫–æ—Å–º–µ—Ç–∏–∫–∞, –Ω–æ –ù–ï–¢ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ - –∏—Å–∫–ª—é—á–∞–µ–º "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"
            if has_clothing and not has_real_estate:
                found_niches.discard("–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏")
                logger.info(f"üîç –£–¥–∞–ª–µ–Ω–∞ –Ω–∏—à–∞ '–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏' - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–¥–µ–∂–¥—É/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–∫–æ—Å–º–µ—Ç–∏–∫—É, –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")

        # –ü–†–ò–û–†–ò–¢–ï–¢–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∏—à–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å
        # –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞ "–ö—É–ø–ª—é USDT" ‚Üí —Ä–µ—Å–Ω–∏—á–∫–∏
        text = message_text.lower()
        
        # -----------------------------------------------------------------
        # üè¢ –†–ê–ù–ù–Ø–Ø –ü–†–û–í–ï–†–ö–ê –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–´ (–¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã, –º–∞–≥–∞–∑–∏–Ω—ã, –∞–ø—Ç–µ–∫–∏ –∏ —Ç.–¥.
        # –µ—Å–ª–∏ –≤ –Ω–∏—Ö –ù–ï–¢ —Å–ª–æ–≤ –ø—Ä–æ –∂–∏–ª—å–µ (—Å–Ω—è—Ç—å/—Å–¥–∞—Ç—å/–∞—Ä–µ–Ω–¥–∞/–≤–∏–ª–ª–∞/–¥–æ–º/–∫–≤–∞—Ä—Ç–∏—Ä–∞)
        # -----------------------------------------------------------------
        infrastructure_blacklist = [
            r'\b—Ç—Ü\b', r'—Ç–æ—Ä–≥–æ–≤[—ã–π—ã–π].*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤—ã–π\s+—Ü–µ–Ω—Ç—Ä',
            r'–º–æ–ª–ª', r'\bmall\b', r'—à–æ–ø–ø–∏–Ω–≥.*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤[–∞—è].*–ø–ª–æ—â–∞–¥–∫',
            r'–º–∞–≥–∞–∑–∏–Ω', r'—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç', r'–∞–ø—Ç–µ–∫[–∞—É]', r'—Ä–µ—Å—Ç–æ—Ä–∞–Ω', r'–∫–∞—Ñ–µ',
            r'–±–∞–Ω–∫', r'–±–∞–Ω–∫–æ–º–∞—Ç', r'–∞—Ç–º', r'–±–æ–ª—å–Ω–∏—Ü[–∞—É]', r'–∫–ª–∏–Ω–∏–∫[–∞—É]',
            r'—à–∫–æ–ª[–∞—É]', r'–¥–µ—Ç—Å–∫[–∏–π].*—Å–∞–¥', r'—Å–ø–æ—Ä—Ç–∑–∞–ª', r'—Ñ–∏—Ç–Ω–µ—Å',
            r'–∑–∞–ø—Ä–∞–≤–∫[–∞—É]', r'–±–µ–Ω–∑–æ–∫–æ–ª–æ–Ω–∫[–∞—É]', r'–∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å',
            r'–∫—Ç–æ\s+–∑–Ω–∞–µ—Ç\s+–≥–¥–µ', r'–≥–¥–µ\s+–Ω–∞–π—Ç–∏', r'–≥–¥–µ\s+–µ—Å—Ç—å'
        ]
        
        housing_keywords = [
            r'—Å–Ω—è—Ç—å', r'—Å–¥–∞—Ç—å', r'–∞—Ä–µ–Ω–¥[–∞—É]', r'–≤–∏–ª–ª[–∞—É]', r'\b–¥–æ–º\b', r'–∫–≤–∞—Ä—Ç–∏—Ä[–∞—É]',
            r'–∫–æ–º–Ω–∞—Ç[–∞—É]', r'–∂–∏–ª—å[–µ—ë]', r'–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'—Å—Ç—É–¥–∏[—è—é]', r'–∫–æ–Ω–¥–æ'
        ]
        
        has_infrastructure = any(re.search(bp, text, re.IGNORECASE) for bp in infrastructure_blacklist)
        has_housing = any(re.search(kw, text, re.IGNORECASE) for kw in housing_keywords)
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–æ–≤–∞ –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ò –Ω–µ—Ç —Å–ª–æ–≤ –ø—Ä–æ –∂–∏–ª—å–µ - –±–ª–æ–∫–∏—Ä—É–µ–º —Å—Ä–∞–∑—É
        if has_infrastructure and not has_housing:
            logger.info(f"üõë [–†–ê–ù–ù–Ø–Ø –ü–†–û–í–ï–†–ö–ê] –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ (–∑–∞–ø—Ä–æ—Å –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É/–º–∞–≥–∞–∑–∏–Ω—ã, –∞ –Ω–µ –∂–∏–ª—å–µ): {message_text[:100]}")
            return {
                "message_type": "–ü–û–ò–°–ö",
                "is_spam": False,
                "niches": [],
                "context": "–ó–∞–ø—Ä–æ—Å –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (–º–∞–≥–∞–∑–∏–Ω—ã/–¢–¶/–∞–ø—Ç–µ–∫–∏), –∞ –Ω–µ –∂–∏–ª—å–µ",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 0,
                "reason": "Infrastructure filter (early check)"
            }
        # -----------------------------------------------------------------
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç (USDT, USDC, —Ç–µ–∑–µ—Ä) - –ø—Ä–æ–≤–µ—Ä—è–µ–º –ü–ï–†–í–´–ú–ò
        exchange_priority_patterns = [
            r'\busdt\b', r'\busdc\b', r'\b—Ç–µ–∑–µ—Ä(–∞|—ã|—É|–æ–º|–∞–º–∏|–∞—Ö)?\b',
            r'–∫—É–ø–ª—é.{0,50}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|–Ω–∞–ª–∏—á–∫|–Ω–∞–ª)',
            r'–ø—Ä–æ–¥–∞–º.{0,50}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|–Ω–∞–ª–∏—á–∫|–Ω–∞–ª)',
            r'–æ–±–º–µ–Ω—è—é.{0,50}(–Ω–∞–ª|–Ω–∞–ª–∏—á–∫|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|usdt|usdc|—Ç–µ–∑–µ—Ä)',
            r'–æ–±–º–µ–Ω.{0,50}(–≤–∞–ª—é—Ç|usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç)',
        ]
        is_exchange_message = any(re.search(pattern, text, re.IGNORECASE) for pattern in exchange_priority_patterns)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–µ/–æ–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        message_length = len(message_text.strip())
        is_very_short = message_length < 20  # –°–æ–æ–±—â–µ–Ω–∏—è –∫–æ—Ä–æ—á–µ 20 —Å–∏–º–≤–æ–ª–æ–≤
        is_question_only = bool(re.search(r'^[^.!?]*[?]?\s*$', message_text.strip(), re.IGNORECASE)) and message_length < 30
        
        # –°–ª–æ–≤–∞—Ä—å —è–≤–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–∏—à–∏ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
        explicit_keywords_by_niche = {
            "–§–æ—Ç–æ–≥—Ä–∞—Ñ": [r'—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ', r'—Ñ–æ—Ç–æ—Å–µ—Å—Å–∏', r'—Ñ–æ—Ç–æ—Å—ä–µ–º–∫', r'—Å—ä–µ–º–∫.*—Ñ–æ—Ç–æ', r'—Å—ä—ë–º–∫.*—Ñ–æ—Ç–æ', r'–ø–æ—Ä—Ç—Ä–µ—Ç', r'—Å–≤–∞–¥–µ–±–Ω.*—Ñ–æ—Ç–æ', r'—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å', r'–ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É–π—Ç–µ.*—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ', r'–∫—Ç–æ.*—É–º–µ–µ—Ç.*—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å', r'–Ω—É–∂–µ–Ω.*—á–µ–ª–æ–≤–µ–∫.*—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä'],
            "–í–∏–¥–µ–æ–≥—Ä–∞—Ñ": [r'–≤–∏–¥–µ–æ–≥—Ä–∞—Ñ', r'–≤–∏–¥–µ–æ—Å—ä–µ–º–∫', r'–≤–∏–¥–µ–æ–º–æ–Ω—Ç–∞–∂', r'–æ–ø–µ—Ä–∞—Ç–æ—Ä', r'—Å—ä–µ–º–∫.*–≤–∏–¥–µ–æ', r'–º–æ–Ω—Ç–∞–∂.*–≤–∏–¥–µ–æ'],
            "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏": [r'—Å–¥–∞–º', r'—Å–Ω–∏–º—É', r'–∞—Ä–µ–Ω–¥.*–∂–∏–ª—å', r'–∞—Ä–µ–Ω–¥.*–∫–≤–∞—Ä—Ç–∏—Ä', r'–∞—Ä–µ–Ω–¥.*–≤–∏–ª–ª', r'–∞—Ä–µ–Ω–¥.*–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'—Å–¥–∞—é.*–∫–≤–∞—Ä—Ç–∏—Ä', r'—Å–¥–∞—é.*–≤–∏–ª–ª'],
            "–ú–∞–Ω–∏–∫—é—Ä": [r'–º–∞–Ω–∏–∫—é—Ä', r'–º–∞–Ω–∏–∫—é—Ä—à', r'–º–∞–Ω–∏–∫—é—Ä.*–º–∞—Å—Ç–µ—Ä', r'–ø–æ–∫—Ä—ã—Ç–∏.*–Ω–æ–≥—Ç', r'–¥–∏–∑–∞–π–Ω.*–Ω–æ–≥—Ç'],
            "–í–æ–ª–æ—Å—ã": [r'–ø–∞—Ä–∏–∫–º–∞—Ö–µ—Ä', r'—Å—Ç—Ä–∏–∂–∫', r'–æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏', r'—É–∫–ª–∞–¥–∫', r'–ø—Ä–∏—á–µ—Å–∫', r'–º–∞—Å—Ç–µ—Ä.*–≤–æ–ª–æ—Å'],
            "–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ": [r'–∞—Ä–µ–Ω–¥.*–∞–≤—Ç–æ', r'–∞—Ä–µ–Ω–¥.*–º–∞—à–∏–Ω', r'–ø—Ä–æ–∫–∞—Ç.*–∞–≤—Ç–æ', r'–ø—Ä–æ–∫–∞—Ç.*–º–∞—à–∏–Ω', r'–∞—Ä–µ–Ω–¥.*car', r'rent.*car'],
            "–†–µ—Å–Ω–∏—á–∫–∏": [r'—Ä–µ—Å–Ω–∏—á–∫', r'–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏.*—Ä–µ—Å–Ω–∏—Ü', r'–ª–∞—à.*–º–∞—Å—Ç–µ—Ä', r'lash'],
            "–ë—Ä–æ–≤–∏": [r'–±—Ä–æ–≤', r'–∫–æ—Ä—Ä–µ–∫—Ü–∏.*–±—Ä–æ–≤', r'—Ç–∞—Ç—É–∞–∂.*–±—Ä–æ–≤', r'brow'],
            "–ú–∞–∫–∏—è–∂": [r'–º–∞–∫–∏—è–∂', r'–≤–∏–∑–∞–∂–∏—Å—Ç', r'–º–∞–∫–∏—è–∂.*–º–∞—Å—Ç–µ—Ä', r'–º–∞–∫–∏—è–∂.*–Ω–∞.*—Å–≤–∞–¥—å–±', r'makeup'],
            "–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è": [r'–∫–æ—Å–º–µ—Ç–æ–ª–æ–≥', r'–∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏', r'—á–∏—Å—Ç–∫.*–ª–∏—Ü', r'—É—Ö–æ–¥.*–∑–∞.*–∫–æ–∂–µ–π', r'–∫–æ—Å–º–µ—Ç.*—É—Å–ª—É–≥'],
            "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏": [r'–ø—Ä–æ–¥–∞–º\s+(–∫–≤–∞—Ä—Ç–∏—Ä|–¥–æ–º|–≤–∏–ª–ª|–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç|–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å|—É—á–∞—Å—Ç–æ–∫|–∑–µ–º–ª)', r'–∫—É–ø–ª—é\s+(–∫–≤–∞—Ä—Ç–∏—Ä|–¥–æ–º|–≤–∏–ª–ª|–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç|–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å|—É—á–∞—Å—Ç–æ–∫|–∑–µ–º–ª)', r'–ø—Ä–æ–¥–∞—é\s+(–∫–≤–∞—Ä—Ç–∏—Ä|–¥–æ–º|–≤–∏–ª–ª|–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç|–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å|—É—á–∞—Å—Ç–æ–∫|–∑–µ–º–ª)'],
            "–ê—Ä–µ–Ω–¥–∞ –±–∞–π–∫–æ–≤": [r'–∞—Ä–µ–Ω–¥.*–±–∞–π–∫', r'–∞—Ä–µ–Ω–¥.*–º–æ—Ç–æ—Ü–∏–∫–ª', r'–∞—Ä–µ–Ω–¥.*—Å–∫—É—Ç–µ—Ä', r'–ø—Ä–æ–∫–∞—Ç.*–±–∞–π–∫', r'–ø—Ä–æ–∫–∞—Ç.*–º–æ—Ç–æ—Ü–∏–∫–ª', r'–ø—Ä–æ–∫–∞—Ç.*—Å–∫—É—Ç–µ—Ä', r'rent.*bike', r'rent.*scooter'],
            "–û–±–º–µ–Ω –≤–∞–ª—é—Ç": [r'–∫—É–ø–ª—é\s+usdt', r'–ø—Ä–æ–¥–∞–º\s+usdt', r'–æ–±–º–µ–Ω.*–≤–∞–ª—é—Ç', r'–æ–±–º–µ–Ω—è—é', r'–æ–±–º–µ–Ω.*usdt', r'–æ–±–º–µ–Ω.*—Ç–µ–∑–µ—Ä'],
            "–ö–∞–ª—å—è–Ω—ã": [r'–∫–∞–ª—å—è–Ω', r'–∫–∞–ª—å—è–Ω–Ω–∞—è', r'–∫–∞–ª—å—è–Ω.*–±–∞—Ä', r'–∫–∞–ª—å—è–Ω.*–Ω–∞.*–¥–æ–º', r'–∑–∞–∫–∞–∑–∞—Ç—å.*–∫–∞–ª—å—è–Ω'],
            "–ê—Ä–µ–Ω–¥–∞ Playstation": [r'–∞—Ä–µ–Ω–¥.*playstation', r'–∞—Ä–µ–Ω–¥.*ps4', r'–∞—Ä–µ–Ω–¥.*ps5', r'–ø—Ä–æ–∫–∞—Ç.*playstation', r'–ø—Ä–æ–∫–∞—Ç.*ps4', r'–ø—Ä–æ–∫–∞—Ç.*ps5', r'–∞—Ä–µ–Ω–¥.*–ø—Ä–∏—Å—Ç–∞–≤–∫'],
            "–ú–µ–¥–∏–∞-—Å—Ç—É–¥–∏—è": [r'–º–µ–¥–∏–∞.*—Å—Ç—É–¥–∏', r'–º–µ–¥–∏–∞.*—Å—Ç—É–¥–∏—è', r'–≤–∏–¥–µ–æ.*—Å—Ç—É–¥–∏', r'—Ñ–æ—Ç–æ.*—Å—Ç—É–¥–∏', r'–∫–æ–Ω—Ç–µ–Ω—Ç.*—Å—Ç—É–¥–∏'],
            "–¢—É—Ä–∏–∑–º": [r'—Ç—É—Ä', r'—ç–∫—Å–∫—É—Ä—Å–∏', r'–≥–∏–¥', r'–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏', r'–æ—Ç–¥—ã—Ö', r'—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫'],
            "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç": [r'—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', r'—Ç–∞–∫—Å–∏', r'—Ç—Ä–∞–Ω—Å—Ñ–µ—Ä', r'–∞—Ä–µ–Ω–¥.*–∞–≤—Ç–æ', r'–∞—Ä–µ–Ω–¥.*–±–∞–π–∫', r'–¥–æ—Å—Ç–∞–≤–∫']
        }

        # –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –£–õ–£–ß–®–ï–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∏—à–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ - —Å–Ω–∞—á–∞–ª–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ (–û–±–º–µ–Ω –≤–∞–ª—é—Ç), –ø–æ—Ç–æ–º –æ–±—â–∏–µ
        # –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞ "–ö—É–ø–ª—é USDT" ‚Üí —Ä–µ—Å–Ω–∏—á–∫–∏
        priority_niches = ["–û–±–º–µ–Ω –≤–∞–ª—é—Ç", "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏", "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"]  # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –Ω–∏—à–∏
        other_niches = [niche for niche in self.patterns.keys() if niche not in priority_niches]
        ordered_niches = priority_niches + other_niches
        
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –ü—Ä–æ–≤–µ—Ä—è—é {len(ordered_niches)} –Ω–∏—à –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞...")
        
        for niche in ordered_niches:
            # ‚ö° –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
            compiled_patterns = self.compiled_patterns.get(niche, [])
            
            for compiled_pattern in compiled_patterns:
                try:
                    # –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞–π–¥–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –ü–†–û–í–ï–†–ö–£ –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô
                    if compiled_pattern.search(text):
                        
                        # -----------------------------------------------------------------
                        # ü§ê –§–ò–õ–¨–¢–† –ë–û–õ–¢–û–í–ù–ò (Chatter Filter)
                        # –û—Ç—Å–µ–∫–∞–µ–º –æ–±—Å—É–∂–¥–µ–Ω–∏—è, —à—É—Ç–∫–∏, –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
                        # -----------------------------------------------------------------
                        chatter_keywords = [
                            # –≠–º–æ—Ü–∏–∏ –∏ —Å–ª–µ–Ω–≥ –æ–±—â–µ–Ω–∏—è
                            r'–∞–≥–∞\s', r'—Ö–∞—Ö–∞', r'–ª–æ–ª', r'üòÇ', r'üòÅ', r'ü§£', r'üòÖ',
                            r'–ø–∞—Ä–æ–¥–∏[—è—é]', r'–ø—Ä–∏–∫–æ–ª', r'—Å–º–µ—à–Ω–æ', r'–∂–∏–∑–∞', r'–º–µ–º',
                            # –ò—Å—Ç–æ—Ä–∏–∏ –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
                            r'–Ω–∞—à–µ–ª\s+–≤–∏–¥–µ–æ', r'–ø–æ–¥–µ–ª–∏—Ç—å—Å—è', r'–∑–∞—Ü–µ–Ω–∏—Ç–µ', r'—Å–º–æ—Ç—Ä–∏—Ç[–µ—å]',
                            r'–¥—Ä—É–≥.*–¥–∞–ª', r'–ø–æ–¥—Ä—É–≥', r'–∏—Å—Ç–æ—Ä–∏[—è—é]', r'—Å–ª—É—á–∞–π', r'–≤–ø–µ—Ä–≤—ã–µ',
                            r'–ø–æ–≤–µ—Ä–∏–ª', r'–æ–∫–∞–∑–∞–ª–∏—Å—å', r'–¥–µ—Ç–∏\s+–∫–∏–¥–∞–ª–∏—Å—å',
                            r'–Ω–∞–¥–µ—é—Å—å\s+–Ω–µ\s+–±–∞–Ω—è—Ç', r'–±–∞–Ω—è—Ç\s+–∑–∞\s+—Å—Å—ã–ª–∫–∏',
                            # –†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (–±–µ–∑ —Å–ª–æ–≤ "–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ" –∏–ª–∏ "–º–æ–∏ —Ä–∞–±–æ—Ç—ã")
                            r'tiktok\.com', r'youtube\.com/shorts', r'instagram\.com/reel'
                        ]
                        
                        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –±–æ–ª—Ç–æ–≤–Ω—é –∏ –ù–ï–¢ —è–≤–Ω—ã—Ö —Å–ª–æ–≤ "–∏—â—É/—Ü–µ–Ω–∞/–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"
                        is_chatter = any(re.search(w, text, re.IGNORECASE) for w in chatter_keywords)
                        has_strong_intent = any(re.search(w, text, re.IGNORECASE) for w in [r'–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ', r'—Ü–µ–Ω–∞', r'–ø—Ä–∞–π—Å', r'–∏—â—É', r'–∑–∞–∫–∞–∑'])
                        
                        if is_chatter and not has_strong_intent:
                            logger.info(f"ü§ê –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –±–æ–ª—Ç–æ–≤–Ω—è/–∏—Å—Ç–æ—Ä–∏—è)")
                            continue
                        # -----------------------------------------------------------------
                        
                        # ---------------------------------------------------------------
                        # 1. –°–î–ê–ß–ê/–ü–†–û–î–ê–ñ–ê –ù–ï–î–í–ò–ñ–ò–ú–û–°–¢–ò: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞
                        # ---------------------------------------------------------------
                        if niche in ["–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏", "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"]:
                            # –ê. –°–ü–ê–ú –ü–†–û –†–ê–ë–û–¢–£, –£–°–õ–£–ì–ò, –ú–ê–†–ö–ï–¢–ò–ù–ì
                            job_blacklist = [
                                r'–∏—â—É\s+–º–µ–Ω–µ–¥–∂–µ—Ä', r'–Ω—É–∂–µ–Ω\s+–º–µ–Ω–µ–¥–∂–µ—Ä', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+–º–µ–Ω–µ–¥–∂–µ—Ä',
                                r'–º–µ–Ω–µ–¥–∂–µ—Ä\s+–Ω–∞\s+–≤–±', r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫', r'–≤–∞–∫–∞–Ω—Å–∏—è', r'–∑–ø\s+–æ–∫–ª–∞–¥',
                                r'—É–¥–∞–ª–µ–Ω–Ω[–∞—è—É—é].*—Ä–∞–±–æ—Ç', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', r'–∑–∞–ø–æ–ª–Ω–µ–Ω–∏[–µ—è]\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
                                r'–∫—É—Ä–∞—Ç–æ—Ä', r'–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', r'–ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å.*–∫–ª–∏–µ–Ω—Ç–æ–≤', 
                                r'–∏—â–µ—Ç–µ\s+–∫–ª–∏–µ–Ω—Ç–æ–≤', r'–ø–æ–∏—Å–∫\s+–∫–ª–∏–µ–Ω—Ç–æ–≤', r'—Ä–µ–∫–ª–∞–º–Ω[—ã—Ö].*—É—Å–ª—É–≥',
                                r'–±–∏–∑–Ω–µ—Å[- ]–∏–¥–µ–∏', r'–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å', r'–ø—Ä–∏–≤–µ—Ç.*–æ–∑–Ω–∞–∫–æ–º—å—Å—è'
                            ]
                            
                            # –ë. –ö–†–ò–ü–¢–ê –ò –û–ë–ú–ï–ù
                            crypto_blacklist = [
                                r'\btrx\b', r'\beth\b', r'\bton\b', r'\busdt\b', r'\bbtc\b',
                                r'–∫—Ä–∏–ø—Ç', r'–≤—ã–≥–æ–¥–Ω[–æ–º—É].*–∫—É—Ä—Å[—É]', r'jessep2p', r'p2p'
                            ]

                            # –í. –û–î–ï–ñ–î–ê –ò –í–ï–©–ò (–ö–æ—Å—Ç—é–º—ã, –ø–ª–∞—Ç—å—è, –ø—Ä–æ–¥–∞–∂–∞ –≤–µ—â–µ–π)
                            # –≠—Ç–æ —É–¥–∞–ª–∏—Ç "—Ç–µ–ø–ª—ã–π —á–µ—Ä–Ω—ã–π –∫–æ—Å—Ç—é–º" –∏–∑ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
                            items_blacklist = [
                                r'–∫–æ—Å—Ç—é–º', r'–ø–ª–∞—Ç—å–µ', r'—Ä–∞–∑–º–µ—Ä', r'–æ–¥–µ–∂–¥[–∞—ã]', r'–Ω–∞\s+—Ñ–ª–∏—Å–µ',
                                r'–ø—Ä–æ–¥–∞–º.*–Ω–æ—É—Ç–±—É–∫', r'–ø—Ä–æ–¥–∞–º.*iphone', r'–ø—Ä–æ–¥–∞–º.*–±–∞–π–∫', # –ë–∞–π–∫–∏ –Ω–µ –≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å
                                r'—Ñ—É—Ç–±–æ–ª–∫', r'—à–æ—Ä—Ç—ã', r'–∫—Ä–æ—Å—Å–æ–≤–∫–∏', r'–∫–µ–¥—ã'
                            ]

                            # –ì. –í–ò–ó–´ (–ß—Ç–æ–±—ã –≤–∏–∑–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –∂–∏–ª—å–µ)
                            visa_blacklist = [
                                r'–≤–∏–∑[–∞—É—Ç—É—ã]', r'visa', r'voa', r'evoa', r'kitas', r'–∫–∏—Ç–∞—Å',
                                r'b211', r'–ø–∞—Å–ø–æ—Ä—Ç', r'–ø—Ä–æ–¥–ª–µ–Ω–∏[–µ—è]', r'–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏[–µ—è].*–≤–∏–∑'
                            ]

                            # –î. –§–ò–ù–ê–ù–°–û–í–´–ô –°–ü–ê–ú / –û–ë–ú–ï–ù (StaffObmen –∏ –ø–æ–¥–æ–±–Ω—ã–µ)
                            financial_spam = [
                                r'–±–æ–Ω—É—Å', r'—Å–¥–µ–ª–∫–∏', r'–∫–æ–º–∏—Å—Å–∏[—è–∏–π]', r'—Ç–æ–ø–æ–≤—ã[–º–∏].*–∫—É—Ä—Å',
                                r'–≤—ã–≥–æ–¥–Ω—ã[–º–∏].*—É—Å–ª–æ–≤–∏', r'–æ–Ω–ª–∞–π–Ω.*–æ—Ñ–ª–∞–π–Ω.*–æ—Ñ–∏—Å',
                                r'staffobmen', r'–æ–±–º–µ–Ω.*–≤—ã–≥–æ–¥–Ω', r'–±–µ–∑.*—Å–∫—Ä—ã—Ç—ã—Ö'
                            ]

                            # –ï. –¢–û–†–ì–û–í–´–ï –¶–ï–ù–¢–†–´, –ú–ê–ì–ê–ó–ò–ù–´ –ò –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê (–Ω–µ –∂–∏–ª—å–µ!)
                            infrastructure_blacklist = [
                                r'\b—Ç—Ü\b', r'—Ç–æ—Ä–≥–æ–≤[—ã–π—ã–π].*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤—ã–π\s+—Ü–µ–Ω—Ç—Ä',
                                r'–º–æ–ª–ª', r'\bmall\b', r'—à–æ–ø–ø–∏–Ω–≥.*—Ü–µ–Ω—Ç—Ä', r'—Ç–æ—Ä–≥–æ–≤[–∞—è].*–ø–ª–æ—â–∞–¥–∫',
                                r'–º–∞–≥–∞–∑–∏–Ω', r'—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç', r'–∞–ø—Ç–µ–∫[–∞—É]', r'—Ä–µ—Å—Ç–æ—Ä–∞–Ω', r'–∫–∞—Ñ–µ',
                                r'–±–∞–Ω–∫', r'–±–∞–Ω–∫–æ–º–∞—Ç', r'–∞—Ç–º', r'–±–æ–ª—å–Ω–∏—Ü[–∞—É]', r'–∫–ª–∏–Ω–∏–∫[–∞—É]',
                                r'—à–∫–æ–ª[–∞—É]', r'–¥–µ—Ç—Å–∫[–∏–π].*—Å–∞–¥', r'—Å–ø–æ—Ä—Ç–∑–∞–ª', r'—Ñ–∏—Ç–Ω–µ—Å',
                                r'–∑–∞–ø—Ä–∞–≤–∫[–∞—É]', r'–±–µ–Ω–∑–æ–∫–æ–ª–æ–Ω–∫[–∞—É]', r'–∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å',
                                r'–∫—Ç–æ\s+–∑–Ω–∞–µ—Ç\s+–≥–¥–µ', r'–≥–¥–µ\s+–Ω–∞–π—Ç–∏', r'–≥–¥–µ\s+–µ—Å—Ç—å'
                            ]
                            
                            # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–æ–≤–∞ –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ò –Ω–µ—Ç —Å–ª–æ–≤ –ø—Ä–æ –∂–∏–ª—å–µ (—Å–Ω—è—Ç—å/—Å–¥–∞—Ç—å/–∞—Ä–µ–Ω–¥–∞/–≤–∏–ª–ª–∞/–¥–æ–º/–∫–≤–∞—Ä—Ç–∏—Ä–∞)
                            has_infrastructure = any(re.search(bp, text, re.IGNORECASE) for bp in infrastructure_blacklist)
                            has_housing_keywords = any(re.search(kw, text, re.IGNORECASE) for kw in [
                                r'—Å–Ω—è—Ç—å', r'—Å–¥–∞—Ç—å', r'–∞—Ä–µ–Ω–¥[–∞—É]', r'–≤–∏–ª–ª[–∞—É]', r'\b–¥–æ–º\b', r'–∫–≤–∞—Ä—Ç–∏—Ä[–∞—É]',
                                r'–∫–æ–º–Ω–∞—Ç[–∞—É]', r'–∂–∏–ª—å[–µ—ë]', r'–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'—Å—Ç—É–¥–∏[—è—é]', r'–∫–æ–Ω–¥–æ'
                            ])
                            
                            if has_infrastructure and not has_housing_keywords:
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–∑–∞–ø—Ä–æ—Å –ø—Ä–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É/–º–∞–≥–∞–∑–∏–Ω—ã, –∞ –Ω–µ –∂–∏–ª—å–µ)")
                                continue

                            # –ñ. –ë–ò–ó–ù–ï–° –£–°–õ–£–ì–ò / –ï–î–ê / –ò–ù–§–û–ì–†–ê–§–ò–ö–ê (–Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å!)
                            misc_spam_blacklist = [
                                # –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º ("–ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞", "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")
                                r'–Ω–æ–º–∏–Ω–∞–ª—å–Ω[—ã—Ö].*–¥–∏—Ä–µ–∫—Ç–æ—Ä', r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏[—è–∏].*–æ–æ–æ', r'—Å–º–µ–Ω–∞.*–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞',
                                r'–ø–µ—Ä–≤–∏—á–Ω–∞—è.*—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', r'–ª–∏–∫–≤–∏–¥–∞—Ü–∏—è', r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏.*–ø–æ.*—É—Å–ª–æ–≤–∏—è–º',
                                # –ï–¥–∞ / –¢–æ—Ä—Ç—ã ("–¢–æ—Ä—Ç –Ω–∞ –∑–∞–∫–∞–∑", "–î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã")
                                r'—Ç–æ—Ä—Ç[—ã]?.+–Ω–∞.+–∑–∞–∫–∞–∑', r'–Ω–∞—á–∏–Ω–∫[–∏–∞]', r'–≤–∫—É—Å–Ω[–∞—è–æ–µ]', r'–¥–µ—Å–µ—Ä—Ç',
                                r'–µ–¥–∞.+–Ω–∞.+–¥–æ–º', r'–¥–æ—Å—Ç–∞–≤–∫–∞.+–µ–¥—ã', r'–∫–∞–ª—å—è–Ω.+–Ω–∞.+–¥–æ–º', 
                                # –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ / –î–∏–∑–∞–π–Ω (—á–∞—Å—Ç–æ –ø—É—Ç–∞—é—Ç —Å —Ä–∞–±–æ—Ç–æ–π)
                                r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫', r'–Ω–∞—É—á–∏—Ç—å—Å—è.+–¥–µ–ª–∞—Ç—å', r'–º–µ–Ω–µ–¥–∂–µ—Ä.+–º–ø',
                                # –ß–µ–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å!)
                                r'–Ω—É–∂–Ω—ã\s+—á–µ–∫–∏', r'–Ω—É–∂–Ω—ã\s+—á–µ–∫–∏\s+–∏\s+–¥–æ–∫—É–º–µ–Ω—Ç', r'—á–µ–∫–∏\s+–∏\s+–¥–æ–∫—É–º–µ–Ω—Ç.*–±–∏–∑–Ω–µ—Å',
                                r'–æ–Ω–ª–∞–π–Ω\s+–∏\s+–∞—Ä—Ö–∏–≤–Ω—ã–µ\s+—á–µ–∫–∏', r'–∞—Ä—Ö–∏–≤–Ω—ã–µ\s+—á–µ–∫–∏', r'–ø–æ–ª–Ω—ã–º\s+–ø–∞–∫–µ—Ç–æ–º\s+–¥–æ–∫—É–º–µ–Ω—Ç',
                                r'—É–ø–¥.*–Ω–∞–∫–ª–∞–¥–Ω', r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*—É–ø–¥', r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*–Ω–∞–∫–ª–∞–¥–Ω',
                                r'—Å\s+–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å', r'–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å', r'–±–µ–∑–Ω–∞–ª–∏—á–Ω.*–æ–ø–ª–∞—Ç',
                                r'–æ—Å–æ–±—ã–µ\s+—É—Å–ª–æ–≤–∏—è.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', r'–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏[—è–∏].*–Ω–∞–ª–æ–≥',
                                r'–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–µ–º\s+–∏\s+—Ä–∞–±–æ—Ç–∞–µ–º\s+–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ',
                                # CHATIK –∏ –ø–ª–∞—Ç–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
                                r'—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ.*–æ–±—ä—è–≤–ª–µ–Ω–∏.*–ø–ª–∞—Ç–Ω', r'–ø–µ—Ä–µ–π–¥–∏—Ç–µ\s+–≤\s+@saleschatikbot',
                                r'–¥–ª—è\s+–∑–∞–∫–∞–∑–∞\s+–ø–µ—Ä–µ–π–¥–∏—Ç–µ\s+–≤\s+@saleschatikbot', r'saleschatikbot',
                                # BaliArenda –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
                                r'baliarenda\.com', r'@baliarenda_group', r'–ø–æ–¥—Ä–æ–±–Ω–µ–µ\s+–∏\s+–∫–æ–Ω—Ç–∞–∫—Ç—ã.*baliarenda',
                            ]
                            
                            if any(re.search(bp, text, re.IGNORECASE) for bp in misc_spam_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–Ω–∞–π–¥–µ–Ω —Å–ø–∞–º: —é—Ä.—É—Å–ª—É–≥–∏/–µ–¥–∞/–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞)")
                                continue

                            # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —á–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏
                            full_blacklist = job_blacklist + crypto_blacklist + items_blacklist + visa_blacklist + financial_spam
                            
                            if any(re.search(bp, text, re.IGNORECASE) for bp in full_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–Ω–∞–π–¥–µ–Ω —Å–ø–∞–º/–≤–µ—â–∏/–≤–∏–∑—ã/–∫—Ä–∏–ø—Ç–∞/—Ñ–∏–Ω–∞–Ω—Å—ã)")
                                continue
                        
                        # 2. –í–ò–î–ï–û–ì–†–ê–§/–§–û–¢–û–ì–†–ê–§: –ò—Å–∫–ª—é—á–∞–µ–º —Å–ø–∞–º, –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ AI
                        if niche in ["–í–∏–¥–µ–æ–≥—Ä–∞—Ñ", "–§–æ—Ç–æ–≥—Ä–∞—Ñ"]:
                            fake_docs_blacklist = [
                                # –î–æ–∫—É–º–µ–Ω—Ç—ã/–ö—Ä–∏–º–∏–Ω–∞–ª
                                r'–æ—Ç—Ä–∏—Å–æ–≤–∫–∞', r'–¥–æ–∫—É–º–µ–Ω—Ç', r'–ø–∞—Å–ø–æ—Ä—Ç', r'id\s+–∫–∞—Ä—Ç', 
                                r'—à—Ç–∞–º–ø', r'–ø–µ—á–∞—Ç—å', r'–≥–æ–ª–æ–≥—Ä–∞–º–º', r'–≤–Ω–∂', r'dl',
                                r'recover', r'banned', r'account', r'hack', r'unban', 
                                r'ip[- ]—Ç–µ–ª–µ—Ñ–æ–Ω–∏', r'voip', r'sip', r'–∫–æ–ª–ª[- ]—Ü–µ–Ω—Ç—Ä',
                                # AI –∏ –ù–µ–π—Ä–æ—Å–µ—Ç–∏ (Lexy, GPT –∏ —Ç.–¥.)
                                r'ai[- ]—Ñ–æ—Ç–æ', r'gpt', r'midjourney', r'–Ω–µ–π—Ä–æ—Å–µ—Ç', 
                                r'–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω.*–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç', r'—Å—Ç–∏–ª—å–Ω—ã–µ\s+–ø–æ—Ä—Ç—Ä–µ—Ç—ã.*–∏–∑.*–æ–±—ã—á–Ω—ã—Ö',
                                r'–±–æ—Ç' # —á–∞—Å—Ç–æ "–±–æ—Ç –¥–µ–ª–∞–µ—Ç —Ñ–æ—Ç–æ"
                            ]
                            if any(re.search(bp, text, re.IGNORECASE) for bp in fake_docs_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–¥–æ–∫—É–º–µ–Ω—Ç—ã/—Ö–∞–∫–µ—Ä—ã/AI-–±–æ—Ç—ã)")
                                continue
                            
                            # –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø–æ–¥–∫–∞—Å—Ç–æ–≤ –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π
                            podcast_blacklist = [
                                r'–ø–æ–¥–∫–∞—Å—Ç', r'—ç–ø–∏–∑–æ–¥', r'—Å–ª—É—à–∞–π—Ç–µ\s+–Ω–∞—Å', r'youtube', 
                                r'–æ–±—Å—É–∂–¥–∞–µ–º', r'–ø–æ—Ä–∞–∑–º—ã—à–ª—è—Ç—å', r'–º–∏—Ñ\s+–æ', r'–ø—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç'
                            ]
                            if any(re.search(w, text, re.IGNORECASE) for w in podcast_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–ø–æ–¥–∫–∞—Å—Ç/–±–ª–æ–≥)")
                                continue
                            
                            # –§–∏–ª—å—Ç—Ä –≤–æ–µ–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π / –ü–æ–ª–∏—Ç–∏–∫–∏ (–¥—Ä–æ–Ω—ã, –ë–ü–õ–ê, –ì–µ—Ä–∞–Ω—å)
                            war_news_blacklist = [
                                r'–±–ø–ª–∞', r'–¥—Ä–æ–Ω.*–≤—Å—É', r'–≥–µ—Ä–∞–Ω—å', r'–±–æ–µ–ø—Ä–∏–ø–∞—Å', r'–Ω–∞—Ç–æ',
                                r'—Ñ—Ä–æ–Ω—Ç', r'—Ä–∞–∑–≤–µ–¥–∫–∞', r'–≤–æ–µ–Ω–Ω', r'–∞—Ä–º–∏—è', r'—Ä–æ—Å—Å–∏–π—Å–∫.*–±–ø–ª–∞',
                                r'–∑–µ–Ω–∏—Ç–Ω—ã–π', r'—Ä–∞–∫–µ—Ç', r'–≤–∑—Ä—ã–≤', r'–ø–æ–≥–∏–±'
                            ]
                            if any(re.search(bp, text, re.IGNORECASE) for bp in war_news_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–≤–æ–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏)")
                                continue

                        # 3. –ê–†–ï–ù–î–ê –ê–í–¢–û/–¢–†–ê–ù–°–ü–û–†–¢: –ò—Å–∫–ª—é—á–∞–µ–º —Ä–µ–∫–ª–∞–º—É —á–∞—Ç–æ–≤
                        if niche in ["–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–ê—Ä–µ–Ω–¥–∞ –±–∞–π–∫–æ–≤"]:
                            bot_rules_blacklist = [
                                r'–æ–∑–Ω–∞–∫–æ–º—å—Å—è\s+—Å\s+–ø—Ä–∞–≤–∏–ª–∞–º–∏', r'–ø—Ä–∞–≤–∏–ª–∞–º–∏\s+—ç—Ç–æ–π\s+–≥—Ä—É–ø–ø—ã',
                                r'–ø–æ–¥–æ–±–Ω—ã–µ\s+—Ñ–æ—Ä—É–º—ã', r'–≤—Å–µ\s+–æ\s+—Ä–µ–∫–ª–∞–º–µ', r'–±–æ—Ç\s+–º–æ–¥–µ—Ä–∞—Ç–æ—Ä',
                                r'–∑–∞\s+–ø–æ–¥–ø–∏—Å–∫—É', r'–≥–∞–π–¥', r'—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä'
                            ]
                            if any(re.search(bp, text, re.IGNORECASE) for bp in bot_rules_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (—Ä–µ–∫–ª–∞–º–∞ —á–∞—Ç–∞/–±–æ—Ç–∞)")
                                continue
                        
                        # 4. –¢–†–ê–ù–°–ü–û–†–¢: –ò—Å–∫–ª—é—á–∞–µ–º —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
                        if niche in ["–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ", "–ê—Ä–µ–Ω–¥–∞ –±–∞–π–∫–æ–≤"]:
                            tech_support_blacklist = [
                                r'–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏[—è—é]', r'–∫–æ–¥.*—Å–º—Å', r'sms', r'whatsapp.*–∫–æ–¥',
                                r'–Ω–µ\s+–ø—Ä–∏—Ö–æ–¥–∏—Ç', r'–≥–ª—é—á–∏—Ç', r'–Ω–µ\s+—Ä–∞–±–æ—Ç–∞–µ—Ç.*–ø—Ä–∏–ª–æ–∂–µ–Ω–∏',
                                r'—Å–∫–∞—á–∞—Ç—å', r'app\s+store', r'google\s+play'
                            ]
                            if any(re.search(bp, text, re.IGNORECASE) for bp in tech_support_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)")
                                continue
                            
                            # –§–∏–ª—å—Ç—Ä –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ –¥–æ–∫—É–º–µ–Ω—Ç—ã/–ø—Ä–∞–≤–∞/–∫–∞—Ä—Ç—ã
                            legal_questions = [
                                r'–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ', r'–∫–∞–∫\s+–ø–æ–ª—É—á–∏—Ç—å', r'–º–æ–∂–Ω–æ\s+–ª–∏', r'–Ω—É–∂–Ω–æ\s+–ª–∏',
                                r'–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ\s+–ø—Ä–∞–≤–∞', r'—Å—Ä–æ–∫\s+–¥–µ–π—Å—Ç–≤–∏—è', r'–∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏–µ\s+–ø—Ä–∞–≤–∞',
                                r'—Ä–æ—Å—Å–∏–π—Å–∫–∏–µ\s+–ø—Ä–∞–≤–∞', r'–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ', r'–∫–∞—Ä—Ç—É\s+–≤—ã–ø—É—Å—Ç–∏—Ç—å'
                            ]
                            
                            # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–æ–≤–∞ –ø—Ä–æ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ò —Å–ª–æ–≤–∞ –≤–æ–ø—Ä–æ—Å–∞ - —ç—Ç–æ –Ω–µ –∫–æ–º–º–µ—Ä—Ü–∏—è
                            is_question = any(re.search(w, text, re.IGNORECASE) for w in [r'\?', r'–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ', r'–≤–æ–ø—Ä–æ—Å'])
                            has_legal_context = any(re.search(w, text, re.IGNORECASE) for w in legal_questions)
                            
                            if is_question and has_legal_context:
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ –ø—Ä–∞–≤–∞/–∫–∞—Ä—Ç—ã)")
                                continue
                            
                            # –§–∏–ª—å—Ç—Ä –≤–∞–∫–∞–Ω—Å–∏–π –≤–æ–¥–∏—Ç–µ–ª–µ–π (—ç—Ç–æ —Ä–∞–±–æ—Ç–∞, –∞ –Ω–µ –∑–∞–∫–∞–∑ —Ç–∞–∫—Å–∏)
                            driver_job_blacklist = [
                                r'–∏—â–µ–º\s+–≤–æ–¥–∏—Ç–µ–ª—è', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+–≤–æ–¥–∏—Ç–µ–ª—å', r'–Ω—É–∂–µ–Ω\s+–≤–æ–¥–∏—Ç–µ–ª—å.*–∑–ø',
                                r'–∑–ø\s+–≤\s+–¥–µ–Ω—å', r'–æ–ø–ª–∞—Ç–∞\s+–¥–æ.*—Ä', r'–≤—ã–ø–ª–∞—Ç–∞\s+—Å—Ä–∞–∑—É',
                                r'–∑–∞–Ω—è—Ç–æ—Å—Ç—å.*—á–∞—Å–∞', r'–ø–µ—à–∏–π.*–∫—É—Ä—å–µ—Ä'
                            ]
                            if any(re.search(bp, text, re.IGNORECASE) for bp in driver_job_blacklist):
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–≤–∞–∫–∞–Ω—Å–∏—è –≤–æ–¥–∏—Ç–µ–ª—è)")
                                continue

                        # 5. –¢–£–†–ò–ó–ú: –£–±–∏—Ä–∞–µ–º "–∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ –∂–∏–∑–Ω–∏" (–ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞)
                        if niche == "–¢—É—Ä–∏–∑–º":
                            # –ì–ª–∞–≥–æ–ª—ã –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ —Ä–∞—Å—Å–∫–∞–∑–∞/–æ—Ç–∑—ã–≤–∞
                            narrative_words = [
                                r'–ø–æ–µ—Ö–∞–ª–∏', r'–µ–∑–¥–∏–ª–∏', r'–±—ã–ª–∏', r'–æ–∫–∞–∑–∞–ª–∏—Å—å', r'–≤–∏–¥–µ–ª–∏',
                                r'–ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å', r'–≤–µ—Ä–Ω—É–ª–∏—Å—å', r'–ª–µ—Ç–∞–ª–∏', r'–æ—Ç–¥–æ—Ö–Ω—É–ª–∏'
                            ]
                            is_story = any(re.search(w, text, re.IGNORECASE) for w in narrative_words)

                            # –°–ª–æ–≤–∞ —è–≤–Ω–æ–≥–æ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
                            tourism_intent = [
                                r'–∏—â[—É–µ—é]', r'–Ω—É–∂–µ–Ω', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ', r'—Ü–µ–Ω–∞', r'—Å—Ç–æ–∏–º–æ—Å—Ç—å',
                                r'—Ç—É—Ä\s+–Ω–∞', r'—ç–∫—Å–∫—É—Ä—Å–∏[—è—é]', r'–≥–∏–¥'
                            ]
                            has_tourism_intent = any(re.search(w, text, re.IGNORECASE) for w in tourism_intent)

                            if is_story and not has_tourism_intent:
                                logger.info(f"üõë –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–∏—Å—Ç–æ—Ä–∏—è/–æ—Ç–∑—ã–≤, –∞ –Ω–µ –∑–∞–ø—Ä–æ—Å)")
                                continue

                        # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–∏–∑ –≤–∞—à–µ–≥–æ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞)
                        if is_exchange_message and niche != "–û–±–º–µ–Ω –≤–∞–ª—é—Ç": continue
                        if niche == "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" and is_chef_search: continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏ –µ—Å—Ç—å —Ç–µ—Ö–Ω–∏–∫–∞/–æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–±–∏–ª–µ—Ç—ã - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏":
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É (iPhone, iPad, —Ç–µ–ª–µ—Ñ–æ–Ω, —Å–º–∞—Ä—Ç—Ñ–æ–Ω, –∫–æ–º–ø—å—é—Ç–µ—Ä, –Ω–æ—É—Ç–±—É–∫, –ø–ª–∞–Ω—à–µ—Ç)
                            tech_patterns = [
                                r'\biphone\b', r'\bipad\b', r'\b—Ç–µ–ª–µ—Ñ–æ–Ω\b', r'\b—Å–º–∞—Ä—Ç—Ñ–æ–Ω\b',
                                r'\b–∫–æ–º–ø—å—é—Ç–µ—Ä\b', r'\b–Ω–æ—É—Ç–±—É–∫\b', r'\b–ø–ª–∞–Ω—à–µ—Ç\b', r'\b—Ç–µ—Ö–Ω–∏–∫[–∞—É]\b'
                            ]
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ–¥–µ–∂–¥—É/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã (—Å—É–º–∫–∞, –æ–¥–µ–∂–¥–∞, —É–∫—Ä–∞—à–µ–Ω–∏—è, –ø–∞—Ä—Ñ—é–º)
                            non_real_estate_patterns = [
                                r'\b—Å—É–º–∫[–∞—É]\b', r'\b–æ–¥–µ–∂–¥[–∞—É]\b', r'\b—É–∫—Ä–∞—à–µ–Ω–∏[—è–∏]\b', r'\b–ø–∞—Ä—Ñ—é–º\b',
                                r'\b–∫–æ—Å–º–µ—Ç–∏–∫[–∞—É]\b', r'\b–ª–æ–Ω–≥—Å–ª–∏–≤\b', r'\b—é–±–∫[–∞—É]\b', r'\b—Å–≤–∏—Ç–µ—Ä\b',
                                r'\b–æ–ª–∏–º–ø–∏–π–∫[–∞—É]\b', r'\b–±–æ—Ç–∏–Ω–∫[–∏—ã]\b', r'\b—Ç—É—Ñ–ª[–∏—ã]\b', r'\b–æ–±—É–≤[—å–∏]\b',
                                r'\b–∫—Ä–æ—Å—Å–æ–≤–∫[–∏—ã]\b', r'\b—Å–∞–Ω–¥–∞–ª[–∏—ã]\b', r'\b—Å–µ—Ä—å–≥[–∏—ã]\b', r'\b–ø–∏—Ä—Å–∏–Ω–≥\b',
                                r'\b—Ä—é–∫–∑–∞–∫\b', r'\b—á–æ–∫–µ—Ä\b', r'\b–≥–∞–ª—Å—Ç—É–∫\b', r'\b–±—Ä–∞—Å–ª–µ—Ç\b'
                            ]
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –±–∏–ª–µ—Ç—ã/–∫–æ–Ω—Ü–µ—Ä—Ç—ã/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
                            ticket_patterns = [
                                r'\b–±–∏–ª–µ—Ç[–∞—ã—É]?\b', r'\b–∫–æ–Ω—Ü–µ—Ä—Ç[–∞—ã—É]?\b', r'\b–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏[—è–µ–∏—é]\b',
                                r'\b—Ñ–∞–Ω–∑–æ–Ω[–∞—É—ã]?\b', r'\b–∫–æ–Ω—Ü–µ—Ä—Ç–Ω[—ã–π–æ–≥–æ]?\s+–±–∏–ª–µ—Ç', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+–∫–æ–Ω—Ü–µ—Ä—Ç',
                                r'\b–ø—Ä–æ–¥–∞–º\s+–±–∏–ª–µ—Ç', r'\b–ø—Ä–æ–¥–∞—é\s+–±–∏–ª–µ—Ç', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏',
                                r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—è–Ω–≤–∞—Ä', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—Ñ–µ–≤—Ä–∞–ª', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–º–∞—Ä—Ç',
                                r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∞–ø—Ä–µ–ª', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–º–∞–π', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∏—é–Ω',
                                r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∏—é–ª', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–∞–≤–≥—É—Å—Ç', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+—Å–µ–Ω—Ç—è–±—Ä',
                                r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–æ–∫—Ç—è–±—Ä', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–Ω–æ—è–±—Ä', r'\b–±–∏–ª–µ—Ç\s+–Ω–∞\s+\d+\s+–¥–µ–∫–∞–±—Ä'
                            ]
                            has_tech = any(re.search(pattern, text_lower, re.IGNORECASE) for pattern in tech_patterns)
                            has_non_real_estate = any(re.search(pattern, text_lower, re.IGNORECASE) for pattern in non_real_estate_patterns)
                            has_ticket = any(re.search(pattern, text_lower, re.IGNORECASE) for pattern in ticket_patterns)
                            
                            if has_tech or has_non_real_estate or has_ticket:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞/–æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–±–∏–ª–µ—Ç—ã (—Ç–µ—Ö–Ω–∏–∫–∞: {has_tech}, –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å: {has_non_real_estate}, –±–∏–ª–µ—Ç—ã: {has_ticket})")
                            continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è" –∏ –µ—Å—Ç—å –∫–ª–∏–Ω–∏–Ω–≥/—É–±–æ—Ä–∫–∞ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è":
                            cleaning_keywords = [r'–∫–ª–∏–Ω–∏–Ω–≥', r'—É–±–æ—Ä–∫', r'–≥–µ–Ω–µ—Ä–∞–ª—å–Ω.*—É–±–æ—Ä–∫', r'—É–±–æ—Ä–∫.*–∫–≤–∞—Ä—Ç–∏—Ä', r'—É–±–æ—Ä–∫.*–¥–æ–º',
                                                r'–∫–ª–∏–Ω–∏–Ω–≥.*—É—Å–ª—É–≥', r'—É–±–æ—Ä–∫.*—É—Å–ª—É–≥', r'–∫–ª–∏–Ω–∏–Ω–≥.*–∫–æ–º–ø–∞–Ω–∏', r'—É–±–æ—Ä–∫.*–∫–æ–º–ø–∞–Ω–∏']
                            has_cleaning = any(re.search(kw, text, re.IGNORECASE) for kw in cleaning_keywords)
                            if has_cleaning:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω –∫–ª–∏–Ω–∏–Ω–≥/—É–±–æ—Ä–∫–∞, –∞ –Ω–µ –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è")
                                continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–û–±–º–µ–Ω –≤–∞–ª—é—Ç" –∏ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞ –Ω–∞ –ë–∏–Ω–∞–Ω—Å/–ë–∞–π–±–∏—Ç/–∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞—Ö - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º (—ç—Ç–æ —Å–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É)
                        if niche == "–û–±–º–µ–Ω –≤–∞–ª—é—Ç":
                            crypto_work_keywords = [r'—Ä–∞–±–æ—Ç–∞.*–±–∏–Ω–∞–Ω—Å', r'—Ä–∞–±–æ—Ç–∞.*–±–∞–π–±–∏—Ç', r'—Ä–∞–±–æ—Ç–∞.*binance', r'—Ä–∞–±–æ—Ç–∞.*bybit',
                                                   r'–∏—â–µ–º.*–ª—é–¥.*—Ä–∞–±–æ—Ç.*–±–∏–Ω–∞–Ω—Å', r'–∏—â–µ–º.*–ª—é–¥.*—Ä–∞–±–æ—Ç.*–±–∞–π–±–∏—Ç',
                                                   r'—Ä–∞–±–æ—Ç–∞.*–∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂', r'—Ä–∞–±–æ—Ç–∞.*–∫—Ä–∏–ø—Ç–æ.*–±–∏—Ä–∂',
                                                   r'–æ–ø–ª–∞—Ç–∞.*–µ–∂–µ–¥–Ω–µ–≤–Ω–æ', r'–±–µ—Å–ø–ª–∞—Ç–Ω.*–æ–±—É—á–µ–Ω–∏', r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*—Å—É–±–±–æ—Ç',
                                                   r'–ø–∏—à–∏—Ç–µ.*\+.*–ª—Å', r'–ø–∏—à–∏—Ç–µ.*–ø–ª—é—Å.*–ª—Å', r'–¥–ª—è.*–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç.*–ª—Å']
                            has_crypto_work = any(re.search(kw, text, re.IGNORECASE) for kw in crypto_work_keywords)
                            if has_crypto_work:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –Ω–∞ –∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞—Ö, –∞ –Ω–µ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç")
                                continue
                            
                            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (—ç—Ç–æ —Å–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É)
                            manager_card_keywords = [r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–∑–∞–ø–æ–ª–Ω–µ–Ω–∏.*–∫–∞—Ä—Ç–æ—á–µ–∫', r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫', r'–∑–∞–ø–æ–ª–Ω–µ–Ω–∏.*–∫–∞—Ä—Ç–æ—á–µ–∫',
                                                    r'—é–Ω–∏—Ç.*—ç–∫–æ–Ω–æ–º–∏–∫', r'–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω.*—Ä–∞–±–æ—Ç', r'—Ä–∞–±–æ—Ç–∞.*–∫–∞—Ä—Ç–æ—á–∫',
                                                    r'—Å—Ç–æ–∏–º–æ—Å—Ç—å.*–ª—Å', r'—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ.*–æ.*—Å–µ–±–µ.*–ª—Å', r'—á—Ç–æ.*–º–æ–∂–µ—Ç–µ.*—Å–¥–µ–ª–∞—Ç—å.*–ª—Å']
                            has_manager_card = any(re.search(kw, text, re.IGNORECASE) for kw in manager_card_keywords)
                            if has_manager_card:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Å–ø–∞–º –ø—Ä–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫, –∞ –Ω–µ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç")
                                continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏ –µ—Å—Ç—å –ù–î–°/—á–µ–∫–∏/–±—É–º–∞–∂–Ω—ã–π –ù–î–° - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏":
                            vat_keywords = [r'–±—É–º–∞–∂–Ω.*–Ω–¥—Å', r'–Ω–¥—Å.*–±—É–º–∞–∂–Ω', r'—á–µ–∫–∏.*–Ω–¥—Å', r'–Ω–¥—Å.*—á–µ–∫–∏',
                                          r'—É—Å–ª—É–≥.*–Ω–¥—Å', r'–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º.*–Ω–¥—Å', r'–ø–æ–¥–∞—á.*–Ω–¥—Å', r'–Ω–¥—Å.*–±–µ–∑\s+—Ä–∞–∑—Ä—ã–≤–æ–≤',
                                          r'–≥–∞—Ä–∞–Ω—Ç–∏.*—É—Å–ª—É–≥.*\d+\s*–≥–æ–¥', r'—Å—Ç–æ–∏–º–æ—Å—Ç—å.*—É—Å–ª—É–≥.*\d+%', r'–æ–ø–ª–∞—Ç.*–ø–æ\s+—Ñ–∞–∫—Ç—É',
                                          r'–∑–∞–∫—Ä—ã—Ç–∏.*–Ω–¥—Å.*—á–µ–∫–∏', r'–Ω–¥—Å.*—á–µ–∫–∏.*qr', r'—á–µ–∫–∏.*qr.*–∫–æ–¥']
                            has_vat = any(re.search(kw, text, re.IGNORECASE) for kw in vat_keywords)
                            if has_vat:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Å–ø–∞–º –ø—Ä–æ –ù–î–°/—á–µ–∫–∏, –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")
                                continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞/–æ–±–º–µ–Ω –≤–∞–ª—é—Ç - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏":
                            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–±–æ—Ç—É/–ø–æ–¥—Ä–∞–±–æ—Ç–∫—É
                            work_keywords = [
                                r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–∏—â–µ–º.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫',
                                           r'—Å–∫–ª–∞–¥.*–ø–≤–∑', r'–ø–≤–∑.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*–ø–≤–∑',
                                           r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏.*–ø–æ—Ä—è–¥–∫.*—Å–∫–ª–∞–¥', r'—Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å.*–∫–æ—Ä–æ–±–∫', r'–ø—Ä–æ–≤–µ—Ä—è—Ç—å.*–ø–æ–ª–∫',
                                           r'–∑–∞\s+—Å–º–µ–Ω—É.*\d+\s*‚ÇΩ', r'\d+\s*‚ÇΩ.*–∑–∞\s+—Å–º–µ–Ω—É', r'\d+\s*—Ä—É–±–ª.*–∑–∞\s+—Å–º–µ–Ω—É',
                                           r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥.*18\+', r'—Å–∫–ª–∞–¥.*–¥–ª—è\s+18\+', r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏.*–ø–æ—Ä—è–¥–∫.*18\+',
                                           # –ü–µ—Ä—Å–æ–Ω–∞–ª, —Ä–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞
                                           r'–Ω—É–∂–µ–Ω.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'–∏—â—É.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è.*–ø–µ—Ä—Å–æ–Ω–∞–ª',
                                           r'–æ–ø—ã—Ç.*—Ä–∞–±–æ—Ç—ã.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–æ–ø—ã—Ç.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–±–µ–∑.*–æ–ø—ã—Ç–∞.*—Ä–∞–±–æ—Ç—ã',
                                # –ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞
                                r'–ø–æ–¥—Ä–∞–±–æ—Ç–∫[–∞—É]', r'–ø–æ–¥—Ä–∞–±–æ—Ç–∫[–∞—É].*–Ω–∞\s+—Ä–∞–∑–¥–∞—á', r'—Ä–∞–∑–¥–∞—á[–∞—É].*—Å—É–≤–µ–Ω–∏—Ä',
                                r'–≤—ã–¥–∞–≤–∞—Ç—å.*–ø–æ–¥–∞—Ä–∫', r'–æ—Ç–º–µ—á–∞—Ç—å.*–ø–æ–ª—É—á–∞—Ç–µ–ª', r'–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å.*–ø–æ—Ä—è–¥–æ–∫',
                                r'–æ–ø–ª–∞—Ç[–∞—É].*\d+[‚Äì-]\d+\s*‚ÇΩ', r'–æ–ø–ª–∞—Ç[–∞—É].*\d+\s*‚ÇΩ',
                            ]
                            has_work = any(re.search(kw, text, re.IGNORECASE) for kw in work_keywords)
                            if has_work:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞, –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")
                                continue
                        
                            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç (—Ä—É–ø–∏–∏, –≤–∞–ª—é—Ç–∞)
                            currency_keywords = [
                                r'—Ä—É–ø–∏[–∏—ã]', r'–æ—Å—Ç–∞–ª–∏—Å—å.*—Ä—É–ø–∏', r'—Ä—É–ø–∏.*–ø–æ—Å–ª–µ\s+–ø–æ–µ–∑–¥–∫', r'–æ–±–º–µ–Ω.*—Ä—É–ø–∏',
                                r'–≤–∞–ª—é—Ç–∞', r'–æ–±–º–µ–Ω.*–≤–∞–ª—é—Ç', r'–∫—É–ø–ª—é.*–≤–∞–ª—é—Ç', r'–ø—Ä–æ–¥–∞–º.*–≤–∞–ª—é—Ç',
                                r'usdt', r'usdc', r'—Ç–µ–∑–µ—Ä', r'–∫—Ä–∏–ø—Ç', r'–¥–æ–ª–ª–∞—Ä', r'–µ–≤—Ä–æ',
                            ]
                            has_currency = any(re.search(kw, text, re.IGNORECASE) for kw in currency_keywords)
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
                            real_estate_keywords = [r'–∫–≤–∞—Ä—Ç–∏—Ä', r'–¥–æ–º', r'–≤–∏–ª–ª', r'–∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç', r'–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', r'—É—á–∞—Å—Ç–æ–∫', r'–∑–µ–º–ª', r'–∂–∏–ª—å[–µ—ë]']
                            has_real_estate = any(re.search(kw, text, re.IGNORECASE) for kw in real_estate_keywords)
                            if has_currency and not has_real_estate:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω –æ–±–º–µ–Ω –≤–∞–ª—é—Ç –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏")
                                continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç" –∏ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞/—Å–ø–∞–º - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º (—ç—Ç–æ —Å–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É, –∞ –Ω–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç)
                        if niche == "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç":
                            work_keywords = [r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–∏—â–µ–º.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫',
                                           r'—Å–∫–ª–∞–¥.*–ø–≤–∑', r'–ø–≤–∑.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*–ø–≤–∑',
                                           r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏.*–ø–æ—Ä—è–¥–∫.*—Å–∫–ª–∞–¥', r'—Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å.*–∫–æ—Ä–æ–±–∫', r'–ø—Ä–æ–≤–µ—Ä—è—Ç—å.*–ø–æ–ª–∫',
                                           r'–∑–∞\s+—Å–º–µ–Ω—É.*\d+\s*‚ÇΩ', r'\d+\s*‚ÇΩ.*–∑–∞\s+—Å–º–µ–Ω—É', r'\d+\s*—Ä—É–±–ª.*–∑–∞\s+—Å–º–µ–Ω—É',
                                           r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥.*18\+', r'—Å–∫–ª–∞–¥.*–¥–ª—è\s+18\+', r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏.*–ø–æ—Ä—è–¥–∫.*18\+',
                                           r'—Å—Ç–∞–±–∏–ª—å–Ω.*–≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º.*–¥–æ–ª–∂–Ω–æ—Å—Ç', r'–≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º.*–¥–æ–ª–∂–Ω–æ—Å—Ç',
                                           r'–Ω–æ–≤–æ–≥–æ–¥–Ω[–∞—è—É—é].*—Ç–µ–º–∞.*–±–∞–ª–∞–Ω—Å.*—Ç–∞–∫—Å–∏',  # –ù–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏
                                           r'–ø–ª–∞—á—É.*–ø–æ.*–≤—Ä–µ–º–µ–Ω–∏', r'–ø–ª–∞—á—É.*–≤—Ä–µ–º—è',  # –ü–ª–∞—á—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏
                                           r'gsm[-\s]?—Ç–µ–ª–µ—Ñ–æ–Ω–∏[—è–∏]', r'–º–æ—â–Ω—ã–π\s+–¥–æ–∑–≤–æ–Ω',  # GSM-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è
                                           ]
                            has_work = any(re.search(kw, text, re.IGNORECASE) for kw in work_keywords)
                            if has_work:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞/—Å–ø–∞–º, –∞ –Ω–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏")
                                continue
                            
                            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å "–≥–¥–µ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –º–∞—à–∏–Ω—É" - –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ "–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ", —É–±–∏—Ä–∞–µ–º –¥—Ä—É–≥–∏–µ –Ω–∏—à–∏
                            if re.search(r'(–≥–¥–µ|–∫–∞–∫|–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ|—Å–∫–∞–∂–∏—Ç–µ).{0,50}(–∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å|–∞—Ä–µ–Ω–¥|–ø—Ä–æ–∫–∞—Ç).{0,50}(–º–∞—à–∏–Ω|–∞–≤—Ç–æ|–∞–≤—Ç–æ–º–æ–±–∏–ª)', text, re.IGNORECASE):
                                # –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ –∞—Ä–µ–Ω–¥—É –∞–≤—Ç–æ, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –¥—Ä—É–≥–∏–µ –Ω–∏—à–∏
                                if niche not in ["–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ"]:
                                    logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –ø—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ –∞—Ä–µ–Ω–¥—É –∞–≤—Ç–æ, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ '–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ'")
                                continue
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —ç—Ç–æ "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏ –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã (–æ–±—É–≤—å/—Ç–µ–ª–µ—Ñ–æ–Ω/–æ–¥–µ–∂–¥–∞/–º–µ–±–µ–ª—å) - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" and is_non_real_estate:
                            logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Ç–æ–≤–∞—Ä (–æ–±—É–≤—å/—Ç–µ–ª–µ—Ñ–æ–Ω/—Ç–µ—Ö–Ω–∏–∫–∞/–æ–¥–µ–∂–¥–∞/–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã/–º–µ–±–µ–ª—å), –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")
                            continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏" –∏ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞/–ø–µ—Ä—Å–æ–Ω–∞–ª - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏":
                            work_keywords = [r'–Ω—É–∂–µ–Ω.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'–∏—â—É.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'–º–Ω–µ.*–Ω—É–∂–µ–Ω.*–ø–µ—Ä—Å–æ–Ω–∞–ª',
                                           r'–æ–ø—ã—Ç.*—Ä–∞–±–æ—Ç—ã.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–æ–ø—ã—Ç.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–±–µ–∑.*–æ–ø—ã—Ç–∞.*—Ä–∞–±–æ—Ç—ã',
                                           r'—Ä–∞–±–æ—Ç–∞—Ç—å.*–∏–∑.*–¥–æ–º', r'—Ä–∞–±–æ—Ç–∞.*–∏–∑.*–¥–æ–º', r'—Ä–∞–±–æ—Ç–∞.*–Ω–∞.*–¥–æ–º',
                                           r'–Ω–µ–ø–æ–ª–Ω.*—Ä–∞–±–æ—á.*–¥–µ–Ω—å', r'–Ω–µ–ø–æ–ª–Ω—ã–π.*—Ä–∞–±–æ—á–∏–π.*–¥–µ–Ω—å', r'–Ω–µ–ø–æ–ª–Ω.*–¥–µ–Ω—å',
                                           r'—Å\s+\d+:\d+\s+–¥–æ\s+\d+:\d+', r'—Ö–æ—Ä–æ—à.*–∑–∞—Ä–ø–ª–∞—Ç', r'–≤—ã—Å–æ–∫.*–∑–∞—Ä–ø–ª–∞—Ç',
                                           r'–æ—Ç–ø—Ä–∞–≤—å—Ç–µ.*—Å–æ–æ–±—â–µ–Ω–∏.*tg', r'–æ—Ç–ø—Ä–∞–≤—å—Ç–µ.*—Å–æ–æ–±—â–µ–Ω–∏.*whatsapp',
                                           r'–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.*–æ—Ç–ø—Ä–∞–≤—å—Ç–µ', r'–µ—Å–ª–∏.*–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.*–æ—Ç–ø—Ä–∞–≤—å—Ç–µ']
                            has_work = any(re.search(kw, text, re.IGNORECASE) for kw in work_keywords)
                            if has_work:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞/–ø–µ—Ä—Å–æ–Ω–∞–ª, –∞ –Ω–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å")
                                continue
                        
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —ç—Ç–æ "–ö–∞–ª—å—è–Ω—ã" –∏ –µ—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ç–∞–±–∞–∫–∞, –Ω–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–∞–ª—å—è–Ω–æ–≤ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                        if niche == "–ö–∞–ª—å—è–Ω—ã" and has_tobacco and not has_hookah:
                            logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∞–±–∞–∫ –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–∞–ª—å—è–Ω–æ–≤")
                            continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ "–ú–µ–¥–∏–∞-—Å—Ç—É–¥–∏—è" - –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ —Å—Ç—É–¥–∏—é, –∞ –Ω–µ –ø—Ä–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –±–∏–∑–Ω–µ—Å–∞/–±–∞–Ω–∫–∏
                        if niche == "–ú–µ–¥–∏–∞-—Å—Ç—É–¥–∏—è":
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞, –±–∞–Ω–∫–æ–≤, –≥–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä
                            business_keywords = [r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏.*–±–∏–∑–Ω–µ—Å', r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏.*–æ–æ–æ', r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏.*–∏–ø', r'–æ—Ç–∫—Ä—ã—Ç–∏.*—Å—á–µ—Ç',
                                                r'—Ä–∞—Å—á—ë—Ç–Ω.*—Å—á–µ—Ç', r'–ø–æ–¥–±–æ—Ä.*–∫–æ–º–ø–∞–Ω–∏.*–ª–∏–∑–∏–Ω–≥', r'–ø–æ–¥–∫–ª—é—á–µ–Ω–∏.*—Å–±–∏—Å', r'–ø–æ–¥–∫–ª—é—á–µ–Ω–∏.*–∫–æ–Ω—Ç—É—Ä',
                                                r'–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏.*–¥–æ–∫—É–º–µ–Ω—Ç', r'—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω.*–ø–æ–¥–ø–∏—Å', r'—ç—Ü–ø', r'–Ω–∞–π–¥–µ–º.*–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏', r'–ø—Ä–æ–±—å–µ–º',
                                                r'–æ—Ç–∫–æ–ø–∞–µ–º', r'–≥–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä', r'–µ–º–∏–∞—Å', r'—Å–æ—Ç–æ–≤.*–æ–ø–µ—Ä–∞—Ç–æ—Ä', r'\b–±–∞–Ω–∫[–∏—ã]?\b', r'–Ω–∞–ª–æ–≥–æ–≤.*–Ω–∞–≥—Ä—É–∑–∫',
                                                r'–æ–æ–æ.*–∏–ø', r'—Ñ–æ–Ω–¥[—ã—ã]?.*–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏', r'—É—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω.*–¥–æ–∫—É–º–µ–Ω—Ç']
                            has_business = any(re.search(kw, text, re.IGNORECASE) for kw in business_keywords)
                            
                            # –ï—Å–ª–∏ –µ—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞/–±–∞–Ω–∫–æ–≤, –Ω–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å—Ç—É–¥–∏–∏ –¥–ª—è —Å—ä–µ–º–æ–∫ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
                            if has_business:
                                studio_keywords = [r'—Ñ–æ—Ç–æ—Å—Ç—É–¥–∏', r'–≤–∏–¥–µ–æ—Å—Ç—É–¥–∏', r'–º–µ–¥–∏–∞—Å—Ç—É–¥–∏', r'—Å—ä–µ–º–æ—á–Ω.*–ø–ª–æ—â–∞–¥–∫', r'—Ñ–æ—Ç–æ.*–∑–æ–Ω', r'–≤–∏–¥–µ–æ.*–∑–æ–Ω',
                                                  r'–∞—Ä–µ–Ω–¥.*—Å—Ç—É–¥–∏', r'–ø—Ä–æ–∫–∞—Ç.*—Å—Ç—É–¥–∏', r'–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏.*–æ—Å–≤–µ—â–µ–Ω–∏', r'—Ñ–æ–Ω.*–≤–∫–ª—é—á–µ–Ω', r'—Å—Ç—É–¥–∏[—è–∏].*—Å—ä–µ–º–∫']
                                has_studio = any(re.search(kw, text, re.IGNORECASE) for kw in studio_keywords)
                                
                                if not has_studio:
                                    logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –±–∏–∑–Ω–µ—Å–∞/–±–∞–Ω–∫–∏, –∞ –Ω–µ –ø—Ä–æ —Å—Ç—É–¥–∏—é –¥–ª—è —Å—ä–µ–º–æ–∫")
                                    continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –î–ª—è –Ω–∏—à "–†–µ—Å–Ω–∏—á–∫–∏", "–ë—Ä–æ–≤–∏", "–ú–∞–Ω–∏–∫—é—Ä" - —Ç—Ä–µ–±—É–µ–º –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                        if niche in ["–†–µ—Å–Ω–∏—á–∫–∏", "–ë—Ä–æ–≤–∏", "–ú–∞–Ω–∏–∫—é—Ä"]:
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –µ—Å—Ç—å —è–≤–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —ç—Ç–∏—Ö –Ω–∏—à
                            strict_keywords = {
                                "–†–µ—Å–Ω–∏—á–∫–∏": [r'\b—Ä–µ—Å–Ω–∏—Ü', r'\b–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏.*—Ä–µ—Å–Ω–∏—Ü', r'\b–º–∞—Å—Ç–µ—Ä.*—Ä–µ—Å–Ω–∏—Ü', r'\b–æ–±—ä–µ–º.*—Ä–µ—Å–Ω–∏—Ü', r'\b–¥–∏–∑–∞–π–Ω.*—Ä–µ—Å–Ω–∏—Ü', r'\blash\b'],
                                "–ë—Ä–æ–≤–∏": [r'\b–±—Ä–æ–≤', r'\b–∫–æ—Ä—Ä–µ–∫—Ü–∏.*–±—Ä–æ–≤', r'\b—Ç–∞—Ç—É–∞–∂.*–±—Ä–æ–≤', r'\b–æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏.*–±—Ä–æ–≤', r'\b–º–∞—Å—Ç–µ—Ä.*–±—Ä–æ–≤', r'\b–¥–∏–∑–∞–π–Ω.*–±—Ä–æ–≤', r'\b–ª–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏.*–±—Ä–æ–≤'],
                                "–ú–∞–Ω–∏–∫—é—Ä": [r'\b–º–∞–Ω–∏–∫—é—Ä', r'\b–Ω–æ–≥—Ç', r'\b–Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏.*–Ω–æ–≥—Ç', r'\b–¥–∏–∑–∞–π–Ω.*–Ω–æ–≥—Ç', r'\b–ø–µ–¥–∏–∫—é—Ä', r'\b–≥–µ–ª—å.*–ª–∞–∫', r'\b—à–µ–ª–ª–∞–∫', r'\b–º–∞—Å—Ç–µ—Ä.*–º–∞–Ω–∏–∫—é—Ä']
                            }
                            niche_keywords = strict_keywords.get(niche, [])
                            has_strict_keyword = any(re.search(kw, text, re.IGNORECASE) for kw in niche_keywords)
                            
                            if not has_strict_keyword:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - –Ω–µ—Ç —è–≤–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è —ç—Ç–æ–π –Ω–∏—à–∏ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)")
                                continue
                        
                        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ/–æ–±—â–µ–µ - –ø—Ä–æ–≤–µ—Ä—è–µ–º —è–≤–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –í–°–ï–• –Ω–∏—à
                        if (is_very_short or is_question_only):
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —è–≤–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —ç—Ç–æ–π –Ω–∏—à–∏
                            explicit_keywords = explicit_keywords_by_niche.get(niche, [])
                            has_explicit = any(re.search(kw, text, re.IGNORECASE) for kw in explicit_keywords) if explicit_keywords else False
                            
                            # –ï—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç—É –Ω–∏—à—É
                            if not has_explicit:
                                logger.info(f"üîç –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∏—à—É '{niche}' - —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ/–æ–±—â–µ–µ ({message_length} —Å–∏–º–≤–æ–ª–æ–≤) –∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è —ç—Ç–æ–π –Ω–∏—à–∏")
                                continue
                        
                        # -----------------------------------------------------------------
                        # üí∞ –ü–†–û–í–ï–†–ö–ê –ù–ê–ú–ï–†–ï–ù–ò–ô –¥–ª—è –Ω–∏—à, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
                        # –î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–∏—à (–±–∞–π–∫–∏, –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å) —Ç—Ä–µ–±—É–µ–º —è–≤–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
                        # -----------------------------------------------------------------
                        # –û—Å—Ç–∞–≤–ª—è–µ–º –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö —Ç–æ–ª—å–∫–æ –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (—Ç–∞–∫—Å–∏) –∏ –û–±–º–µ–Ω,
                        # —Ç–∞–∫ –∫–∞–∫ —Ç–∞–º —á–∞—Å—Ç–æ –ø–∏—à—É—Ç –∫–æ—Ä–æ—Ç–∫–æ: "–£–±—É–¥ –ö—É—Ç–∞" –∏–ª–∏ "–ù–∞–ª –Ω–∞ –±–µ–∑–Ω–∞–ª".
                        # –î–ª—è –∞—Ä–µ–Ω–¥—ã –±–∞–π–∫–æ–≤ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω—É–∂–Ω—ã —Å–ª–æ–≤–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏—è (—Å–Ω—è—Ç—å/—Å–¥–∞—Ç—å/—Ü–µ–Ω–∞).
                        skip_intent_check_niches = ["–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–û–±–º–µ–Ω –≤–∞–ª—é—Ç"]
                        
                        if niche not in skip_intent_check_niches:
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ–≤ –Ω–∞–º–µ—Ä–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–π –Ω–∏—à–∏
                            intent_keywords_for_patterns = [
                                r'–∏—â[—É–µ—é]', r'–Ω—É–∂–µ–Ω', r'–Ω—É–∂–Ω–∞', r'–Ω—É–∂–Ω—ã', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–ø–æ—Å–æ–≤–µ—Ç—É–π—Ç–µ',
                                r'–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ', r'–≥–¥–µ\s+–Ω–∞–π—Ç–∏', r'–∫—Ç–æ\s+–∑–Ω–∞–µ—Ç', r'–µ—Å—Ç—å\s+–ª–∏',
                                r'–∫—É–ø–ª—é', r'–ø—Ä–æ–¥–∞–º', r'—Å–¥–∞–º', r'—Å–Ω–∏–º—É', r'–∞—Ä–µ–Ω–¥–∞', r'—Ü–µ–Ω–∞', r'—Å—Ç–æ–∏–º–æ—Å—Ç—å',
                                r'–±—é–¥–∂–µ—Ç', r'–ø—Ä–∞–π—Å', r'—É—Å–ª—É–≥[–∏–∞]', r'–∑–∞–∫–∞–∑', r'–æ–±–º–µ–Ω',
                                r'—Å—Ä–æ—á–Ω–æ', r'—Å–µ–≥–æ–¥–Ω—è', r'—Å–µ–π—á–∞—Å'
                            ]
                            
                            has_intent_for_niche = any(re.search(kw, text, re.IGNORECASE) for kw in intent_keywords_for_patterns)
                            
                            if not has_intent_for_niche:
                                logger.info(f"üí∞ –û—Ç—Å–µ—á–∫–∞: '{niche}' –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞–π–¥–µ–Ω, –Ω–æ –Ω–µ—Ç —Å–ª–æ–≤ –Ω–∞–º–µ—Ä–µ–Ω–∏—è - –∏—â—É/—Å–¥–∞–º/—Ü–µ–Ω–∞)")
                                continue
                        # -----------------------------------------------------------------
                        
                        found_niches.add(niche)
                        logger.info(f"‚úÖ [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∏—à–∞ '{niche}' –≤ found_niches. –¢–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫: {found_niches}")
                        break
                except Exception as e:
                    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ '{pattern}' –¥–ª—è –Ω–∏—à–∏ '{niche}': {e}")
        
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤. –ù–∞–π–¥–µ–Ω–æ –Ω–∏—à: {len(found_niches)}")
        if found_niches:
            logger.info(f"‚úÖ [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—à–ª–∏ –Ω–∏—à–∏: {found_niches}")
        else:
            logger.info(f"‚ö†Ô∏è [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 2] –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è: {message_text[:100]}...")

        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ "–æ—Ç–¥—ã—Ö" –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —É—Å–ª—É–≥ - –ù–ï –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ "–¢—É—Ä–∏–∑–º"
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–¥—ã—Ö–∞, –Ω–æ –ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —É—Å–ª—É–≥
        rest_patterns = [r'–æ—Ç–¥–æ—Ö–Ω—É—Ç—å', r'–æ—Ç–¥—ã—Ö', r'–æ—Ç–¥—ã—Ö–∞', r'–æ—Ç–¥—ã—Ö–æ–º', r'–æ—Ç–¥–æ—Ö–Ω[—É–µ]']
        has_rest = any(re.search(pattern, text, re.IGNORECASE) for pattern in rest_patterns)
        tourism_keywords = [r'\b—Ç—É—Ä[—ã—ã]?\b', r'\b—ç–∫—Å–∫—É—Ä—Å–∏[—è–∏]?\b', r'\b–≥–∏–¥[–∞—ã]?\b', r'\b–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏[—è–µ]?\b', r'\b—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫[–∏–π—ã–µ]?\b', 
                           r'\b–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏[—è–µ]?\b', r'\b–æ—Ç–µ–ª—å[—è–∏]?\b', r'\b–≥–æ—Å—Ç–∏–Ω–∏—Ü[–∞—ã]?\b', r'\b–ø–æ–µ–∑–¥–∫[–∞–∏—ã]?\b.*—Ç—É—Ä', r'\b—Ç—É—Ä.*–ø–æ–µ–∑–¥–∫']
        has_tourism = any(re.search(keyword, text, re.IGNORECASE) for keyword in tourism_keywords)
        
        if has_rest and not has_tourism:
            logger.info(f"üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ—Ç–¥—ã—Ö –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —É—Å–ª—É–≥, –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ '–¢—É—Ä–∏–∑–º'")
            # –£–¥–∞–ª—è–µ–º "–¢—É—Ä–∏–∑–º" –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à, –µ—Å–ª–∏ –æ–Ω–∞ —Ç–∞–º –µ—Å—Ç—å
            found_niches.discard("–¢—É—Ä–∏–∑–º")
            logger.info(f"üîç –£–¥–∞–ª–µ–Ω–∞ –Ω–∏—à–∞ '–¢—É—Ä–∏–∑–º' - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±—â–∏–π –æ—Ç–¥—ã—Ö, –∞ –Ω–µ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏")

        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–∏—à (–±–æ–ª—å—à–µ 2) - —ç—Ç–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ, –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
        # –û—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Ç–∏–ø–∞ "–≥–¥–µ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –º–∞—à–∏–Ω—É"
        if len(found_niches) > 2:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç—ã–º –≤–æ–ø—Ä–æ—Å–æ–º
            simple_question_patterns = [
                r'(–≥–¥–µ|–∫–∞–∫|–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ|—Å–∫–∞–∂–∏—Ç–µ).{0,50}(–º–æ–∂–Ω–æ|–º–æ–∂–Ω–æ\s+–ª–∏|–º–æ–∂–Ω–æ\s+–≥–¥–µ).{0,50}(–∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å|–∞—Ä–µ–Ω–¥|–ø—Ä–æ–∫–∞—Ç|–∫—É–ø–∏—Ç—å|–Ω–∞–π—Ç–∏)',
                r'(–≥–¥–µ|–∫–∞–∫|–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ|—Å–∫–∞–∂–∏—Ç–µ).{0,50}(–∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å|–∞—Ä–µ–Ω–¥|–ø—Ä–æ–∫–∞—Ç|–∫—É–ø–∏—Ç—å|–Ω–∞–π—Ç–∏).{0,50}(–º–∞—à–∏–Ω|–∞–≤—Ç–æ|–±–∞–π–∫|–∫–≤–∞—Ä—Ç–∏—Ä|–¥–æ–º)',
            ]
            is_simple_question = any(re.search(pattern, text, re.IGNORECASE) for pattern in simple_question_patterns)
            
            if is_simple_question:
                # –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–∞–º—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –Ω–∏—à—É, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–¥–∞–ª—è–µ–º
                priority_order = ["–ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ", "–ê—Ä–µ–Ω–¥–∞ –±–∞–π–∫–æ–≤", "–°–¥–∞—á–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–ú–µ–¥–∏–∞-—Å—Ç—É–¥–∏—è", "–ê—Ä–µ–Ω–¥–∞ Playstation"]
                for priority_niche in priority_order:
                    if priority_niche in found_niches:
                        found_niches = {priority_niche}  # –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç—É –Ω–∏—à—É
                        logger.info(f"üîç –ü—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å - –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∏—à–∞ '{priority_niche}', –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã")
                        break
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ –æ–±—â–µ–Ω–∏–µ (–¥–µ–ø–æ–∑–∏—Ç, —Ç–µ—Ö–Ω–∏–∫–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞) - –Ω–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∫–∞–∫ –Ω–∏—à—É
        simple_communication_patterns = [
            r'–¥–µ–ø–æ–∑–∏—Ç', r'–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç', r'–æ–ø–ª–∞—á–∏–≤–∞–µ—Ç–µ\s+—Å—Ä–∞–∑—É', r'—Å—á–µ—Ç–∞\s+–∑–∞\s+—Ä–µ—Å—Ç',
            r'–ø—Ä–æ–≤–µ—Ä—è—é\s+–Ω–∞\s+—Ä–∞–±–æ—á–µ–µ\s+—Å–æ—Å—Ç–æ—è–Ω–∏–µ', r'—Ç–µ—Ö–Ω–∏–∫—É', r'–≤–∏–¥–µ–æ\s+–æ–±–∑–æ—Ä',
            r'—Å–ª–æ–º–∞–Ω\s+—Ç–æ—Ä—à–µ—Ä', r'–Ω–∞\s+–≤–∏–¥–µ–æ\s+–ø—Ä–∏\s+–∑–∞—Å–µ–ª–µ–Ω–∏–∏',
        ]
        is_simple_communication = any(re.search(pattern, text, re.IGNORECASE) for pattern in simple_communication_patterns)
        
        if is_simple_communication:
            # –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–∏—à–∏, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—â–µ–Ω–∏–µ
            found_niches = set()
            logger.info(f"üîç –ü—Ä–æ—Å—Ç–æ–µ –æ–±—â–µ–Ω–∏–µ (–¥–µ–ø–æ–∑–∏—Ç/—Ç–µ—Ö–Ω–∏–∫–∞) - —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ –Ω–∏—à–∏")

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à
        message_type = "–û–ë–©–ï–ù–ò–ï"
        if found_niches:
            # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞
            search_keywords = ["–∏—â—É", "–Ω—É–∂–µ–Ω", "–∏—â–µ–º", "—Ç—Ä–µ–±—É–µ—Ç—Å—è", "–Ω–∞–π–¥—É", "–Ω–∞–π—Ç–∏"]
            offer_keywords = ["—Å–Ω–∏–º–∞—é", "–¥–µ–ª–∞—é", "–ø—Ä–µ–¥–ª–∞–≥–∞—é", "—Ä–∞–±–æ—Ç–∞—é", "–æ–∫–∞–∑—ã–≤–∞—é", "–≤—ã–ø–æ–ª–Ω—è—é"]
            
            if any(keyword in text for keyword in search_keywords):
                message_type = "–ü–û–ò–°–ö"
            elif any(keyword in text for keyword in offer_keywords):
                message_type = "–ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï"

        # 3. –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê AI - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ù–ï –Ω–∞—à–ª–∏ –Ω–∏—à–∏
        # –õ–û–ì–ò–ö–ê: 
        # - –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—à–ª–∏ –Ω–∏—à–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–ù–ï –≤—ã–∑—ã–≤–∞–µ–º AI)
        # - –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ù–ï –Ω–∞—à–ª–∏ –Ω–∏—à–∏ ‚Üí –≤—ã–∑—ã–≤–∞–µ–º AI –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∏—à
        logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞: {self.ai_classifier is not None}")
        
        # –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç, AI –ù–ï –≤—ã–∑—ã–≤–∞–µ–º
        if found_niches:
            logger.info(f"‚úÖ [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—à–ª–∏ –Ω–∏—à–∏: {found_niches}, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (AI –Ω–µ –≤—ã–∑—ã–≤–∞–µ–º)")
            return {
                "message_type": message_type,
                "is_spam": False,
                "niches": list(found_niches),
                "context": f"–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º: {', '.join(found_niches)}",
                "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                "budget": "",
                "confidence": 70,
                "reason": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –∏–∑ patterns.py"
            }
        
        # –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ù–ï –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –≤—ã–∑—ã–≤–∞–µ–º AI
        logger.info(f"‚ö†Ô∏è [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏, –≤—ã–∑—ã–≤–∞–µ–º AI –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")
        if self.ai_classifier:
            try:
                # üßπ –§–ò–õ–¨–¢–† "–ú–£–°–û–†–ê" - –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –ø–ª–∞—Ç–Ω—ã–π API –∫–æ—Ä–æ—Ç–∫–∏–µ/–¥–ª–∏–Ω–Ω—ã–µ/–Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ä–æ—á–µ 15 —Å–∏–º–≤–æ–ª–æ–≤ –∏–ª–∏ –¥–ª–∏–Ω–Ω–µ–µ 4000 (—Å–ø–∞–º-–ø–æ—Ä—Ç—è–Ω–∫–∏) - —Å–∫–∏–ø–∞–µ–º AI
                if len(message_text) < 15 or len(message_text) > 4000:
                    logger.info(f"üí∞ [–≠–ö–û–ù–û–ú–ò–Ø] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º AI - –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 15-4000: {len(message_text)} —Å–∏–º–≤–æ–ª–æ–≤")
                    return {
                        "message_type": "–û–ë–©–ï–ù–ò–ï",
                        "is_spam": False,
                        "niches": [],
                        "context": "–î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–Ω–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞",
                        "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                        "budget": "",
                        "confidence": 0,
                        "reason": "Length filter"
                    }
                
                # –ï—Å–ª–∏ –Ω–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—ã (–¥–ª—è –†–§ —Ä—ã–Ω–∫–∞) - —Å–∫–∏–ø–∞–µ–º AI
                if not re.search(r'[–∞-—è–ê-–Ø]', message_text):
                    logger.info(f"üí∞ [–≠–ö–û–ù–û–ú–ò–Ø] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º AI - –Ω–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏")
                    return {
                        "message_type": "–û–ë–©–ï–ù–ò–ï",
                        "is_spam": False,
                        "niches": [],
                        "context": "–ù–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ —Ç–µ–∫—Å—Ç–µ",
                        "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                        "budget": "",
                        "confidence": 0,
                        "reason": "No cyrillic"
                    }
                
                # -----------------------------------------------------------------
                # üí∞ –≠–ö–û–ù–û–ú–ò–Ø –ë–Æ–î–ñ–ï–¢–ê: –§–∏–ª—å—Ç—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º AI
                # -----------------------------------------------------------------
                # –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏, –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ AI —Ç–æ–ª—å–∫–æ —Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è,
                # –≥–¥–µ –µ—Å—Ç—å —è–≤–Ω—ã–π –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –ø–æ–∏—Å–∫.
                # –û–±—ã—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ ("–ø—Ä–∏–≤–µ—Ç", "—Å–ø–∞—Å–∏–±–æ", "–∫–∞–∫ –ø–æ–≥–æ–¥–∞") - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º.
                
                intent_keywords = [
                    # –ü–æ–∏—Å–∫ / –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å
                    r'–∏—â[—É–µ—é]', r'–Ω—É–∂–µ–Ω', r'–Ω—É–∂–Ω–∞', r'–Ω—É–∂–Ω—ã', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–ø–æ—Å–æ–≤–µ—Ç—É–π—Ç–µ', 
                    r'–ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ', r'–≥–¥–µ\s+–Ω–∞–π—Ç–∏', r'–∫—Ç–æ\s+–∑–Ω–∞–µ—Ç', r'–µ—Å—Ç—å\s+–ª–∏',
                    # –ö–æ–º–º–µ—Ä—Ü–∏—è
                    r'–∫—É–ø–ª—é', r'–ø—Ä–æ–¥–∞–º', r'—Å–¥–∞–º', r'—Å–Ω–∏–º—É', r'–∞—Ä–µ–Ω–¥–∞', r'—Ü–µ–Ω–∞', r'—Å—Ç–æ–∏–º–æ—Å—Ç—å', 
                    r'–±—é–¥–∂–µ—Ç', r'–ø—Ä–∞–π—Å', r'—É—Å–ª—É–≥[–∏–∞]', r'–∑–∞–∫–∞–∑', r'–æ–±–º–µ–Ω',
                    # –°—Ä–æ—á–Ω–æ—Å—Ç—å
                    r'—Å—Ä–æ—á–Ω–æ', r'—Å–µ–≥–æ–¥–Ω—è', r'—Å–µ–π—á–∞—Å'
                ]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ö–æ—Ç—å –æ–¥–Ω–æ —Å–ª–æ–≤–æ-–º–∞—Ä–∫–µ—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏—è
                has_intent = any(re.search(kw, message_text.lower()) for kw in intent_keywords)
                
                if not has_intent:
                    logger.info(f"üí∞ [–≠–ö–û–ù–û–ú–ò–Ø] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º AI - –≤ —Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç —è–≤–Ω—ã—Ö —Å–ª–æ–≤ –ø–æ–∏—Å–∫–∞/–ø—Ä–æ–¥–∞–∂–∏ (intent filter)")
                    return {
                        "message_type": "–û–ë–©–ï–ù–ò–ï",
                        "is_spam": False,
                        "niches": [],
                        "context": "–û–±—ã—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ (–Ω–µ—Ç –º–∞—Ä–∫–µ—Ä–æ–≤ –ø–æ–∏—Å–∫–∞)",
                        "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                        "budget": "",
                        "confidence": 0,
                        "reason": "Intent filter skipped AI"
                    }
                # -----------------------------------------------------------------
                
                # ‚úÇÔ∏è –ñ–Å–°–¢–ö–ê–Ø –û–ë–†–ï–ó–ö–ê –¢–ï–ö–°–¢–ê - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ 800 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
                # –≠—Ç–æ–≥–æ —Ö–≤–∞—Ç–∏—Ç –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –Ω–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç 70% —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –ª–æ–Ω–≥—Ä–∏–¥–∞—Ö
                truncated_text = message_text[:800]
                if len(message_text) > 800:
                    logger.info(f"üí∞ [–≠–ö–û–ù–û–ú–ò–Ø] –û–±—Ä–µ–∑–∞–µ–º —Ç–µ–∫—Å—Ç —Å {len(message_text)} –¥–æ 800 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤")
                
                logger.info(f"ü§ñ [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] –í—ã–∑—ã–≤–∞—é AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏)...")
                ai_result = await self.ai_classifier.classify_message(truncated_text)
                logger.info(f"üîç [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] AI –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç: is_spam={ai_result.get('is_spam', False)}, niches={ai_result.get('niches', [])}, confidence={ai_result.get('confidence', 0)}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–µ—Ä–Ω—É–ª –ª–∏ AI —Ñ–ª–∞–≥ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ API)
                if ai_result.get('ai_unavailable', False):
                    logger.warning(f"‚ö†Ô∏è AI –≤–µ—Ä–Ω—É–ª —Ñ–ª–∞–≥ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à")
                    return {
                        "message_type": ai_result.get('message_type', '–û–ë–©–ï–ù–ò–ï'),
                        "is_spam": ai_result.get('is_spam', False),
                        "niches": [],
                        "context": "AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏",
                        "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                        "budget": "",
                        "confidence": 0,
                        "reason": "AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–∏—à–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
                    }
                
                # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ï—Å–ª–∏ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª –∫–∞–∫ —Å–ø–∞–º - –ë–õ–û–ö–ò–†–£–ï–ú
                if ai_result.get('is_spam', False):
                    logger.warning(f"üö´ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –°–ü–ê–ú, –±–ª–æ–∫–∏—Ä—É–µ–º")
                    return ai_result
                
                # –ï—Å–ª–∏ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∏—à–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç AI
                if ai_result.get('niches'):
                    ai_niches = ai_result.get('niches', [])
                    ai_confidence = ai_result.get('confidence', 0)
                    logger.info(f"ü§ñ ‚úÖ AI –Ω–∞—à–µ–ª –Ω–∏—à–∏: {ai_niches}, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å={ai_confidence}%")
                    return ai_result
                
                # –ï—Å–ª–∏ AI –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∏—à–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à
                logger.info(f"ü§ñ AI –Ω–µ –Ω–∞—à–µ–ª –Ω–∏—à–∏ (–ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–æ–∂–µ –Ω–µ –Ω–∞—à–ª–∏)")
                return {
                    "message_type": ai_result.get('message_type', message_type),
                    "is_spam": ai_result.get('is_spam', False),
                    "niches": [],
                    "context": "–û–±—ã—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ (AI –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏)",
                    "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                    "budget": "",
                    "confidence": 0,
                    "reason": "AI –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏"
                }
                
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: {e}, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à")
                # –ü—Ä–∏ –æ—à–∏–±–∫–µ AI –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à (–ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–∂–µ –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏)
                return {
                    "message_type": "–û–ë–©–ï–ù–ò–ï",
                    "is_spam": False,
                    "niches": [],
                    "context": "–û—à–∏–±–∫–∞ AI, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏",
                    "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
                    "budget": "",
                    "confidence": 0,
                    "reason": f"–û—à–∏–±–∫–∞ AI: {str(e)[:100]}"
                }
        else:
            # AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à
            logger.info(f"‚ö†Ô∏è [–ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø-–®–ê–ì 3] AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –Ω–∏—à")
            return {
            "message_type": message_type,
            "is_spam": False,
            "niches": [],
                "context": "–û–±—ã—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ (AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏)",
            "urgency": "–Ω–µ —Å—Ä–æ—á–Ω–æ",
            "budget": "",
            "confidence": 0,
                "reason": "AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏—à–∏"
        }

    def _load_topics(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–º—ã –∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ content.py"""
        for topic, data in MONITORING_TOPICS.items():
            self.topic_keywords[topic] = set(data["keywords"])

    async def update_user_data(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–∞–∑—ã"""
        users = await self.db.get_all_users()
        for user_data in users:
            user_id = user_data['user_id']
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –Ω–∏—à (categories)
            categories = json.loads(user_data.get('categories', '[]'))
            if user_id not in self.user_topics:
                self.user_topics[user_id] = set()
            for cat in categories:
                self.user_topics[user_id].add(cat.lower())
            # –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            settings = json.loads(user_data.get('settings', '{}'))
            self.user_settings[user_id] = settings or {
                "notification_frequency": "instant",
                "is_paused": False,
                "custom_keywords": set()
            }
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
            if user_id not in self.message_queue:
                self.message_queue[user_id] = []

    async def process_message(self, message_text: str, chat_title: str = None, message_link: str = None):
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∏—à–∏) –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–º, –∫—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∏—à–∏
        """
        if not message_text:
            return

        logger.info(f"üîç –ê–Ω–∞–ª–∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞: {chat_title}")
        text = message_text.lower()
        found_niches = set()

        # –ü–æ–∏—Å–∫ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
        for niche, data in self.patterns.items():
            for pattern in data["keywords"]:
                if re.search(pattern, text):
                    found_niches.add(niche)
                    logger.info(f"‚úÖ –ù–∞–π–¥–µ–Ω–∞ –Ω–∏—à–∞: {niche}")
                    break

        if not found_niches:
            logger.info("‚ùå –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–∑–æ—Å–ª–∞–Ω–æ")
            return

        logger.info(f"üìä –ù–∞–π–¥–µ–Ω–æ –Ω–∏—à: {found_niches}")
        
        # –†–∞—Å—Å—ã–ª–∫–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–º, –∫—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∏—à–∏
        for user_id, user_niches in self.subscribers.items():
            if found_niches & user_niches:
                try:
                    user = await self.db.get_user(user_id)
                    if not user:
                        logger.warning(f"‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ")
                        continue

                    notification = (
                        f"üîî –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö: {', '.join(found_niches)}\n\n"
                        f"üìù {message_text}\n\n"
                        f"üí¨ –ß–∞—Ç: {chat_title or '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —á–∞—Ç'}\n"
                    )
                    if message_link:
                        notification += f"üîó –°—Å—ã–ª–∫–∞: {message_link}"

                    await self.bot.send_message(user_id, notification)
                    logger.info(f"‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}")
                except Exception as e:
                    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}: {e}")

    async def schedule_daily_digest(self, user_id: int):
        """–ü–ª–∞–Ω–∏—Ä—É–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç"""
        while True:
            # –ñ–¥–µ–º –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è
            now = datetime.now()
            next_day = now.replace(hour=20, minute=0, second=0, microsecond=0)
            if next_day <= now:
                next_day += timedelta(days=1)
            
            wait_seconds = (next_day - now).total_seconds()
            await asyncio.sleep(wait_seconds)
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–π–¥–∂–µ—Å—Ç
            if user_id in self.message_queue and self.message_queue[user_id]:
                messages = self.message_queue[user_id]
                self.message_queue[user_id] = []
                
                digest = (
                    "üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç:\n\n"
                    f"–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –Ω–∞–π–¥–µ–Ω–æ {len(messages)} —Å–æ–æ–±—â–µ–Ω–∏–π:\n\n"
                )
                
                # –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
                for msg in messages[:5]:
                    digest += f"‚Ä¢ {msg}\n\n"
                
                if len(messages) > 5:
                    digest += f"... –∏ –µ—â–µ {len(messages) - 5} —Å–æ–æ–±—â–µ–Ω–∏–π"
                
                await self.bot.send_message(user_id, digest)

    async def schedule_weekly_digest(self, user_id: int):
        """–ü–ª–∞–Ω–∏—Ä—É–µ—Ç –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç"""
        while True:
            # –ñ–¥–µ–º –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞
            now = datetime.now()
            next_monday = now.replace(hour=20, minute=0, second=0, microsecond=0)
            while next_monday.weekday() != 0:  # 0 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
                next_monday += timedelta(days=1)
            
            if next_monday <= now:
                next_monday += timedelta(days=7)
            
            wait_seconds = (next_monday - now).total_seconds()
            await asyncio.sleep(wait_seconds)
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–π–¥–∂–µ—Å—Ç
            if user_id in self.message_queue and self.message_queue[user_id]:
                messages = self.message_queue[user_id]
                self.message_queue[user_id] = []
                
                digest = (
                    "üìä –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç:\n\n"
                    f"–ó–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é –Ω–∞–π–¥–µ–Ω–æ {len(messages)} —Å–æ–æ–±—â–µ–Ω–∏–π:\n\n"
                )
                
                # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ç–µ–º–∞–º
                topics = {}
                for msg in messages:
                    for topic in self.user_topics[user_id]:
                        if topic in msg.lower():
                            if topic not in topics:
                                topics[topic] = []
                            topics[topic].append(msg)
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç–µ–º–∞–º
                for topic, msgs in topics.items():
                    digest += f"üìå {topic.capitalize()}: {len(msgs)} —Å–æ–æ–±—â–µ–Ω–∏–π\n"
                
                digest += "\nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /settings –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
                
                await self.bot.send_message(user_id, digest)

    def _strict_spam_check_when_ai_fails(self, message_text: str) -> bool:
        """
        –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º, –∫–æ–≥–¥–∞ AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–ø–∞–º
        """
        if not message_text:
            return True
        
        import re
        text_clean = re.sub(r'\*+', '', message_text)
        text_clean = re.sub(r'_+', '', text_clean)
        text_clean = re.sub(r'`+', '', text_clean)
        text_lower = text_clean.lower()
        
        # –°–¢–†–û–ì–ò–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–ø–∞–º–∞, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∞–∂–µ –±–µ–∑ AI
        strict_spam_indicators = [
            # –û–±–º–µ–Ω –≤–∞–ª—é—Ç (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–Ω–∏–∫–æ–≤)
            (r'(prestige|cashfriends|–æ–±–º–µ–Ω–Ω–∏–∫).*(–ø–æ–º–æ–∂–µ—Ç|–ø–æ–º–æ–≥—É|–≥–æ—Ç–æ–≤—ã.*–ø–æ–º–æ—á—å)', r'(–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ|–±–µ–∑–æ–ø–∞—Å–Ω–æ|–±—ã—Å—Ç—Ä–æ|–Ω–∞–¥—ë–∂–Ω–æ)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–Ω–∞–º)'),
            (r'–ø–æ–º–æ–∂–µ—Ç\s+—Å\s+–æ–±–º–µ–Ω–æ–º', r'(–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ|–±–µ–∑–æ–ø–∞—Å–Ω–æ)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–Ω–∞–º)'),
            
            # –î–∏–∑–∞–π–Ω–µ—Ä—ã/–º–µ–Ω–µ–¥–∂–µ—Ä—ã —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ—Ä–∞–∑–∞–º–∏
            (r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä|–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫).*(–∫–∞—Ä—Ç–æ—á–µ–∫|–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫|–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç|–ª–∫)', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞|–æ–±—É—á—É|–Ω–∞—É—á—É)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç)'),
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä).*(–∫–∞—Ä—Ç–æ—á–µ–∫|–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫|–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç)', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å).*(–ª—Å|–ª–∏—á–Ω—ã–µ)'),
            
            # –†–∞–±–æ—Ç–∞/–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞
            (r'(–Ω—É–∂–Ω—ã|–∏—â–µ–º).*(–ø–æ–º–æ—â–Ω–∏–∫|–ª—é–¥–∏|–ø–µ—Ä—Å–æ–Ω–∞–ª).*(–ø—Ä–æ—Å—Ç—ã–µ.*—Ä–∞–±–æ—Ç—ã|—É–±–æ—Ä–∫)', r'(—Ä–∞—Å—á—ë—Ç|–æ–ø–ª–∞—Ç–∞).*(—Å—Ä–∞–∑—É|–Ω–∞\s+—Ä—É–∫–∏)', r'(–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å|–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ)'),
            (r'(–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å|–∑–∞—Ä–∞–±–æ—Ç–æ–∫).*(—É–¥–∞–ª–µ–Ω–Ω|—É–¥–∞–ª—ë–Ω–Ω)', r'(ByBit|Binance)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª—Å)'),
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞/–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
            (r'–Ω–µ\s+–ø—Ä–æ—à–ª–∏\s+(–ø—Ä–æ–≤–µ—Ä–∫—É|–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É|–±–æ—Ç—É\s+–≤\s+–ª—Å)', r'(–¥–ª—è\s+–ø–æ–ª—É—á–µ–Ω–∏—è\s+–¥–æ—Å—Ç—É–ø–∞|—Ä–µ—à–∏—Ç–µ\s+–∫–∞–ø—á—É)'),
        ]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        for pattern_combo in strict_spam_indicators:
            matches = sum(1 for pattern in pattern_combo if re.search(pattern, text_lower, re.IGNORECASE))
            if matches >= 2:  # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ 2+ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∏–∑ 3
                logger.warning(f"üö´ –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω): –Ω–∞–π–¥–µ–Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤")
                return True
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —Å–ø–∞–º–∞ –∏–∑ SPAM_FILTERS
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ patterns.py, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è –∏—Ö –≤ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        spam_keywords_from_filters = SPAM_FILTERS.get("spam_keywords", [])
        critical_spam_keywords = [
            '–±–∞–∑—ã.*–ø–∞—Å–ø–æ—Ä—Ç–Ω', '–æ–ø—Ç–æ–≤–∞—è.*–ø—Ä–æ–¥–∞–∂–∞.*—Ä–∞–±–æ—Ç', '–≤—ã–±–æ—Ä–∫–∏.*–æ–ø–µ—Ä–∞—Ç–æ—Ä', '–≤—ã–±–æ—Ä–∫–∏.*–±–∞–Ω–∫',
            '–¥–ª—è\s+–ø–æ–∫—É–ø–∫–∏.*–ø—Ä–æ–≤–µ—Ä–∫–∏.*–ø–∏—à–∏—Ç–µ', '–∫–æ–º—É\s+–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', '–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç',
            'prestige.*–ø–æ–º–æ–∂–µ—Ç.*–æ–±–º–µ–Ω–æ–º', 'cashfriends.*–≥–æ—Ç–æ–≤—ã.*–æ–±–º–µ–Ω–æ–º',
            '–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫.*–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω', '–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç.*–æ–±—Ä–∞—â–∞—Ç—å—Å—è',
            '–Ω—É–∂–Ω—ã\s+–ø–æ–º–æ—â–Ω–∏–∫–∏.*–ø—Ä–æ—Å—Ç—ã–µ.*—Ä–∞–±–æ—Ç—ã', '–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å.*ByBit', '–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å.*Binance',
        ]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ SPAM_FILTERS (–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
        for keyword in spam_keywords_from_filters:
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ã—á–Ω—ã–µ —Å–ª–æ–≤–∞ –≤ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (—ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
            keyword_pattern = re.escape(keyword.lower())
            critical_spam_keywords.append(keyword_pattern)
        
        for keyword_pattern in critical_spam_keywords:
            if re.search(keyword_pattern, text_lower, re.IGNORECASE):
                logger.warning(f"üö´ –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω): –Ω–∞–π–¥–µ–Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ '{keyword_pattern}'")
                return True
        
        return False

    def is_critical_spam_only(self, message_text: str) -> bool:
        """
        –û–°–õ–ê–ë–õ–ï–ù–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Ä–∫–æ—Ç–∏–∫–∏, —è–≤–Ω—ã–π –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º)
        –û—Å—Ç–∞–ª—å–Ω–æ–µ (–¥–∏–∑–∞–π–Ω–µ—Ä—ã, –º–µ–Ω–µ–¥–∂–µ—Ä—ã, —Ä–∞–±–æ—Ç–∞ –∏ —Ç.–¥.) –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å AI –Ω–∞ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö
        """
        if not message_text:
            return True

        # –£–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        import re
        text_clean = re.sub(r'\*+', '', message_text)
        text_clean = re.sub(r'_+', '', text_clean)
        text_clean = re.sub(r'`+', '', text_clean)
        text_clean = re.sub(r'~+', '', text_clean)
        text_clean = re.sub(r'[üÜòüö®‚ö†Ô∏èüîîüí¨üìùüë§üí¨üîóüìÇüîçüíº‚úÖ‚ùåüö´]+', '', text_clean)
        text_lower = text_clean.lower()
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 1: –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        databases_spam_patterns = [
            r'–±–∞–∑[–∞—ã].*–ø–∞—Å–ø–æ—Ä—Ç–Ω', r'–ø–∞—Å–ø–æ—Ä—Ç–Ω.*–¥–∞–Ω–Ω', r'–æ–ø—Ç–æ–≤–∞—è.*–ø—Ä–æ–¥–∞–∂–∞.*—Ä–∞–±–æ—Ç',
            r'—Å\s+–∏–Ω–Ω', r'–≤—ã–±–æ—Ä–∫–∏.*–æ–ø–µ—Ä–∞—Ç–æ—Ä', r'–≤—ã–±–æ—Ä–∫–∏.*–±–∞–Ω–∫',
            r'–¥–ª—è\s+–ø–æ–∫—É–ø–∫–∏.*–ø—Ä–æ–≤–µ—Ä–∫–∏.*–ø–∏—à–∏—Ç–µ', r'–¥–ª—è\s+–ø–æ–∫—É–ø–∫–∏.*–ø–∏—à–∏—Ç–µ.*–ª–∏—á–∫—É',
            r'–¥–ª—è\s+–ø—Ä–æ–≤–µ—Ä–∫–∏.*–ø–∏—à–∏—Ç–µ.*–ª–∏—á–∫—É', r'–±—ã—Å—Ç—Ä–æ–µ\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.*–∑–∞–∫–∞–∑',
            r'—Ä–∞–∑—É–º–Ω—ã–µ\s+—Ü–µ–Ω—ã', r'–¥–ª—è\s+–ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö\s+–∫–ª–∏–µ–Ω—Ç', r'–ø—Ä–æ–¥–∞–º.*–±–∞–∑[–∞—ã]',
            r'–ø—Ä–æ–¥–∞–∂–∞.*–±–∞–∑[–∞—ã]', r'–±–∞–∑–∞.*–¥–∞–Ω–Ω.*—Ä—Ñ', r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω[–∞—ã]?\s+(—Ä—Ñ|—Ä–±|–∫–∑)',
            r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω[–∞—ã]?\s+(—Ä–æ—Å—Å–∏|–±–µ–ª–∞—Ä—É—Å|–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω)', r'–ø—Ä–µ–¥–ª–∞–≥[–∞—é–µ–º].*–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω',
            r'—Ñ–∏–∑[—ã—ã]', r'–≤—ã–≥—Ä—É–∑–∫[–∞–∏].*–±–∞–∑', r'–≤—ã–≥—Ä—É–∑–∫[–∞–∏].*–∫–æ–ª–ª', r'—Ç–µ—Å—Ç[—ã—ã].*–±–∞–∑',
            r'–∑–∞–º–µ–Ω[–∞—É].*–±–∞–∑', r'–ø–æ–ª–Ω–æ–µ\s+–Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\s+–±–∞–∑', r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*–∏–Ω—Ç–µ—Ä–Ω–µ—Ç.*–º–∞–≥–∞–∑–∏–Ω',
            r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*—Ç–µ–ª–µ.*–º–∞–≥–∞–∑–∏–Ω', r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*–±–∞–Ω–∫', r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*–≤—ã–±–æ—Ä–∫',
            r'–≤—ã–±–æ—Ä–∫[–∞–∏].*–ø–æ\s+(–≤–æ–∑—Ä–∞—Å—Ç—É|—Ä–µ–≥–∏–æ–Ω—É|–ø–æ–ª—É)', r'–≤\s+–Ω–∞–ª–∏—á–∏–∏.*–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω',
            r'–æ–≥—Ä–æ–º–Ω[–æ–µ]?\s+–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.*—Å—Ç—Ä–æ–∫', r'—é–∑–∞–Ω–Ω[—ã–π–æ–≥–æ]?\s+–º–∞—Ç–µ—Ä–∏–∞–ª',
            r'–ø–æ\s+–≤—Å–µ–º\s+–≤–æ–ø—Ä–æ—Å–∞–º\s+–≤\s+–ª–∏—á–∫—É', r'(–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω|–±–∞–∑[–∞—ã]).*(—Ä—Ñ|—Ä–±|–∫–∑).*(–≤\s+–Ω–∞–ª–∏—á–∏–∏|–ø—Ä–µ–¥–ª–∞–≥|–ø—Ä–æ–¥–∞–º)',
            r'–∏–Ω—Ç–µ—Ä–Ω–µ—Ç\s+–º–∞–≥–∞–∑–∏–Ω.*–±—ã—Ç–æ–≤.*—Ç–µ—Ö–Ω–∏–∫', r'–∏–Ω—Ç–µ—Ä–Ω–µ—Ç\s+–º–∞–≥–∞–∑–∏–Ω.*–º–µ–¥–∏—Ü–∏–Ω—Å–∫.*–æ–±–æ—Ä—É–¥',
            r'—Ç–µ–ª–µ.*–º–∞–≥–∞–∑–∏–Ω', r'–≤—ã–≥—Ä—É–∑–∫[–∞–∏].*–∫–æ–ª–ª.*—Ü–µ–Ω—Ç—Ä.*–±–µ–ª', r'–¥–∞–µ–º\s+—Ç–µ—Å—Ç', r'–¥–µ–ª–∞–µ–º\s+–∑–∞–º–µ–Ω',
        ]
        for pattern in databases_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 2: –ù–∞—Ä–∫–æ—Ç–∏–∫–∏ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        drugs_spam_patterns = [
            r'–Ω–∞—Ä–∫–æ—Ç–∏–∫', r'–≤–µ—â–µ—Å—Ç–≤–æ', r'—Ç—Ä–∞–≤–∞', r'–º–∞—Ä–∏—Ö—É–∞–Ω–∞', r'–∫–æ–∫–∞–∏–Ω', r'–≥–µ—Ä–æ–∏–Ω',
            r'–∞–º—Ñ–µ—Ç–∞–º–∏–Ω', r'—ç–∫—Å—Ç–∞–∑–∏', r'–ª—Å–¥', r'–º–µ—Ñ–µ–¥—Ä–æ–Ω', r'—Å–æ–ª—å', r'—Å–ø–∞–π—Å', r'–º–∏–∫—Å',
            r'–≥–∞—à–∏—à', r'–∞–Ω–∞—à–∞', r'–ø–ª–∞–Ω', r'–¥—Ä–æ–≤–∞', r'–¥—É—Ä—å', r'–¥—É—Ä–º–∞–Ω', r'—à–∏—à–∫–∏',
            r'—Å–æ—Ä—Ç', r'–≥–∏–¥—Ä–æ–ø–æ–Ω–∏–∫–∞', r'—Å–∫—É–Ω—Å', r'–¥–∂–∞', r'—Ç—Ä–∞–≤–∫–∞', r'–∑–µ–ª–µ–Ω—å',
            r'–ø–æ–Ω–∏–∫–∞', r'–≤–¥–æ–≤–∞.*–≥–æ–ª–æ–≤—ã', r'–±–æ–ª–∏–≤–∏—è.*–ø–µ—Ä–≤—ã–π', r'–≥–∞—Ä–∞–Ω—Ç–∏—è.*—Å—å–µ–º–∞',
            r'–Ω–µ–¥–æ—Ä–æ–≥–æ.*–¥–æ—Å—Ç–∞–≤–∫–∞.*–Ω–∞—Ä–∫–æ—Ç–∏–∫', r'–¥–æ—Å—Ç–∞–≤–∫–∞.*–Ω–∞—Ä–∫–æ—Ç–∏–∫', r'–ø—Ä–æ–¥–∞–º.*–≤–µ—â–µ—Å—Ç–≤–æ',
        ]
        for pattern in drugs_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 3: –ó–≤–µ–∑–¥—ã –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        stars_spam_patterns = [
            r'–∫–æ–º—É\s+–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç',
            r'–∑–∞\s+\d+\s+–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞', r'–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞',
            r'–∑–≤–µ–∑–¥—ã\s+–ø–∏—à–∏—Ç–µ', r'–∑–≤–µ–∑–¥—ã\s+–≤\s+–ª—Å', r'–ø–∏—à–∏—Ç–µ\s+–º–Ω–µ\s+–≤\s+–ª—Å.*–∑–≤–µ–∑–¥—ã',
        ]
        for pattern in stars_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∑–≤–µ–∑–¥—ã): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 4: –ü—Ä–æ–≤–µ—Ä–∫–∞/–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        verification_spam_patterns = [
            r'–Ω–µ\s+–ø—Ä–æ—à–ª–∏\s+–ø—Ä–æ–≤–µ—Ä–∫—É', r'–Ω–µ\s+–ø—Ä–æ—à—ë–ª\s+–ø—Ä–æ–≤–µ—Ä–∫—É', r'–Ω–µ\s+–ø—Ä–æ—à–ª–∞\s+–ø—Ä–æ–≤–µ—Ä–∫—É',
            r'–Ω–µ\s+–ø—Ä–æ—à–ª–∏\s+–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É\s+–≤\s+–ª—Å', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É.*/start',
            r'–¥–ª—è\s+–ø–æ–ª—É—á–µ–Ω–∏—è\s+–¥–æ—Å—Ç—É–ø–∞', r'—Ä–µ—à–∏—Ç–µ\s+—ç—Ç—É\s+–∫–∞–ø—á—É', r'—Ä–µ—à–∏—Ç–µ\s+–∫–∞–ø—á—É',
        ]
        for pattern in verification_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 5: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞, –±–∞–Ω–∫–∏, –≥–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ø—Ä–æ–±–∏–≤ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        business_registration_spam_patterns = [
            r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏[—è–∏].*–±–∏–∑–Ω–µ—Å', r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏[—è–∏].*–æ–æ–æ', r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏[—è–∏].*–∏–ø',
            r'–æ—Ç–∫—Ä—ã—Ç–∏[–µ—è].*—Å—á–µ—Ç', r'—Ä–∞—Å—á—ë—Ç–Ω[—ã–π—ã–µ].*—Å—á–µ—Ç', r'–ø–æ–¥–±–æ—Ä.*–∫–æ–º–ø–∞–Ω–∏[–∏–π—è].*–ª–∏–∑–∏–Ω–≥',
            r'–ø–æ–¥–∫–ª—é—á–µ–Ω–∏[–µ—è].*—Å–±–∏—Å', r'–ø–æ–¥–∫–ª—é—á–µ–Ω–∏[–µ—è].*–∫–æ–Ω—Ç—É—Ä', r'–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏[–µ—è].*–¥–æ–∫—É–º–µ–Ω—Ç',
            r'—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω[–∞—è—ã–µ].*–ø–æ–¥–ø–∏—Å[—å–∏]', r'—ç—Ü–ø', r'–Ω–∞–π–¥–µ–º.*–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏[—é–∏]', r'–ø—Ä–æ–±—å–µ–º', r'–æ—Ç–∫–æ–ø–∞–µ–º',
            r'–≥–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä[—ã—ã]', r'–µ–º–∏–∞—Å', r'—Å–æ—Ç–æ–≤[—ã–π—ã–µ].*–æ–ø–µ—Ä–∞—Ç–æ—Ä[—ã—ã]', r'–±–∞–Ω–∫[–∏—ã]',
            r'–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏[—è–∏].*–Ω–∞–ª–æ–≥–æ–≤[–æ–π–æ–π].*–Ω–∞–≥—Ä—É–∑–∫[–∏—ã]', r'–Ω–∞–ª–æ–≥–æ–≤[–∞—è—ã–µ].*–Ω–∞–≥—Ä—É–∑–∫[–∏—ã]',
            r'—É—á—Ä–µ–¥–∏—Ç–µ–ª—å–Ω[—ã–π—ã–µ].*–¥–æ–∫—É–º–µ–Ω—Ç[—ã—ã]', r'–æ–æ–æ.*–∏–ø.*–∞–Ω–æ', r'—Ñ–æ–Ω–¥[—ã—ã].*–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏[–∏–π—è]',
            r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–ª–∏–Ω–∏–∏', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–±–∞–∑–µ', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*—Ñ–Ω—Å', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–º–≤–¥',
            r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–≥–∏–±–¥–¥', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–∑–∞–≥—Å', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–ø—Ñ—Ä', r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–Ω–∞–ª–æ–≥–æ–≤–æ–π',
            r'–ø—Ä–æ–±–∏–≤.*–ø–æ.*–ø–æ–ª–∏—Ü–∏–∏', r'–ø—Ä–æ–±–∏–≤',
        ]
        for pattern in business_registration_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞/–±–∞–Ω–∫–∏/–ø—Ä–æ–±–∏–≤): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 6: –†–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞ "–ù—É–∂–Ω—ã –±–∞–±–∫–∏", –¥–æ—Å—Ç–∞–≤–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        job_spam_patterns = [
            r'–Ω—É–∂–Ω—ã\s+–±–∞–±–∫–∏', r'–Ω—É–∂–Ω—ã\s+–±–∞–±–∫–∏\s+—Å—Ä–æ—á–Ω–æ',
            r'–¥–æ—Å—Ç–∞–≤–∫–∞\s+–∑–∞–∫–∞–∑–æ–≤', r'–¥–æ—Å—Ç–∞–≤–∫–∞\s+–∑–∞–∫–∞–∑–æ–≤.*–ø–µ—à–∫–æ–º', r'–¥–æ—Å—Ç–∞–≤–∫–∞\s+–∑–∞–∫–∞–∑–æ–≤.*—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
            r'–æ—Ç\s+\d+\s+000\s+–≤\s+–¥–µ–Ω—å', r'–æ—Ç\s+\d+\s+—Ç—ã—Å\s+–≤\s+–¥–µ–Ω—å', r'\d+\s+000\s+–≤\s+–¥–µ–Ω—å',
            r'–æ–ø—ã—Ç\s+–Ω–µ\s+–Ω—É–∂–µ–Ω', r'–æ–ø—ã—Ç\s+–Ω–µ\s+—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–±–µ–∑\s+–æ–ø—ã—Ç–∞',
            r'—Å–≤—è–∑—å\s+@', r'—Å–≤—è–∑—å.*@\w+', r'–ø–∏—à–∏—Ç–µ.*@\w+', r'–Ω–∞–ø–∏—à–∏—Ç–µ.*@\w+',
            r'–ø–µ—à–∫–æ–º\s*/\s*—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', r'–ø–µ—à–∫–æ–º.*—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        ]
        for pattern in job_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞/–¥–æ—Å—Ç–∞–≤–∫–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 7: –î–∏–∑–∞–π–Ω–µ—Ä—ã, –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£ - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ —Å–ø–∞–º)
        designer_spam_patterns = [
            r'–∏—â[–∞—É–µ].*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–∏—â–µ–º.*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–∏—â–∞.*–¥–∏–∑–∞–π–Ω–µ—Ä',  # –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è "–ò—â–∞ –¥–∏–∑–∞–π–Ω–µ—Ä–∞"
            r'–Ω—É–∂–µ–Ω.*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–Ω—É–∂–Ω–∞.*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–Ω—É–∂–Ω—ã.*–¥–∏–∑–∞–π–Ω–µ—Ä',
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(—Ä–µ–∑—é–º–µ|–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ)', r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–≤\s+–ª—Å', r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–æ—Ç\s+18',
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–±–µ–∑\s+–æ–ø—ã—Ç–∞|–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω)', r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(—Ç–æ–ª—å–∫–æ|—Å—Ç—Ä–æ–≥–æ).*–æ—Ç\s+18',
            r'–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥.*–≤–æ–∑—Ä–∞—Å—Ç–∞.*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–ø—Ä–æ—à—É\s+–Ω–µ\s+–±–µ—Å–ø–æ–∫–æ–∏—Ç—å',
            r'—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é.*–±–µ–∑\s+–æ–ø—ã—Ç–∞.*–¥–∏–∑–∞–π–Ω–µ—Ä', r'–¥–∏–∑–∞–π–Ω–µ—Ä.*—Ä–µ–∑—é–º–µ.*–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.*–ª—Å',
        ]
        for pattern in designer_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–¥–∏–∑–∞–π–Ω–µ—Ä—ã): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 7: –†–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞ (–ø–æ–º–æ—â–Ω–∏–∫–∏, –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤, —É–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —Å–∫–ª–∞–¥—ã, –°–î–≠–ö, –ø–µ—Ä—Å–æ–Ω–∞–ª) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        work_spam_patterns = [
            r'—Ç—Ä–µ–±—É—é—Ç—Å—è.*–ø–æ–º–æ—â–Ω–∏–∫', r'–Ω—É–∂–Ω—ã.*–ø–æ–º–æ—â–Ω–∏–∫', r'–∏—â–µ–º.*–ø–æ–º–æ—â–Ω–∏–∫',
            r'–ø–æ–º–æ—â–Ω–∏–∫.*–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏', r'–ø–æ–º–æ—â–Ω–∏–∫.*—Ç–≥.*–∫–∞–Ω–∞–ª', r'–ø–æ–º–æ—â–Ω–∏–∫.*telegram.*–∫–∞–Ω–∞–ª',
            r'–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏.*—Ç–≥.*–∫–∞–Ω–∞–ª', r'–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏.*telegram.*–∫–∞–Ω–∞–ª',
            r'—Ä–∞–±–æ—Ç–∞.*—É–¥–∞–ª—ë–Ω–Ω', r'—Ä–∞–±–æ—Ç–∞.*—É–¥–∞–ª–µ–Ω–Ω', r'–ø–æ–¥—Ä–∞–±–æ—Ç–∫.*—É–¥–∞–ª—ë–Ω–Ω', r'–ø–æ–¥—Ä–∞–±–æ—Ç–∫.*—É–¥–∞–ª–µ–Ω–Ω',
            r'–¥–æ—Ö–æ–¥.*\d+\s*‚ÇΩ.*–µ–∂–µ–¥–Ω–µ–≤–Ω–æ', r'–∑–∞—Ä–∞–±–æ—Ç–æ–∫.*\d+\s*‚ÇΩ.*–¥–µ–Ω—å', r'–æ—Ç\s+\d+\s*‚ÇΩ.*–µ–∂–µ–¥–Ω–µ–≤–Ω–æ',
            # –†–∞–±–æ—Ç–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ, –°–î–≠–ö, –ü–í–ó
            r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–∏—â–µ–º.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫', r'–¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ.*—Å–æ—Ç—Ä—É–¥–Ω–∏–∫.*—Å–¥—ç–∫',
            r'—Å–∫–ª–∞–¥.*–ø–≤–∑', r'–ø–≤–∑.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥', r'—Ä–∞–±–æ—Ç–∞.*–ø–≤–∑',
            r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏[–µ—è].*–ø–æ—Ä—è–¥–∫.*—Å–∫–ª–∞–¥', r'—Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å.*–∫–æ—Ä–æ–±–∫', r'–ø—Ä–æ–≤–µ—Ä—è—Ç—å.*–ø–æ–ª–∫',
            r'–∑–∞\s+—Å–º–µ–Ω—É.*\d+\s*‚ÇΩ', r'\d+\s*‚ÇΩ.*–∑–∞\s+—Å–º–µ–Ω—É', r'\d+\s*—Ä—É–±–ª[–µ–π—è].*–∑–∞\s+—Å–º–µ–Ω—É',
            r'—Ä–∞–±–æ—Ç–∞.*—Å–∫–ª–∞–¥.*18\+', r'—Å–∫–ª–∞–¥.*–¥–ª—è\s+18\+', r'–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏[–µ—è].*–ø–æ—Ä—è–¥–∫.*18\+',
            # –ü–µ—Ä—Å–æ–Ω–∞–ª, —Ä–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞, –Ω–µ–ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
            r'–Ω—É–∂–µ–Ω.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'–∏—â—É.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'—Ç—Ä–µ–±—É–µ—Ç—Å—è.*–ø–µ—Ä—Å–æ–Ω–∞–ª', r'–º–Ω–µ.*–Ω—É–∂–µ–Ω.*–ø–µ—Ä—Å–æ–Ω–∞–ª',
            r'–æ–ø—ã—Ç.*—Ä–∞–±–æ—Ç—ã.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–æ–ø—ã—Ç.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è', r'–±–µ–∑.*–æ–ø—ã—Ç–∞.*—Ä–∞–±–æ—Ç—ã',
            r'—Ä–∞–±–æ—Ç–∞—Ç—å.*–∏–∑.*–¥–æ–º', r'—Ä–∞–±–æ—Ç–∞.*–∏–∑.*–¥–æ–º', r'—Ä–∞–±–æ—Ç–∞.*–Ω–∞.*–¥–æ–º',
            r'–Ω–µ–ø–æ–ª–Ω.*—Ä–∞–±–æ—á.*–¥–µ–Ω—å', r'–Ω–µ–ø–æ–ª–Ω—ã–π.*—Ä–∞–±–æ—á–∏–π.*–¥–µ–Ω—å', r'–Ω–µ–ø–æ–ª–Ω.*–¥–µ–Ω—å',
            r'—Å\s+\d+:\d+\s+–¥–æ\s+\d+:\d+', r'—Å\s+\d+\s+–¥–æ\s+\d+', r'–≥—Ä–∞—Ñ–∏–∫.*\d+:\d+.*\d+:\d+',
            r'—Ö–æ—Ä–æ—à.*–∑–∞—Ä–ø–ª–∞—Ç', r'–≤—ã—Å–æ–∫.*–∑–∞—Ä–ø–ª–∞—Ç', r'–∑–∞—Ä–ø–ª–∞—Ç.*—Ö–æ—Ä–æ—à', r'–∑–∞—Ä–ø–ª–∞—Ç.*–≤—ã—Å–æ–∫',
            r'–æ—Ç–ø—Ä–∞–≤—å—Ç–µ.*—Å–æ–æ–±—â–µ–Ω–∏.*tg', r'–æ—Ç–ø—Ä–∞–≤—å—Ç–µ.*—Å–æ–æ–±—â–µ–Ω–∏.*whatsapp', r'—Å–æ–æ–±—â–µ–Ω–∏.*tg.*whatsapp',
            r'–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.*–æ—Ç–ø—Ä–∞–≤—å—Ç–µ', r'–µ—Å–ª–∏.*–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.*–æ—Ç–ø—Ä–∞–≤—å—Ç–µ',
            # –†–∞–±–æ—Ç–∞ –Ω–∞ –∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞—Ö (–ë–∏–Ω–∞–Ω—Å, –ë–∞–π–±–∏—Ç)
            r'—Ä–∞–±–æ—Ç–∞.*–±–∏–Ω–∞–Ω—Å', r'—Ä–∞–±–æ—Ç–∞.*–±–∞–π–±–∏—Ç', r'—Ä–∞–±–æ—Ç–∞.*binance', r'—Ä–∞–±–æ—Ç–∞.*bybit',
            r'–∏—â–µ–º.*–ª—é–¥.*—Ä–∞–±–æ—Ç.*–±–∏–Ω–∞–Ω—Å', r'–∏—â–µ–º.*–ª—é–¥.*—Ä–∞–±–æ—Ç.*–±–∞–π–±–∏—Ç',
            r'—Ä–∞–±–æ—Ç–∞.*–∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂', r'—Ä–∞–±–æ—Ç–∞.*–∫—Ä–∏–ø—Ç–æ.*–±–∏—Ä–∂',
            r'–æ–ø–ª–∞—Ç–∞.*–µ–∂–µ–¥–Ω–µ–≤–Ω–æ', r'–±–µ—Å–ø–ª–∞—Ç–Ω.*–æ–±—É—á–µ–Ω–∏', r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*—Å—É–±–±–æ—Ç',
            r'–ø–∏—à–∏—Ç–µ.*\+.*–ª—Å', r'–ø–∏—à–∏—Ç–µ.*–ø–ª—é—Å.*–ª—Å', r'–¥–ª—è.*–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç.*–ª—Å',
            # –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ (—Å–ø–∞–º)
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–∑–∞–ø–æ–ª–Ω–µ–Ω–∏.*–∫–∞—Ä—Ç–æ—á–µ–∫', r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫', r'–∑–∞–ø–æ–ª–Ω–µ–Ω–∏.*–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'—é–Ω–∏—Ç.*—ç–∫–æ–Ω–æ–º–∏–∫', r'–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω.*—Ä–∞–±–æ—Ç', r'—Ä–∞–±–æ—Ç–∞.*–∫–∞—Ä—Ç–æ—á–∫',
            r'—Å—Ç–æ–∏–º–æ—Å—Ç—å.*–ª—Å', r'—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ.*–æ.*—Å–µ–±–µ.*–ª—Å', r'—á—Ç–æ.*–º–æ–∂–µ—Ç–µ.*—Å–¥–µ–ª–∞—Ç—å.*–ª—Å',
        ]
        for pattern in work_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞/—Å–∫–ª–∞–¥/–°–î–≠–ö): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 8: –ö–∞—Ä—Ç—ã (–ø—É—à–∫–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞, —Å–Ω—è—Ç–∏–µ —Å –∫–∞—Ä—Ç—ã) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        card_spam_patterns = [
            r'–ø—É—à–∫–∏–Ω—Å–∫[–∞—è–æ–π].*–∫–∞—Ä—Ç', r'–ø—É—à–∫–∏.*–∫–∞—Ä—Ç', r'—Å–Ω–∏–º[–∞—É].*–∫–∞—Ä—Ç', r'—Å–Ω—è—Ç–∏[–µ—è].*–∫–∞—Ä—Ç',
            r'—Å\s+–≤–∞—à[–µ–π].*–∫–∞—Ä—Ç', r'—Å\s+–≤–∞—à[–µ–π].*–ø—É—à–∫–∏–Ω—Å–∫', r'–æ–ø–ª–∞—Ç[–∞—ã].*\d+\s*‚ÇΩ.*–±–∞–Ω–∫',
            r'—Å–Ω–∏–ºa[—É—é].*–ø—É—à–∫–∏–Ω—Å–∫', r'—Å–Ω–∏–ºa[—É—é].*–∫–∞—Ä—Ç', r'c–Ω–∏–ºa[—É—é].*–ø—É—à–∫–∏–Ω—Å–∫', r'c–Ω–∏–ºa[—É—é].*–∫–∞—Ä—Ç',  # –° –ª–∞—Ç–∏–Ω—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏
        ]
        for pattern in card_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∫–∞—Ä—Ç—ã): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 9: –ù–î–°/—á–µ–∫–∏/–±—É–º–∞–∂–Ω—ã–π –ù–î–° (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        vat_spam_patterns = [
            r'–±—É–º–∞–∂–Ω[—ã–π—ã–µ].*–Ω–¥—Å', r'–Ω–¥—Å.*–±—É–º–∞–∂–Ω', r'—á–µ–∫–∏.*–Ω–¥—Å', r'–Ω–¥—Å.*—á–µ–∫–∏',
            r'—É—Å–ª—É–≥[–∞—ã].*–Ω–¥—Å', r'–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º.*–Ω–¥—Å', r'–ø—Ä–µ–¥–ª–∞–≥–∞—é.*–Ω–¥—Å',
            r'–ø–æ–¥–∞—á[–∞—ã].*–Ω–¥—Å', r'–Ω–¥—Å.*–±–µ–∑\s+—Ä–∞–∑—Ä—ã–≤–æ–≤', r'–±–µ–∑\s+—Ä–∞–∑—Ä—ã–≤–æ–≤.*–Ω–¥—Å',
            r'–≥–∞—Ä–∞–Ω—Ç–∏[—è–∏].*—É—Å–ª—É–≥.*\d+\s*–≥–æ–¥', r'—Å—Ç–æ–∏–º–æ—Å—Ç—å.*—É—Å–ª—É–≥.*\d+%', r'–æ–ø–ª–∞—Ç[–∞—ã].*–ø–æ\s+—Ñ–∞–∫—Ç—É',
            r'–∑–∞–∫—Ä—ã—Ç–∏[–µ—è].*–Ω–¥—Å.*—á–µ–∫–∏', r'–Ω–¥—Å.*—á–µ–∫–∏.*qr', r'—á–µ–∫–∏.*qr.*–∫–æ–¥',
            r'–±–∏—Ç–∫–æ–∏–Ω.*–æ–ø–ª–∞—Ç', r'–æ–ø–ª–∞—Ç.*–±–∏—Ç–∫–æ–∏–Ω', r'–¥–ª—è\s+—Å–≤—è–∑–∏.*–ø–∏—Å–∞—Ç—å.*@',
            # –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ "–ù—É–∂–Ω—ã —á–µ–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã"
            r'–Ω—É–∂–Ω—ã\s+—á–µ–∫–∏', r'–Ω—É–∂–Ω—ã\s+—á–µ–∫–∏\s+–∏\s+–¥–æ–∫—É–º–µ–Ω—Ç', r'—á–µ–∫–∏\s+–∏\s+–¥–æ–∫—É–º–µ–Ω—Ç.*–±–∏–∑–Ω–µ—Å',
            r'–æ–Ω–ª–∞–π–Ω\s+–∏\s+–∞—Ä—Ö–∏–≤–Ω—ã–µ\s+—á–µ–∫–∏', r'–∞—Ä—Ö–∏–≤–Ω—ã–µ\s+—á–µ–∫–∏', r'–ø–æ–ª–Ω—ã–º\s+–ø–∞–∫–µ—Ç–æ–º\s+–¥–æ–∫—É–º–µ–Ω—Ç',
            r'—É–ø–¥.*–Ω–∞–∫–ª–∞–¥–Ω', r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*—É–ø–¥', r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*–Ω–∞–∫–ª–∞–¥–Ω',
            r'—Å\s+–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å', r'–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å', r'–±–µ–∑–Ω–∞–ª–∏—á–Ω.*–æ–ø–ª–∞—Ç',
            r'–æ—Å–æ–±—ã–µ\s+—É—Å–ª–æ–≤–∏—è.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', r'–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏[—è–∏].*–Ω–∞–ª–æ–≥',
            r'–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–µ–º\s+–∏\s+—Ä–∞–±–æ—Ç–∞–µ–º\s+–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ',
        ]
        for pattern in vat_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–ù–î–°/—á–µ–∫–∏): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 10: –†–µ–∫–ª–∞–º–∞ –±–æ—Ç–æ–≤ –∏ —Ñ–æ—Ä—É–º–æ–≤ (BaliForumRuBot, MyBaliTrips –∏ –¥—Ä.) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        bot_ad_patterns = [
            r'–≤–∞—à\s+–±–æ—Ç—è', r'—Å\s+–ª—é–±–æ–≤—å—é\s+–∏\s+–∑–∞–±–æ—Ç–æ–π', r'mybalitrips',
            r'baliforum\.ru', r'–±–∞–ª–∏—Ñ–æ—Ä—É–º\.ru', r'—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\s+–±–∞–ª–∏—Ñ–æ—Ä—É–º–∞',
            r'–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–µ\s+–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.*–æ—Å—Ç—Ä–æ–≤', r'–±–æ—Ç—è.*–±–∞–ª–∏—Ñ–æ—Ä—É–º',
            r'–∫—Ä–∞—Ç–∫–æ\s+–∏\s+–ø–æ–ª–µ–∑–Ω–æ', r'–Ω–∞—Ä–æ–¥–Ω–∞—è\s+–∫–∞—Ä—Ç–∞', r'–ª—É—á—à–∏–µ\s+—Å—Ç—Ä–∞—Ö–æ–≤–∫–∏',
            r'–Ω–∞—à\s+—á–∞—Ç\s+–∑–Ω–∞–∫–æ–º—Å—Ç–≤', r'premium\s+—Ä–µ–∫–ª–∞–º–∞',
            # CHATIK –∏ –ø–ª–∞—Ç–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
            r'—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ.*–æ–±—ä—è–≤–ª–µ–Ω–∏.*–ø–ª–∞—Ç–Ω', r'—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ.*–æ–±—ä—è–≤–ª–µ–Ω–∏.*–ø–ª–∞—Ç–Ω',
            r'–ø–µ—Ä–µ–π–¥–∏—Ç–µ\s+–≤\s+@saleschatikbot', r'–¥–ª—è\s+–∑–∞–∫–∞–∑–∞\s+–ø–µ—Ä–µ–π–¥–∏—Ç–µ\s+–≤\s+@saleschatikbot',
            r'saleschatikbot', r'chatik.*support',
            # BaliArenda –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            r'baliarenda\.com', r'@baliarenda_group', r'–ø–æ–¥—Ä–æ–±–Ω–µ–µ\s+–∏\s+–∫–æ–Ω—Ç–∞–∫—Ç—ã.*baliarenda',
        ]
        for pattern in bot_ad_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–µ–∫–ª–∞–º–∞ –±–æ—Ç–æ–≤/—Ñ–æ—Ä—É–º–æ–≤): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 11: –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞/–¥–∏–∑–∞–π–Ω–µ—Ä—ã (—É–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        infographic_spam_patterns = [
            r'–∫—Ç–æ\s+–∑–∞–Ω–∏–º–∞–µ—Ç—Å—è.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫', r'–∑–∞–Ω–∏–º–∞–µ—Ç—Å—è.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫', r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*–æ—Ç–ø–∏—à–∏—Ç–µ',
            r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*—Ä–∞–±–æ—Ç–∞\s+–µ—Å—Ç—å', r'—Ä–∞–±–æ—Ç–∞\s+–µ—Å—Ç—å.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫', r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*–æ—Ç\s+18',
            r'–∫—Ç–æ.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*–æ—Ç–ø–∏—à–∏—Ç–µ', r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18', r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫.*–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥',
        ]
        for pattern in infographic_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞/–¥–∏–∑–∞–π–Ω–µ—Ä—ã): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 11: –ü–ª–∞—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ –≤—Ö–æ–¥–Ω—ã–µ —Ç–µ—Å—Ç—ã (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ)
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "—Ç–µ—Å—Ç" + "–æ–ø–ª–∞—Ç–∞" + "@username" –∏–ª–∏ "—Ç–µ—Å—Ç" + "1000$" –∏–ª–∏ "–≤—Ö–æ–¥–Ω–æ–π —Ç–µ—Å—Ç" + "–æ–ø–ª–∞—Ç–∞"
        paid_test_patterns = [
            r'—Ç–µ—Å—Ç.*–æ–ø–ª–∞—Ç', r'–æ–ø–ª–∞—Ç.*—Ç–µ—Å—Ç', r'–≤—Ö–æ–¥–Ω[–æ–π–æ–π].*—Ç–µ—Å—Ç', r'–≤—Ö—ñ–¥–Ω[–∏–π—ñ–π].*—Ç–µ—Å—Ç',
            r'—Ç–µ—Å—Ç.*\$\d+', r'—Ç–µ—Å—Ç.*\d+\s*\$', r'–ø—Ä–æ–ø—É—Å–∫.*–∑–∞.*\d+', r'–ø—Ä–æ–ø—É—Å–∫.*–∑–∞.*\$',
            r'–≤—Ö—ñ–¥–Ω–∞.*–æ–ø–ª–∞—Ç', r'–≤—Ö–æ–¥–Ω–∞—è.*–æ–ø–ª–∞—Ç', r'–ø—Ä–æ–π—Ç–∏.*—Ç–µ—Å—Ç.*@', r'—Ç–µ—Å—Ç.*@\w+',
            r'—Ç–µ—Å—Ç.*–Ω–∞.*\w+.*–æ–ø–ª–∞—Ç', r'—Ç–µ—Å—Ç.*–∫–º[—ñ–∏]—Ç–ª–∏–≤', r'—Ç–µ—Å—Ç.*–æ—Ä—ñ—î–Ω—Ç—É–≤–∞–Ω–Ω—è'
        ]
        for pattern in paid_test_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å "@username" –∏–ª–∏ —Å—É–º–º–∞ –¥–µ–Ω–µ–≥ - —Ç–æ—á–Ω–æ —Å–ø–∞–º
                if re.search(r'@\w+', message_text) or re.search(r'\d+\s*\$|\$\s*\d+', message_text):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                    return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 11.5: –ü–µ—Ä–µ–≤–æ–∑—á–∏–∫ —Å –≤—ã—Å–æ–∫–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫" + –≤—ã—Å–æ–∫–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (100000+) + "–ø–∏—à–∏ –≤ –ª—Å"
        if re.search(r'–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫', text_lower, re.IGNORECASE):
            if re.search(r'(\d+\s*000|\d{5,})\s*(—Ä—É–±|‚ÇΩ|—Ä\.)', text_lower, re.IGNORECASE):
                if re.search(r'(–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É|@)', text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫ —Å –≤—ã—Å–æ–∫–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                    return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 12: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏–∑ SPAM_FILTERS (patterns.py)
        # –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã: "–ø–∏—à–∏—Ç–µ –≤ –ª—Å", "–æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –ª—Å", "–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤"
        spam_keywords_from_filters = SPAM_FILTERS.get("spam_keywords", [])
        for keyword in spam_keywords_from_filters:
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤ –ø–∞—Ç—Ç–µ—Ä–Ω (—ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
            keyword_pattern = re.escape(keyword.lower())
            if re.search(keyword_pattern, text_lower, re.IGNORECASE):
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å "–∏—â—É/–Ω—É–∂–µ–Ω" + "–ø–∏—à–∏—Ç–µ –≤ –ª—Å" = —Å–ø–∞–º
                if re.search(r'(–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª—Å|–æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–≤\s+–ª–∏—á–∫—É)', text_lower, re.IGNORECASE):
                    if re.search(r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞|–∏—â–µ–º|—Ç—Ä–µ–±—É–µ—Ç—Å—è)', text_lower, re.IGNORECASE):
                        logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∏—â—É/–Ω—É–∂–µ–Ω + –ø–∏—à–∏—Ç–µ –≤ –ª—Å): –Ω–∞–π–¥–µ–Ω–æ '{keyword}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                        return True
                # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ - –≤—Å–µ–≥–¥–∞ —Å–ø–∞–º
                if re.search(r'–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü[–∏—è–∏].*–ø–æ–∏—Å–∫.*–∫–ª–∏–µ–Ω—Ç', text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                    return True
                # –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç + –ø–∏—à–∏—Ç–µ –≤ –ª—Å = —Å–ø–∞–º
                if re.search(r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.*(–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–≤\s+–ª–∏—á–∫—É)', text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç + –ø–∏—à–∏—Ç–µ –≤ –ª—Å): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–∑ SPAM_FILTERS
        min_length = SPAM_FILTERS.get("min_message_length", 5)
        if len(message_text) < min_length:
            logger.info(f"‚ùå –°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ (< {min_length} —Å–∏–º–≤–æ–ª–æ–≤)")
            return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 13: –†–µ–∫–ª–∞–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ–±–º–µ–Ω–µ –≤–∞–ª—é—Ç (–•–ê–ù–ò –ú–ê–ù–ò –∏ –ø–æ–¥–æ–±–Ω—ã–µ) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        currency_exchange_spam_patterns = [
            r'—Ö–∞–Ω–∏\s+–º–∞–Ω–∏', r'hani\s+mani', r'–±–µ–∑–æ–ø–∞—Å–Ω[—ã–µ—ã–µ].*–¥–µ–Ω–µ–∂–Ω[—ã–µ—ã–µ].*–ø–µ—Ä–µ–≤–æ–¥', r'–±–µ–∑–æ–ø–∞—Å–Ω[—ã–µ—ã–µ].*–ø–µ—Ä–µ–≤–æ–¥',
            r'–Ω—É–∂–Ω–æ\s+–ø–æ–º–µ–Ω—è—Ç—å\s+–≤–∞–ª—é—Ç', r'—Ç–≤–æ[–µ—ë]?\s+—Ä–µ—à–µ–Ω–∏–µ', r'–ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω[—ã–π—ã–µ]',
            r'–æ–±–º–µ–Ω\s+–æ—Ç\s+1\s*\$.*–¥–æ\s+\d+\s*\$', r'–æ–±–º–µ–Ω\s+–æ—Ç\s+\d+\s*\$.*–¥–æ\s+\d+\s*\$',
            r'—Å–ø–µ–∫—Ç—Ä\s+—É—Å–ª—É–≥', r'–¥–æ–ø\s+—É—Å–ª—É–≥', r'–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω[–∏–µ].*–∂–∏–ª—å', r'–ø–æ–∫—É–ø–∫[–∞—ã].*–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç',
            r'–æ–ø–ª–∞—Ç[–∞—ã].*–∞–≤–∏–∞\s+–±–∏–ª–µ—Ç', r'–≤—Ä–µ–º—è\s+—Ä–∞–±–æ—Ç—ã.*\d+:\d+.*\d+:\d+', r'–≤—Ä–µ–º—è\s+—Ä–∞–±–æ—Ç—ã.*9:00.*22:00',
            r'–≤–æ–∑–Ω–∏–∫–ª–∏\s+–≤–æ–ø—Ä–æ—Å—ã', r'–æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å\s+—Ç–æ–ª—å–∫–æ\s+–ø–æ\s+—É–∫–∞–∑–∞–Ω–Ω–æ–º—É\s+–∫–æ–Ω—Ç–∞–∫—Ç—É',
            r'—á–∞—Å—Ç–æ\s+–º–æ—à–µ–Ω–Ω–∏–∫[–∏—ã].*–∏—Å–ø–æ–ª—å–∑—É—é—Ç.*–ø–æ—Ö–æ–∂–∏–µ.*–Ω–∞–∑–≤–∞–Ω–∏', r'–≤–Ω–∏–º–∞–Ω–∏[–µ—è]',
            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –≤–∞–ª—é—Ç –∏ —ç–º–æ–¥–∑–∏
            r'–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç[—É—ã].*–≥—Ä–∏–≤–Ω[—ã—ã].*—Ä—É–±–ª[–∏—ã].*—Ä—É–ø–∏[–∏—ã].*—é–∞–Ω[–∏—ã].*usd.*euro.*wise.*paypal',
            r'–æ–±–º–µ–Ω—è–µ–º.*–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç.*–≥—Ä–∏–≤–Ω.*—Ä—É–±–ª.*—Ä—É–ø–∏.*—é–∞–Ω.*usd.*euro',
            r'–¥–æ—Å—Ç–∞–≤–∫[–∞—ã].*–ø–æ.*–±–∞–ª–∏.*–æ–Ω–ª–∞–π–Ω\s+–ø–µ—Ä–µ–≤–æ–¥',
        ]
        for pattern in currency_exchange_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 13.5: –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ–±–º–µ–Ω–µ –≤–∞–ª—é—Ç —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —ç–º–æ–¥–∑–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–ª–∞–º–∞)
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç "–æ–±–º–µ–Ω" + –º–Ω–æ–≥–æ –≤–∞–ª—é—Ç + –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ = —Ä–µ–∫–ª–∞–º–∞
        if re.search(r'(–æ–±–º–µ–Ω|–º–µ–Ω—è—é|–ø–µ—Ä–µ–≤–æ–¥).{0,100}(–≤–∞–ª—é—Ç|–∫—Ä–∏–ø—Ç|usdt|usd|eur|—Ä—É–±–ª|–≥—Ä–∏–≤–Ω|—Ä—É–ø–∏)', text_lower, re.IGNORECASE):
            # –°—á–∏—Ç–∞–µ–º —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
            emoji_count = len(re.findall(r'[üÜòüö®‚ö†Ô∏èüîîüí¨üìùüë§üí¨üîóüìÇüîçüíº‚úÖ‚ùåüö´üõ°ü™™üí∞üåêüåïüëá‚è±Ô∏è‚ÜòÔ∏è‚ùóÔ∏èüá∫üá¶üá∑üá∫üáÆüá©üá®üá≥üá∫üá∏üá™üá∫üáπüá≠üáªüá≥üîπüêùüîÖ]', message_text))
            # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤–∞–ª—é—Ç
            currency_mentions = len(re.findall(r'(usd|eur|usdt|—Ä—É–±–ª|–≥—Ä–∏–≤–Ω|—Ä—É–ø–∏|—é–∞–Ω|–±–∞—Ç|–¥–æ–Ω–≥|euro|wise|paypal|–∫—Ä–∏–ø—Ç)', text_lower, re.IGNORECASE))
            # –ï—Å–ª–∏ –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ –ò –º–Ω–æ–≥–æ –≤–∞–ª—é—Ç = —Ä–µ–∫–ª–∞–º–∞
            if emoji_count > 10 and currency_mentions > 3:
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç: –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ {emoji_count} –∏ –≤–∞–ª—é—Ç {currency_mentions}): {message_text[:100]}...")
                return True
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–µ –æ–± –æ–±–º–µ–Ω–µ = —Ä–µ–∫–ª–∞–º–∞
            if re.search(r'(https?://|t\.me/|@)', message_text, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç —Å–æ —Å—Å—ã–ª–∫–æ–π): {message_text[:100]}...")
                return True
        
        # –í–°–ï –û–°–¢–ê–õ–¨–ù–û–ï (–º–µ–Ω–µ–¥–∂–µ—Ä—ã, —Ä–∞–±–æ—Ç–∞, –æ–±–º–µ–Ω –≤–∞–ª—é—Ç –∏ —Ç.–¥.) –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å AI
        logger.debug(f"‚úÖ [–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú] –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º, AI –ø—Ä–æ–≤–µ—Ä–∏—Ç –¥–µ—Ç–∞–ª—å–Ω–æ")
        return False

    def is_spam_message(self, message_text: str, sender_username: str = None) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ø–∞–º–æ–º (–ü–û–õ–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AI –∏ –Ω–∞ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö)"""
        if not message_text:
            return True
        
        # –ë–õ–û–ö–ò–†–£–ï–ú —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
        if sender_username:
            username_lower = sender_username.lower()
            
            # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –±–æ—Ç–æ–≤
            bot_indicators = ['bot', 'robot', 'support', 'service', 'helper', 'assistant', 'manager', 'admin', 'keeper', 'mod']
            
            # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –±–æ—Ç—ã –∏ —Å–ø–∞–º-–∫–∞–Ω–∞–ª—ã (–≤—Å–µ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
            blocked_usernames = [
                'chatkeeperbot', 'emigrants360_bot', 'protonvoip', 
                'lead_hunterbot', 'no_joinbot', 'do4urobot', 
                'adsmanager', 'chatik', 'jeff guap',
                'saleschatikbot', 'baliarenda_group', 'baliarenda',
                'baliforumrubot', 'staffobmen_official', 'staffobmen',
                'optomstambullll', 'tanya_forest', 'vsep_pi_bot', 'vsep',
                'expertpartner1', 'evakatrin', 'vasilisavorobeva316'
            ]
            
            if any(username_lower.endswith(f'_{ind}') or username_lower.endswith(ind) for ind in bot_indicators):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞/—Å–µ—Ä–≤–∏—Å–∞): {sender_username}")
                return True
                
            if any(username_lower == blocked or blocked in username_lower for blocked in blocked_usernames):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π username): {sender_username}")
                return True

        # –£–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        import re
        # –£–±–∏—Ä–∞–µ–º –≤—Å–µ markdown —Å–∏–º–≤–æ–ª—ã –±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ
        text_clean = re.sub(r'\*+', '', message_text)  # –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏ (–≤–∫–ª—é—á–∞—è **)
        text_clean = re.sub(r'_+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è (–≤–∫–ª—é—á–∞—è __)
        text_clean = re.sub(r'`+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        text_clean = re.sub(r'~+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º —Ç–∏–ª—å–¥—ã
        # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        text_clean = re.sub(r'[üÜòüö®‚ö†Ô∏èüîîüí¨üìùüë§üí¨üîóüìÇüîçüíº‚úÖ‚ùåüö´]+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏
        text_lower = text_clean.lower()
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 0.7: –†–∞–±–æ—Ç–∞ –Ω–∞ WB/–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ê–°–°–ò–°–¢–ï–ù–¢/–ú–ï–ù–ï–î–ñ–ï–† + –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å/wb/–≤–±/ozon - –±–ª–æ–∫–∏—Ä—É–µ–º –í–°–ï–ì–î–ê –ë–ï–ó –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–• –ü–†–û–í–ï–†–û–ö
        assistant_manager_patterns = [
            # –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–º–µ–Ω–µ–¥–∂–µ—Ä + –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å/wb/–≤–±/ozon (–≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ, –ª—é–±—ã–µ –ø–∞–¥–µ–∂–∏)
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*wb', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*–≤–±', 
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*ozon', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*–æ–∑–æ–Ω',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*wb', r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*–≤–±', 
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*ozon', r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*–æ–∑–æ–Ω',
            r'–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å.*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', r'wb.*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', r'–≤–±.*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', r'ozon.*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç', r'–æ–∑–æ–Ω.*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç',
            r'–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å.*–º–µ–Ω–µ–¥–∂–µ—Ä', r'wb.*–º–µ–Ω–µ–¥–∂–µ—Ä', r'–≤–±.*–º–µ–Ω–µ–¥–∂–µ—Ä', r'ozon.*–º–µ–Ω–µ–¥–∂–µ—Ä', r'–æ–∑–æ–Ω.*–º–µ–Ω–µ–¥–∂–µ—Ä',
            # –ü–æ–∏—Å–∫ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞/–º–µ–Ω–µ–¥–∂–µ—Ä–∞: "–∏—â—É"/"–∏—â–µ–º"/"–∏—â–µ—Ç—Å—è"/"–≤ –ø–æ–∏—Å–∫–µ"/"–Ω–∞—Ö–æ–∂—É—Å—å –≤ –ø–æ–∏—Å–∫–µ" + –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–º–µ–Ω–µ–¥–∂–µ—Ä + –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å
            r'(–∏—â[—É–µ—é]|–∏—â–µ–º|–∏—â–µ—Ç—Å—è|–≤\s+–ø–æ–∏—Å–∫–µ|–Ω–∞—Ö–æ–∂—É—Å—å\s+–≤\s+–ø–æ–∏—Å–∫–µ).*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*(wb|–≤–±|ozon|–æ–∑–æ–Ω|–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å)',
            r'(–∏—â[—É–µ—é]|–∏—â–µ–º|–∏—â–µ—Ç—Å—è|–≤\s+–ø–æ–∏—Å–∫–µ|–Ω–∞—Ö–æ–∂—É—Å—å\s+–≤\s+–ø–æ–∏—Å–∫–µ).*–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(wb|–≤–±|ozon|–æ–∑–æ–Ω|–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å)',
            r'(–∏—â[—É–µ—é]|–∏—â–µ–º|–∏—â–µ—Ç—Å—è|–≤\s+–ø–æ–∏—Å–∫–µ|–Ω–∞—Ö–æ–∂—É—Å—å\s+–≤\s+–ø–æ–∏—Å–∫–µ).*–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ|–Ω–∞).*(–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å|wb|–≤–±|ozon|–æ–∑–æ–Ω)',
            r'(–∏—â[—É–µ—é]|–∏—â–µ–º|–∏—â–µ—Ç—Å—è|–≤\s+–ø–æ–∏—Å–∫–µ|–Ω–∞—Ö–æ–∂—É—Å—å\s+–≤\s+–ø–æ–∏—Å–∫–µ).*–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ|–Ω–∞).*(–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å|wb|–≤–±|ozon|–æ–∑–æ–Ω)',
            # –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è "–º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞ –û–∑–æ–Ω –∏ –í–ë" (—Å "–∏", "–∏/–∏–ª–∏")
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–Ω–∞|–¥–ª—è).*(–æ–∑–æ–Ω|ozon).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–≤–±|wb)',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–Ω–∞|–¥–ª—è).*(–≤–±|wb).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–æ–∑–æ–Ω|ozon)',
            r'–∏—â[—É–µ—é].*–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–æ–∑–æ–Ω|ozon|–≤–±|wb).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–æ–∑–æ–Ω|ozon|–≤–±|wb)',
            # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*–ø–ª–∞—Ç—Ñ–æ—Ä–º[–∞—ã]?.*(wb|–≤–±|ozon|–æ–∑–æ–Ω)', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*—Ä–∞–±–æ—Ç[–∞—ã]?.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å',
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*—Ñ–æ—Ç–æ–∫–æ–Ω—Ç–µ–Ω—Ç.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*–≤–±.*–æ–∑–æ–Ω', r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*–æ–∑–æ–Ω.*–≤–±',
            # –î–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã OZON/–æ–∑–æ–Ω
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ).*–ø–ª–∞—Ç—Ñ–æ—Ä–º[–∞—ã]?.*ozon', r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ).*–ø–ª–∞—Ç—Ñ–æ—Ä–º[–∞—ã]?.*–æ–∑–æ–Ω',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ).*–ø–ª–∞—Ç—Ñ–æ—Ä–º[–∞—ã]?.*ozon', r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–¥–ª—è|–ø–æ).*–ø–ª–∞—Ç—Ñ–æ—Ä–º[–∞—ã]?.*–æ–∑–æ–Ω',
            # –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è "–º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞ –û–∑–æ–Ω –∏ –í–ë" (—Å "–∏", "–∏/–∏–ª–∏")
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–Ω–∞|–¥–ª—è).*(–æ–∑–æ–Ω|ozon).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–≤–±|wb)',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–Ω–∞|–¥–ª—è).*(–≤–±|wb).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–æ–∑–æ–Ω|ozon)',
            r'–∏—â[—É–µ—é].*–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?.*(–æ–∑–æ–Ω|ozon|–≤–±|wb).*(–∏|–∏/–∏–ª–∏|–∏–ª–∏).*(–æ–∑–æ–Ω|ozon|–≤–±|wb)',
        ]
        for pattern in assistant_manager_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–º–µ–Ω–µ–¥–∂–µ—Ä + –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' - –±–ª–æ–∫–∏—Ä—É–µ–º –í–°–ï–ì–î–ê: {message_text[:100]}...")
                return True
        
        # –ü–†–ò–û–†–ò–¢–ï–¢ 2: –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ —Ä–∞–±–æ—Ç—É –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö
        wb_spam_patterns = [
            r'—Å—Ç–∞–∂–µ—Ä.*–Ω–∞\s+(wb|–≤–±)', r'—Å—Ç–∞–∂–µ—Ä.*–¥–ª—è\s+(wb|–≤–±)', r'–ø–æ–º–æ—â–Ω–∏–∫.*–Ω–∞\s+(wb|–≤–±)',
            r'–ø–æ–º–æ—â–Ω–∏–∫.*–¥–ª—è\s+(wb|–≤–±)', r'—Ä–∞–±–æ—Ç–∞\s+–Ω–∞\s+(wb|–≤–±)', r'—Ä–∞–±–æ—Ç–∞\s+–¥–ª—è\s+(wb|–≤–±)',
            r'(wb|–≤–±).*—Å—Ç–∞–∂–µ—Ä', r'(wb|–≤–±).*–ø–æ–º–æ—â–Ω–∏–∫', r'(wb|–≤–±).*–±–µ–∑\s+–æ–ø—ã—Ç',
            r'(wb|–≤–±).*–æ–±—É—á—É', r'(wb|–≤–±).*—É–¥–∞–ª–µ–Ω–∫', r'wildberries.*—Å—Ç–∞–∂–µ—Ä',
            r'wildberries.*–ø–æ–º–æ—â–Ω–∏–∫', r'–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å.*—Å—Ç–∞–∂–µ—Ä', r'–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å.*–ø–æ–º–æ—â–Ω–∏–∫',
            r'–∫–∞—Ä—Ç–æ—á–∫.*—Ç–æ–≤–∞—Ä', r'–æ—Ç–≤–µ—á–∞—Ç—å.*–æ—Ç–∑—ã–≤.*(wb|–≤–±)', r'–æ—Ñ–æ—Ä–º–ª—è—Ç—å.*–æ–ø–∏—Å–∞–Ω–∏.*—Ç–æ–≤–∞—Ä',
            r'—Å–æ–∑–¥–∞–Ω–∏.*–∫–∞—Ä—Ç–æ—á–∫.*—Ç–æ–≤–∞—Ä'
        ]
        for pattern in wb_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å "–±–µ–∑ –æ–ø—ã—Ç–∞", "–æ–±—É—á—É", "—É–¥–∞–ª–µ–Ω–∫–∞", "–≤ –ª—Å", "–ø–∏—à–∏—Ç–µ" –∏–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ - —Ç–æ—á–Ω–æ —Å–ø–∞–º
                spam_indicators = r'(–±–µ–∑\s+–æ–ø—ã—Ç|–æ–±—É—á—É|–Ω–∞—É—á—É|—É–¥–∞–ª–µ–Ω–∫|–≤\s+–ª—Å|–≤\s+–ª–∏—á–∫—É|–ø–∏—à–∏—Ç–µ|–∑–ø|–∑–∞—Ä–ø–ª–∞—Ç|—Ç—ã—Å|—Ç—Ä|‚ÇΩ|\d+\s*—Ç—ã—Å|\d+\s*—Ç—Ä)'
                if re.search(spam_indicators, text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–∞–±–æ—Ç–∞ –Ω–∞ WB/–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 8: –ö–∞—Ä—Ç—ã (–ø—É—à–∫–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞, —Å–Ω—è—Ç–∏–µ —Å –∫–∞—Ä—Ç—ã) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        card_spam_patterns = [
            r'–ø—É—à–∫–∏–Ω—Å–∫[–∞—è–æ–π].*–∫–∞—Ä—Ç', r'–ø—É—à–∫–∏.*–∫–∞—Ä—Ç', r'—Å–Ω–∏–º[–∞—É].*–∫–∞—Ä—Ç', r'—Å–Ω—è—Ç–∏[–µ—è].*–∫–∞—Ä—Ç',
            r'—Å\s+–≤–∞—à[–µ–π].*–∫–∞—Ä—Ç', r'—Å\s+–≤–∞—à[–µ–π].*–ø—É—à–∫–∏–Ω—Å–∫', r'–æ–ø–ª–∞—Ç[–∞—ã].*\d+\s*‚ÇΩ.*–±–∞–Ω–∫',
            r'—Å–Ω–∏–ºa[—É—é].*–ø—É—à–∫–∏–Ω—Å–∫', r'—Å–Ω–∏–ºa[—É—é].*–∫–∞—Ä—Ç', r'c–Ω–∏–ºa[—É—é].*–ø—É—à–∫–∏–Ω—Å–∫', r'c–Ω–∏–ºa[—É—é].*–∫–∞—Ä—Ç',  # –° –ª–∞—Ç–∏–Ω—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏
        ]
        for pattern in card_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–∫–∞—Ä—Ç—ã/–ø—É—à–∫–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 9: –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ Telegram (–±–µ–∑ –Ω–∞–∫—Ä—É—Ç–æ–∫, —Ä–∞—Å—Å—ã–ª–∫–∏, –±–æ—Ç—ã, —Å–∫—Ä–∏–ø—Ç—ã) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        telegram_promo_patterns = [
            r'telegram-?–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏[–µ—è]', r'—Ä–∞—Å—Å—ã–ª–∫[–∏–∞].*–≤—ã—Å–æ–∫–∏–º\s+–æ—Ç–∫–ª–∏–∫[–æ–º]',
            r'—Å–±–æ—Ä.*—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏[—è–∏].*–∞—É–¥–∏—Ç–æ—Ä–∏[–∏—è]', r'—Ä–µ–∞–ª—å–Ω—ã–µ\s+—É—á–∞—Å—Ç–Ω–∏–∫–∏', r'–±–æ—Ç—ã\s+–∏\s+—Å–∫—Ä–∏–ø—Ç—ã.*–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏[–∏—è]',
            r'–≤–∏–∑—É–∞–ª.*–ø–æ–¥\s+–≤–∞—à\s+–±—Ä–µ–Ω–¥', r'–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏[–µ—è].*–±–µ–∑\s+–Ω–∞–∫—Ä—É—Ç–æ–∫'
        ]
        for pattern in telegram_promo_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (Telegram-–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 10: –ü–µ—Ä–µ–≤–æ–∑—á–∏–∫/–ö—É—Ä—å–µ—Ä (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫', text_lower, re.IGNORECASE):
            if re.search(r'(\d+\s*000|\d{5,})\s*(—Ä—É–±|‚ÇΩ|—Ä\.)', text_lower, re.IGNORECASE):
                if re.search(r'(–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É|@)', text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫ —Å –≤—ã—Å–æ–∫–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
            return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 11: –†–∞–±–æ—Ç–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö/—Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "—Ä–∞–±–æ—Ç–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö" + –∑–∞—Ä–ø–ª–∞—Ç–∞ + "–ø–∏—à–∏"
        # –ò–ª–∏: "—Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å" + –∑–∞—Ä–ø–ª–∞—Ç–∞ + "–ø–∏—à–∏"
        work_active_patterns = [
            r'—Ä–∞–±–æ—Ç–∞\s+–¥–ª—è\s+–∞–∫—Ç–∏–≤–Ω',  # –†–∞–±–æ—Ç–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö
            r'—Å–æ–±—Ä–∞—Ç—å\s+–º–µ–±–µ–ª—å',  # –°–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å
            r'–Ω—É–∂–Ω–æ\s+—Å–æ–±—Ä–∞—Ç—å\s+–º–µ–±–µ–ª—å',  # –ù—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å
            r'—Å–æ–±—Ä–∞—Ç—å.*–º–µ–±–µ–ª—å.*–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',  # –°–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
        ]
        for pattern in work_active_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã (–æ—Ç 3000 –¥–æ 10000 –∑–∞ –¥–µ–Ω—å/–¥–µ–Ω—å)
                has_salary = re.search(r'(\d{4,5})\s*(–∑–∞\s+–¥–µ–Ω—å|–≤\s+–¥–µ–Ω—å|—Ä—É–±|‚ÇΩ|—Ä\.)', text_lower, re.IGNORECASE)
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–ø–∏—à–∏"/"–ø–∏—à–∏—Ç–µ"
                has_write = re.search(r'(–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE)
                if has_salary and has_write:
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–∞–±–æ—Ç–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö/—Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å —Å –≤—ã—Å–æ–∫–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                    return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 12: –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞/–∫–æ—Ä–æ–±–∫–∏ –±–µ–∑ –ø–æ–≥—Ä—É–∑–∫–∏ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞" + "–∫–æ—Ä–æ–±–∫–∏" + –∑–∞—Ä–ø–ª–∞—Ç–∞ + "–¥–µ–Ω—å–≥–∏ –≤ –¥–µ–Ω—å —Ä–∞–±–æ—Ç—ã"
        delivery_spam_patterns = [
            r'–Ω–æ–≤–æ–≥–æ–¥–Ω[–∞—è—É—é].*–¥–æ—Å—Ç–∞–≤–∫',  # –ù–æ–≤–æ–≥–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞
            r'–∫–æ—Ä–æ–±–∫[–∏—ã].*–±–µ–∑\s+–ø–æ–≥—Ä—É–∑–∫',  # –ö–æ—Ä–æ–±–∫–∏ –±–µ–∑ –ø–æ–≥—Ä—É–∑–∫–∏
            r'–∫–æ—Ä–æ–±–∫[–∏—ã].*–Ω–µ–±–æ–ª—å—à',  # –ö–æ—Ä–æ–±–∫–∏ –Ω–µ–±–æ–ª—å—à–∏–µ
            r'–¥–æ—Å—Ç–∞–≤–∫[–∞–∏].*–∫–æ—Ä–æ–±–∫',  # –î–æ—Å—Ç–∞–≤–∫–∞ –∫–æ—Ä–æ–±–æ–∫
        ]
        for pattern in delivery_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã (–æ—Ç 3000 –¥–æ 10000 –∑–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤/–¥–µ–Ω—å)
                has_salary = re.search(r'(\d{4,5})\s*(–∑–∞\s+–ø–∞—Ä—É\s+—á–∞—Å–æ–≤|–≤\s+–¥–µ–Ω—å|—Ä—É–±|‚ÇΩ|—Ä\.)', text_lower, re.IGNORECASE)
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–¥–µ–Ω—å–≥–∏ –≤ –¥–µ–Ω—å —Ä–∞–±–æ—Ç—ã" –∏–ª–∏ "–∫–æ–º—É –Ω—É–∂–Ω—ã –¥–µ–Ω—å–≥–∏"
                has_money_phrase = re.search(r'(–¥–µ–Ω—å–≥–∏\s+–≤\s+–¥–µ–Ω—å\s+—Ä–∞–±–æ—Ç—ã|–∫–æ–º—É\s+–Ω—É–∂–Ω—ã\s+–¥–µ–Ω—å–≥–∏|–¥–µ–Ω—å–≥–∏\s+—Å–µ–≥–æ–¥–Ω—è)', text_lower, re.IGNORECASE)
                if has_salary or has_money_phrase:
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞/–∫–æ—Ä–æ–±–∫–∏ –±–µ–∑ –ø–æ–≥—Ä—É–∑–∫–∏): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
            return True

        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 13: –û–±–º–µ–Ω –≤–∞–ª—é—Ç —Å "–Ω–∞–∫–∏–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç" (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–∫—É–ø–∏—Ç—å usdt/usdc/—Ç–µ–∑–µ—Ä" + "–Ω–∞–ª–∏—á–Ω—ã–µ" + "–Ω–∞–∫–∏–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç"
        if re.search(r'(–∫—É–ø–ª—é|–∫—É–ø–∏—Ç—å|–Ω—É–∂–Ω–æ\s+–∫—É–ø–∏—Ç—å).{0,50}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç)', text_lower, re.IGNORECASE):
            if re.search(r'(–Ω–∞–ª–∏—á–Ω—ã–µ|–Ω–∞–ª|–Ω–∞–ª–∏—á–∫)', text_lower, re.IGNORECASE):
                if re.search(r'(–Ω–∞–∫–∏–Ω—É|–Ω–∞–∫–∏–¥—ã–≤–∞—é|–¥–æ–±–∞–≤–ª—é|–¥–æ–±–∞–≤–ª—é).{0,30}(–ø—Ä–æ—Ü–µ–Ω—Ç|–ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤|–±–æ–Ω—É—Å|–ø—Ä–µ–º–∏—é)', text_lower, re.IGNORECASE):
                    logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–æ–±–º–µ–Ω –≤–∞–ª—é—Ç —Å –Ω–∞–∫–∏–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                    return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 14: –ù–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏" + "–ø–ª–∞—á—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏" + "–ø–∏—à–∏"
        # –ò–õ–ò –ø—Ä–æ—Å—Ç–æ "–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏" + "–ø–ª–∞—á—É" (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        if re.search(r'–Ω–æ–≤–æ–≥–æ–¥–Ω[–∞—è—É—é].*—Ç–µ–º–∞.*–±–∞–ª–∞–Ω—Å.*—Ç–∞–∫—Å–∏', text_lower, re.IGNORECASE):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ–ø–ª–∞—Ç—ã/–∑–∞—Ä–ø–ª–∞—Ç—ã
            has_payment = re.search(r'(–ø–ª–∞—á—É|–ø–ª–∞—Ç[–∞—É]|–∑–∞—Ä–ø–ª–∞—Ç|–∑–ø|–æ–ø–ª–∞—Ç).*(–ø–æ.*–≤—Ä–µ–º–µ–Ω–∏|–≤—Ä–µ–º—è|—á–∞—Å–æ–≤|—á–∞—Å)', text_lower, re.IGNORECASE)
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ—Å—å–±—ã –ø–∏—Å–∞—Ç—å
            has_write = re.search(r'(–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ|@)', text_lower, re.IGNORECASE)
            if has_payment or has_write:
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 15: GSM-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è/—Ä–µ–∫–ª–∞–º–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ (–Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∏—à–∞–º) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: —Ä–µ–∫–ª–∞–º–∞ GSM-—Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏, –¥–æ–∑–≤–æ–Ω–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–≤–æ–Ω–∫–æ–≤
        gsm_telephony_patterns = [
            r'gsm[-\s]?—Ç–µ–ª–µ—Ñ–æ–Ω–∏[—è–∏]',  # GSM-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è
            r'gsm.*–¥–æ–∑–≤–æ–Ω',  # GSM –¥–æ–∑–≤–æ–Ω
            r'–º–æ—â–Ω—ã–π\s+–¥–æ–∑–≤–æ–Ω',  # –ú–æ—â–Ω—ã–π –¥–æ–∑–≤–æ–Ω
            r'—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫[–∞—É].*–∑–≤–æ–Ω–∫',  # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–≤–æ–Ω–∫–æ–≤
            r'–Ω–æ–º–µ—Ä–∞.*–≤—Å–µ–≥–¥–∞\s+–≤\s+–Ω–∞–ª–∏—á–∏–∏',  # –ù–æ–º–µ—Ä–∞ –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞–ª–∏—á–∏–∏
            r'–ø–æ–¥–¥–µ—Ä–∂–∫–∞\s+24/7',  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7
            r'–∞–≤—Ç–æ–∑–∞–º–µ–Ω[–∞—É].*–Ω–æ–º–µ—Ä–æ–≤',  # –ê–≤—Ç–æ–∑–∞–º–µ–Ω–∞ –Ω–æ–º–µ—Ä–æ–≤
            r'–∑–≤–æ–Ω–∫–∏.*–ø–∞–¥–∞—é—Ç',  # –ó–≤–æ–Ω–∫–∏ –ø–∞–¥–∞—é—Ç
            r'–ø–æ—Å—Ç–∞–≤—â–∏–∫.*–ø–æ–¥–≤–µ–ª',  # –ü–æ—Å—Ç–∞–≤—â–∏–∫ –ø–æ–¥–≤–µ–ª
            r'–ø—Ä–æ–±–ª–µ–º[—ã—ã].*—Å\s+—Ç–µ–ª–µ—Ñ–æ–Ω–∏–µ–π',  # –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∏–µ–π
        ]
        for pattern in gsm_telephony_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (GSM-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è/—Ä–µ–∫–ª–∞–º–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 16: –†–∞–±–æ—Ç–∞ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è —Å –∞–≤—Ç–æ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è —Å –∞–≤—Ç–æ" + –æ–ø–ª–∞—Ç–∞ + "–¥–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É"
        if re.search(r'–¥–ª—è\s+–≤–æ–¥–∏—Ç–µ–ª[—è–∏].*—Å\s+–∞–≤—Ç–æ', text_lower, re.IGNORECASE):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ–ø–ª–∞—Ç—ã (–æ—Ç 1000 –¥–æ 5000 –≤ —á–∞—Å)
            has_salary = re.search(r'(\d{4,5})\s*(‚ÇΩ|—Ä—É–±|—Ä\.).*(–≤\s+—á–∞—Å|–∑–∞\s+—á–∞—Å)', text_lower, re.IGNORECASE)
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–¥–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É" –∏–ª–∏ "–∫–æ—Ä–æ—Ç–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"
            has_money_phrase = re.search(r'(–¥–µ–Ω—å–≥–∏\s+—Å—Ä–∞–∑—É|–æ–ø–ª–∞—Ç[–∞—É].*—Å—Ä–∞–∑—É|–∫–æ—Ä–æ—Ç–∫–∏–µ\s+–º–∞—Ä—à—Ä—É—Ç—ã)', text_lower, re.IGNORECASE)
            if has_salary or has_money_phrase:
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ä–∞–±–æ—Ç–∞ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è —Å –∞–≤—Ç–æ): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 17: –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏/–Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "–±—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏" + "–Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã" + –æ–ø–ª–∞—Ç–∞
        if re.search(r'(–±—ã—Å—Ç—Ä—ã–µ\s+–¥–µ–Ω—å–≥–∏|–∞–∫—Ç—É–∞–ª—å–Ω—ã\s+–±—ã—Å—Ç—Ä—ã–µ\s+–¥–µ–Ω—å–≥–∏)', text_lower, re.IGNORECASE):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã" –∏–ª–∏ –æ–ø–ª–∞—Ç—ã
            has_work_phrase = re.search(r'(–Ω–µ–±–æ–ª—å—à–æ–π\s+–æ–±—ä—ë–º\s+—Ä–∞–±–æ—Ç—ã|–Ω–µ–±–æ–ª—å—à[–æ–π—É—é].*–æ–±—ä—ë–º)', text_lower, re.IGNORECASE)
            has_payment = re.search(r'–æ–ø–ª–∞—Ç[–∞—É].*\d+', text_lower, re.IGNORECASE)
            if has_work_phrase or has_payment:
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–±—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏/–Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 18: –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –¥–ª—è –ø–æ–º–æ—â–∏ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫" + "–¥–ª—è –ø–æ–º–æ—â–∏" + –æ–ø–ª–∞—Ç–∞ + "–≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö"
        if re.search(r'—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+–Ω–µ—Å–∫–æ–ª—å–∫–æ\s+—á–µ–ª–æ–≤–µ–∫', text_lower, re.IGNORECASE):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–¥–ª—è –ø–æ–º–æ—â–∏", –æ–ø–ª–∞—Ç—ã –∏ "–≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö"
            has_help_phrase = re.search(r'(–¥–ª—è\s+–ø–æ–º–æ—â–∏|–ø–æ–º–æ—â—å\s+–≤|–ø–æ–¥–≥–æ—Ç–æ–≤–∫)', text_lower, re.IGNORECASE)
            has_payment = re.search(r'(–æ–ø–ª–∞—Ç[–∞—É].*–≤—ã—Å–æ–∫|–∑–∞—Ä–∞–±–æ—Ç[–∞—É]|–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å)', text_lower, re.IGNORECASE)
            has_pm_phrase = re.search(r'(–≤\s+–ª–∏—á–Ω—ã—Ö\s+—Å–æ–æ–±—â–µ–Ω–∏—è—Ö|–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏\s+–≤\s+–ª–∏—á–Ω—ã—Ö|–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE)
            if has_help_phrase and (has_payment or has_pm_phrase):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –¥–ª—è –ø–æ–º–æ—â–∏): –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú 19: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Instagram/Facebook (—Ä–µ–∫–ª–∞–º–∞ —É—Å–ª—É–≥, –Ω–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ—Å—ä–µ–º–∫–∞) - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        # –ë–ª–æ–∫–∏—Ä—É–µ–º: "recover", "recovery", "restore", "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" + "instagram", "account", "disabled", "banned"
        instagram_recovery_patterns = [
            r'instant.*ig.*recover',  # INSTANT IG RECOVERIES
            r'instant.*ig.*recoveries',  # INSTANT IG RECOVERIES (–ø–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞)
            r'recover.*instagram',  # recover Instagram
            r'instagram.*recover',  # Instagram recovery
            r'recover.*disabled.*account',  # recover disabled account
            r'recover.*banned.*account',  # recover banned account
            r'restore.*instagram',  # restore Instagram
            r'instagram.*restore',  # Instagram restore
            r'banned.*on.*instagram',  # Banned on Instagram
            r'b@nned.*on.*instagram',  # B@nned on Instagram (—Å –∑–∞–º–µ–Ω–æ–π –±—É–∫–≤—ã)
            r'disabled.*account',  # disabled account
            r'dnr.*copyright.*strike',  # DNR, copyright strikes
            r'copyright.*strike',  # copyright strikes
            r'recover.*via.*rep',  # recover via rep
            r'instagramrecovery',  # instagramrecovery
            r'recoverinstagram',  # recoverinstagram
            r'instarecovery',  # instarecovery
            r'fb.*recovery',  # Facebook recovery
            r'facebook.*recovery',  # Facebook recovery
            r'meta.*support',  # Meta support
        ]
        for pattern in instagram_recovery_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ Instagram –∞–∫–∫–∞—É–Ω—Ç–æ–≤): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£, –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ)
        databases_spam_patterns = [
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è
            r'–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ',  # –ò—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏[—è–µ]',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è
            r'–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è.*—Ä–∞–±–æ—Ç–∞.*—Ç–µ–ª–µ—Ñ–æ–Ω',  # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'—Ä–∞–±–æ—Ç–∞\s+—Å\s+—Ç–µ–ª–µ—Ñ–æ–Ω[–æ–º]?',  # –†–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'—Ä–∞–±–æ—Ç–∞.*—Ç–µ–ª–µ—Ñ–æ–Ω.*–±–µ–∑.*–≤–ª–æ–∂–µ–Ω–∏–π',  # –†–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º –±–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π
            r'–Ω–∏–∫—É–¥–∞\s+—Ö–æ–¥–∏—Ç—å\s+–Ω–µ\s+–Ω–∞–¥–æ',  # –ù–∏–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å –Ω–µ –Ω–∞–¥–æ
            r'–±–µ–∑\s+–≤–ª–æ–∂–µ–Ω–∏–π',  # –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π
            r'–±–µ–∑\s+–≤–ª–æ–∂–µ–Ω–∏–π.*—Ä–∞–±–æ—Ç–∞',  # –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞
            r'—Å—Ä–æ—á–Ω–æ\s+–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª',  # –°—Ä–æ—á–Ω–æ –∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª.*–∑–∞–¥–∞–Ω–∏—è.*—Ç–µ–ª–µ—Ñ–æ–Ω',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'(–∏—â—É|–Ω—É–∂–Ω—ã).*–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª.*(–ø—Ä–æ—Å—Ç—ã–µ|–∑–∞–¥–∞–Ω–∏—è).*(—Ç–µ–ª–µ—Ñ–æ–Ω|–±–µ–∑.*–≤–ª–æ–∂–µ–Ω–∏–π)',  # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è
        ]
        for pattern in databases_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å–ø–∞–º –ø—Ä–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ "—à–∞–±–∞—à–∫—É" –∏ —Ä–∞–±–æ—Ç—É –æ—Ç 1000$ (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        shabashka_spam_patterns = [
            r'—à–∞–±–∞—à–∫[–∞–∏]',  # –®–∞–±–∞—à–∫–∞, —à–∞–±–∞—à–µ—á–∫–∞
            r'—à–∞–±–∞—à–µ—á–∫[–∞–∏]',  # –®–∞–±–∞—à–µ—á–∫–∞
            r'—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+\d+\s*\$',  # –†–∞–±–æ—Ç–∞ –æ—Ç 1000$
            r'—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+\d+\s*–¥–æ–ª–ª–∞—Ä',  # –†–∞–±–æ—Ç–∞ –æ—Ç 1000 –¥–æ–ª–ª–∞—Ä–æ–≤
            r'–ø–ª–∞—Ç–∞\s+–∑–∞\s+–∫–∞–∂–¥[—ã–º]?\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω[—ã–º]?\s+–∑–∞–¥–∞–Ω–∏[–µ–º]',  # –ü–ª–∞—Ç–∞ –∑–∞ –∫–∞–∂–¥—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∑–∞–¥–∞–Ω–∏–µ–º
            r'–ø–ª–∞—Ç–∞\s+–∑–∞\s+–∫–∞–∂–¥[–æ–µ]?\s+–∑–∞–¥–∞–Ω–∏[–µ]',  # –ü–ª–∞—Ç–∞ –∑–∞ –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            r'–∑–∞\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ\s+–∫–∞–∂–¥–æ–º—É',  # –ó–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É
            r'–∑–∞\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ\s+–∫–∞–∂–¥[–æ–µ]?\s+–∑–∞–¥–∞–Ω–∏[–µ]',  # –ó–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            r'—Å–∞–º\s+—Ä–µ—à–∞–µ—à—å.*–∫–æ–≥–¥–∞\s+–¥–µ–ª–∞—Ç—å',  # –°–∞–º —Ä–µ—à–∞–µ—à—å, –∫–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å
            r'–ø–æ–∫–∞–∂—É.*–∫–∞–∫\s+–Ω–∞—á–∞—Ç—å.*—É–∂–µ\s+—Å–µ–≥–æ–¥–Ω—è',  # –ü–æ–∫–∞–∂—É, –∫–∞–∫ –Ω–∞—á–∞—Ç—å —É–∂–µ —Å–µ–≥–æ–¥–Ω—è
            r'–∞–≤–∞–Ω—Å[—ã]?',  # –ê–≤–∞–Ω—Å—ã
            r'—à–∞–±–∞—à–∫[–∞–∏].*–¥–µ–Ω—å',  # –®–∞–±–∞—à–∫–∞ –≤ –¥–µ–Ω—å
            r'—à–∞–±–∞—à–∫[–∞–∏].*–æ—Ç\s+\d+',  # –®–∞–±–∞—à–∫–∞ –æ—Ç 15.000
            r'–∑–∞–Ω—è—Ç–∏–µ\s+–Ω–∞\s+–ø–∞—Ä—É\s+—á–∞—Å–æ–≤',  # –ó–∞–Ω—è—Ç–∏–µ –Ω–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤
            r'–∑–∞–Ω—è—Ç–∏–µ.*–ø–∞—Ä—É.*—á–∞—Å–æ–≤.*–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ',  # –ó–∞–Ω—è—Ç–∏–µ –Ω–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤ + –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
            r'–∫–æ–º—É\s+–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ\s+–ø–∏—à–∏—Ç–µ',  # –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—à–∏—Ç–µ (—á–∞—Å—Ç–æ –≤ —Å–ø–∞–º–µ –ø—Ä–æ —Ä–∞–±–æ—Ç—É)
        ]
        for pattern in shabashka_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å–ø–∞–º –ø—Ä–æ —à–∞–±–∞—à–∫—É/—Ä–∞–±–æ—Ç—É –æ—Ç 1000$ - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –∑–≤–µ–∑–¥—ã –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£, –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ)
        stars_spam_patterns = [
            r'–∫–æ–º—É\s+–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç',
            r'–∑–∞\s+\d+\s+–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞', r'–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞',
            r'–∑–≤–µ–∑–¥—ã\s+–ø–∏—à–∏—Ç–µ', r'–∑–≤–µ–∑–¥—ã\s+–≤\s+–ª—Å', r'–ø–∏—à–∏—Ç–µ\s+–º–Ω–µ\s+–≤\s+–ª—Å.*–∑–≤–µ–∑–¥—ã',
            r'–∑–≤–µ–∑–¥.*–≤\s+–ª—Å', r'–∑–≤–µ–∑–¥—ã.*–≤\s+–±–æ—Ç–µ', r'–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç.*–∑–≤–µ–∑–¥',
        ]
        for pattern in stars_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å–ø–∞–º –ø—Ä–æ –∑–≤–µ–∑–¥—ã - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–æ '{pattern}' –≤ —Ç–µ–∫—Å—Ç–µ: {message_text[:100]}...")
                return True
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É
        if len(message_text) < 10:
            logger.info("‚ùå –°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ")
            return True
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–±–ª–æ–∫–∏—Ä—É–µ–º –í–°–ï–ì–î–ê, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
        # –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
        text_clean_for_check = re.sub(r'[^\w\s]', ' ', text_lower)
        text_clean_for_check = re.sub(r'\s+', ' ', text_clean_for_check).strip()
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞" + "–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?', text_lower, re.IGNORECASE):
            if re.search(r'–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', text_lower, re.IGNORECASE) and re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞ + –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞" + "–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?', text_lower, re.IGNORECASE):
            if re.search(r'–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', text_lower, re.IGNORECASE) and re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ + –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "—Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" + –Ω–∏–∑–∫–∞—è –æ–ø–ª–∞—Ç–∞ = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'—Ç–µ—Å—Ç–æ–≤[–æ–µ]?\s+–∑–∞–¥–∞–Ω–∏[–µ—è]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ–ø–ª–∞—Ç–∞\s+–∑–∞\s+—Å–ª–∞–π–¥|–æ–ø–ª–∞—Ç–∞\s+\d+\s+—Ä|300\s+—Ä)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å + –Ω–∏–∑–∫–∞—è –æ–ø–ª–∞—Ç–∞): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE) and re.search(r'(—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18|–æ—Ç\s+18\s+–ª–µ—Ç|–±–µ—Ä–µ–º\s+—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å + –æ—Ç 18): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É" + "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—à–∏—Ç–µ" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–Ω—É–∂–µ–Ω\s+–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—à–∏—Ç–µ|–ø–∏—Å–∞—Ç—å|–Ω–∞–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ—Ç\s+18\s+–ª–µ—Ç|—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18|–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞|–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—à–∏—Ç–µ + –æ—Ç 18): {message_text[:100]}...")
                return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—à–∏—Ç–µ" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—à–∏—Ç–µ|–ø–∏—Å–∞—Ç—å|–Ω–∞–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ—Ç\s+18\s+–ª–µ—Ç|—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18|–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞|–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞)', text_lower, re.IGNORECASE):
                logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—à–∏—Ç–µ + –æ—Ç 18): {message_text[:100]}...")
                return True
        
        absolute_spam_keywords = [
            # –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú)
            '–±–∞–∑—ã', '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö', '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä—Ñ', '–ø—Ä–æ–¥–∞–∂–∞ –±–∞–∑', '–ø—Ä–æ–¥–∞–º –±–∞–∑—É',
            '–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', '—Å –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏', '–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ',
            '–æ–ø—Ç–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞', '–æ–ø—Ç–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã',
            '—Å –∏–Ω–Ω', '–∏–Ω–Ω', '–≤—ã–±–æ—Ä–∫–∏ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º', '–≤—ã–±–æ—Ä–∫–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤',
            '–≤—ã–±–æ—Ä–∫–∏ –±–∞–Ω–∫–æ–≤', '–≤—ã–±–æ—Ä–∫–∏ –±–∞–Ω–∫', '–¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ',
            '–¥–ª—è –ø–æ–∫—É–ø–∫–∏ –ø–∏—à–∏—Ç–µ', '–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ', '–±—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞',
            '—Ä–∞–∑—É–º–Ω—ã–µ —Ü–µ–Ω—ã', '–¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤',
            
            '–¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫',
            '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞', '–º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞',
            '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∫', '–º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∫',
            '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫—É –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É', '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É',
            '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫—É –¥–ª—è –ø–æ–º–æ—â–∏', '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫–∞ –¥–ª—è –ø–æ–º–æ—â–∏',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏',
            '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ', '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ',
            '—Ç–æ–≥–æ –∫—Ç–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫—É', '–∫—Ç–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫—É',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞',
            '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ', '–¥–∏–∑–∞–π–Ω–µ—Ä –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ',
            '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞', '–¥–∏–∑–∞–π–Ω–µ—Ä –ø–æ–º–æ—â–Ω–∏–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä –ø–æ–º–æ—â–Ω–∏–∫–∞',
        ]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö —Å–ø–∞–º-–∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        for keyword in absolute_spam_keywords:
            keyword_clean = re.sub(r'[^\w\s]', ' ', keyword.lower())
            keyword_clean = re.sub(r'\s+', ' ', keyword_clean).strip()
            if keyword_clean in text_clean_for_check:
                # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
                suspicious_indicators_absolute = [
                    '–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω', '–æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –Ω–µ –≤–∞–∂–µ–Ω', '–Ω–∞ –æ–ø—ã—Ç –Ω–µ —Å–º–æ—Ç—Ä—é', '–±–µ–∑ –æ–ø—ã—Ç–∞', '–Ω–æ–≤–∏—á–∫–∏ –ø–æ–¥–æ–π–¥—É—Ç',
                    '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å', '–ø–∏—Å–∞—Ç—å –≤ –ª—Å', '–≤ –ª—Å', '–≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
                    '–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
                    '–ø–∏—Å–∞—Ç—å –≤ –ª—Å', '–ø–∏—à–∏—Ç–µ –≤ –ª—Å', '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª—Å', 
                    '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É', '–≤ –ª–∏—á–∫—É', '–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É', '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É',
                    '–æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É', '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å', '–æ–ø–ª–∞—Ç–∞ –µ—Å—Ç—å', '–æ–ø–ª–∞—Ç–∞ –¥–æ—Å—Ç–æ–π–Ω–∞—è', '–æ–ø–ª–∞—Ç–∞ —Ö–æ—Ä–æ—à–∞—è',
                    '–æ–±—É—á—É', '–Ω–∞—É—á—É', '–µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ', '–æ–±—É—á—É –∏ –Ω–∞—É—á—É',
                    '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –æ–±—É—á—É', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –Ω–∞—É—á—É', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ',
                    '–≤—Å–µ–º—É –æ–±—É—á—É –∏ –Ω–∞—É—á—É', '–æ–±—É—á–∞—é –µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ',
                    '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç', '–≤ –¥–∏—Ä–µ–∫—Ç', '–ø–∏—à–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç',
                    '—Å—Ç—Ä–æ–≥–æ –æ—Ç 18', '–æ—Ç 18 –ª–µ—Ç', '–¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18', '—Ç–æ–ª—å–∫–æ –æ—Ç 18',
                    '–∫—Ç–æ –Ω–µ –¥–æ—Å—Ç–∏–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞', '—Å 18 –ª–µ—Ç', '–±–µ—Ä–µ–º —Å—Ç—Ä–æ–≥–æ –æ—Ç 18',
                    '—Å—Ç—Ä–æ–≥–æ –æ—Ç 18 –ª–µ—Ç', '—Ä–∞–±–æ—Ç–∞ –æ—Ç 18 –ª–µ—Ç', '—Ç–∞–∫ –∂–µ –∏—â—É', '–∞ —Ç–∞–∫ –∂–µ',
                    '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç', '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ',
                    '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫–µ', '–ø–∏—à–∏—Ç–µ –æ—Ç 18 –ª–µ—Ç',
                    '–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫', '—Å–¥–µ–ª–∞—Ç—å –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫',
                    '–∫–æ–º—É –Ω—É–∂–Ω—ã –∑–≤–µ–∑–¥—ã', '–≤ –±–æ—Ç–µ –¥–∞—é—Ç', '–∑–∞ 1 –ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞', '–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
                    '–Ω–µ –¥–æ—Ä–æ–≥–æ', '–Ω–µ–¥–æ—Ä–æ–≥–æ', '—Ä–∞–±–æ—Ç—ã –º–Ω–æ–≥–æ –Ω–µ –¥–æ—Ä–æ–≥–æ',
                    '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏ –≤–∞—à–∏ —Ü–µ–Ω—ã –≤ –ª—Å', '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –≤ –ª—Å', '—Ü–µ–Ω—ã –≤ –ª—Å',
                    '—Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ', '—Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ', '–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–µ',
                    '–æ–ø–ª–∞—Ç–∞ –∑–∞ —Å–ª–∞–π–¥', '–æ–ø–ª–∞—Ç–∞ 300 —Ä', '300 —Ä',
                ]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
                found_indicator = False
                matched_indicator = None
                for indicator in suspicious_indicators_absolute:
                    indicator_clean = re.sub(r'[^\w\s]', ' ', indicator.lower())
                    indicator_clean = re.sub(r'\s+', ' ', indicator_clean).strip()
                    if indicator_clean in text_clean_for_check:
                        found_indicator = True
                        matched_indicator = indicator
                        break
                
                # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
                if found_indicator:
                    logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ '{keyword}' + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä '{matched_indicator}'")
                    return True
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –µ—Å–ª–∏ –µ—Å—Ç—å "–∏—â—É" –∏–ª–∏ "–Ω—É–∂–µ–Ω" + –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ, –±–ª–æ–∫–∏—Ä—É–µ–º (–¥–∞–∂–µ –±–µ–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)
                if '–∏—â—É' in text_clean_for_check or '–Ω—É–∂–µ–Ω' in text_clean_for_check or '–Ω—É–∂–Ω–∞' in text_clean_for_check:
                    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑
                    suspicious_phrases = ['–ø–∏—Å–∞—Ç—å', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è', '–≤ –ª–∏—á–Ω—ã–µ', '–≤ –ª—Å', '–≤ –¥–∏—Ä–µ–∫—Ç', '–æ–ø–ª–∞—á—É', '–æ–ø–ª–∞—Ç–∞', '–æ–±—É—á—É', '–Ω–∞—É—á—É', '–æ–ø—ã—Ç –Ω–µ', '–æ—Ç 18', '–µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ', '–∞ —Ç–∞–∫ –∂–µ', '—Ç–∞–∫ –∂–µ –∏—â—É']
                    if any(ind in text_clean_for_check for ind in suspicious_phrases):
                        logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–æ '–∏—â—É/–Ω—É–∂–µ–Ω' + –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ '{keyword}' + –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã")
                        return True
                    
                    # –ï–©–ï –ë–û–õ–ï–ï –°–¢–†–û–ì–û: –µ—Å–ª–∏ –µ—Å—Ç—å "–∏—â—É" + –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ + "–∞ —Ç–∞–∫ –∂–µ" –∏–ª–∏ "—Ç–∞–∫ –∂–µ –∏—â—É" - –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
                    if ('–∞ —Ç–∞–∫ –∂–µ' in text_clean_for_check or '—Ç–∞–∫ –∂–µ –∏—â—É' in text_clean_for_check) and ('–º–µ–Ω–µ–¥–∂–µ—Ä' in text_clean_for_check or '–¥–∏–∑–∞–π–Ω–µ—Ä' in text_clean_for_check or '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫' in text_clean_for_check):
                        logger.info(f"üö´üö´üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Å—Ç—Ä–æ–≥–∞—è): –Ω–∞–π–¥–µ–Ω–æ '–∏—â—É' + –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ '{keyword}' + '–∞ —Ç–∞–∫ –∂–µ'")
                        return True
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º-—Ñ—Ä–∞–∑—ã (–±–ª–æ–∫–∏—Ä—É–µ–º —Å—Ä–∞–∑—É, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã)
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —É—á–µ—Ç–∞ —Ä–∞–∑–Ω—ã—Ö –ø–∞–¥–µ–∂–µ–π
        strict_spam_patterns = [
            r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∏—á–Ω–æ–≥–æ\s+–∫–∞–±–∏–Ω–µ—Ç–∞',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∫',
            r'–∏—â—É\s+–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∏—á–Ω–æ–≥–æ\s+–∫–∞–±–∏–Ω–µ—Ç–∞',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∏—á–Ω–æ–≥–æ\s+–∫–∞–±–∏–Ω–µ—Ç–∞\s+–Ω–∞\s+wb',
            r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]',
            r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]',
            r'–Ω—É–∂–µ–Ω\s+–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]',
            r'–Ω—É–∂–Ω–∞\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∞–∏—ã]',
            r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]',
            r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]',
            r'–Ω—É–∂–µ–Ω\s+–º–µ–Ω–µ–¥–∂–µ—Ä\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∏—á–Ω–æ–≥–æ\s+–∫–∞–±–∏–Ω–µ—Ç–∞',
            r'–Ω—É–∂–µ–Ω\s+–º–µ–Ω–µ–¥–∂–µ—Ä\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∫',
            r'–Ω—É–∂–µ–Ω\s+–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]',
            r'–Ω—É–∂–µ–Ω\s+—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]',
            r'–∏—â—É\s+—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç[–∞–µ—ã]?\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]',
        ]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å—Ç—Ä–æ–≥–∏—Ö —Å–ø–∞–º-–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ —É—á–µ—Ç–∞ –ø—Ä–æ–±–µ–ª–æ–≤ (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        simple_spam_phrases = [
            '–¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫',
            '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞', '–º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞',
            '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∫', '–º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∫',
            '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫—É –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É', '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏',
            '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ', '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ',
        ]
        
        found_strict_phrase = False
        matched_pattern = None
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ —Ñ—Ä–∞–∑—ã (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        for phrase in simple_spam_phrases:
            # –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –∏ –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            phrase_clean = re.sub(r'[^\w\s]', '', phrase.lower())
            text_clean_for_check = re.sub(r'[^\w\s]', '', text_lower)
            if phrase_clean in text_clean_for_check:
                found_strict_phrase = True
                matched_pattern = phrase
                break
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Ñ—Ä–∞–∑–∞–º–∏, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏
        if not found_strict_phrase:
            for pattern in strict_spam_patterns:
                if re.search(pattern, text_lower, re.IGNORECASE):
                    found_strict_phrase = True
                    matched_pattern = pattern
                    break
        
        if found_strict_phrase:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
            suspicious_indicators = [
                r'–æ–ø—ã—Ç\s+–Ω–µ\s+–≤–∞–∂–µ–Ω', r'–±–µ–∑\s+–æ–ø—ã—Ç–∞', r'–Ω–∞\s+–æ–ø—ã—Ç\s+–Ω–µ\s+—Å–º–æ—Ç—Ä—é', r'–Ω–æ–≤–∏—á–∫–∏\s+–ø–æ–¥–æ–π–¥—É—Ç',
                r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª—Å', r'–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å', r'–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è', 
                r'–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è', r'–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ', r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è',
                r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è', r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–∫—É',
                r'–≤\s+–ª–∏—á–∫—É', r'–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–∫—É', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–∫—É',
                r'–æ–ø–ª–∞—á—É\s+—Å—Ä–∞–∑—É', r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏\s+–≤\s+–ª—Å', r'–æ–ø–ª–∞—Ç–∞\s+–µ—Å—Ç—å',
                r'–æ–±—É—á—É', r'–Ω–∞—É—á—É', r'–µ—Å—Ç—å\s+–æ–±—É—á–µ–Ω–∏–µ',
                r'—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18', r'–æ—Ç\s+18\s+–ª–µ—Ç', r'–¥–æ—Å—Ç–∏–≥—à–∏–µ\s+—Å—Ç–∞—Ä—à–µ\s+18', 
                r'—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18', r'–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞', r'—Å\s+18\s+–ª–µ—Ç',
                r'–±–µ—Ä–µ–º\s+—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18', r'—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18\s+–ª–µ—Ç', r'—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+18\s+–ª–µ—Ç',
            ]
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
            found_indicators = 0
            simple_suspicious_phrases = [
                '–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω', '–±–µ–∑ –æ–ø—ã—Ç–∞', '–Ω–∞ –æ–ø—ã—Ç –Ω–µ —Å–º–æ—Ç—Ä—é', '–Ω–æ–≤–∏—á–∫–∏ –ø–æ–¥–æ–π–¥—É—Ç',
                '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å', '–ø–∏—Å–∞—Ç—å –≤ –ª—Å', '–≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', 
                '–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
                '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É', '–≤ –ª–∏—á–∫—É',
                '–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É', '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É', '–æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É', '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å',
                '–æ–ø–ª–∞—Ç–∞ –µ—Å—Ç—å', '–æ–ø–ª–∞—Ç–∞ —Ö–æ—Ä–æ—à–∞—è', '–æ–ø–ª–∞—Ç–∞ –¥–æ—Å—Ç–æ–π–Ω–∞—è', '–æ–±—É—á—É', '–Ω–∞—É—á—É', '–µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ',
                '–æ–±—É—á—É –∏ –Ω–∞—É—á—É', '–≤—Å–µ–º—É –æ–±—É—á—É –∏ –Ω–∞—É—á—É', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ',
                '–æ–±—É—á–∞—é –µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –æ–±—É—á—É',
                '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç', '–≤ –¥–∏—Ä–µ–∫—Ç', '–ø–∏—à–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç',
                '—Å—Ç—Ä–æ–≥–æ –æ—Ç 18', '–æ—Ç 18 –ª–µ—Ç', '–¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18', 
                '—Ç–æ–ª—å–∫–æ –æ—Ç 18', '–∫—Ç–æ –Ω–µ –¥–æ—Å—Ç–∏–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞', '—Å 18 –ª–µ—Ç',
                '–±–µ—Ä–µ–º —Å—Ç—Ä–æ–≥–æ –æ—Ç 18', '—Å—Ç—Ä–æ–≥–æ –æ—Ç 18 –ª–µ—Ç', '—Ä–∞–±–æ—Ç–∞ –æ—Ç 18 –ª–µ—Ç',
                '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç', '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ',
                '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫–µ', '–ø–∏—à–∏—Ç–µ –æ—Ç 18 –ª–µ—Ç',
            ]
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ —Ñ—Ä–∞–∑—ã (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
            text_clean_for_check = re.sub(r'[^\w\s]', '', text_lower)
            for phrase in simple_suspicious_phrases:
                phrase_clean = re.sub(r'[^\w\s]', '', phrase.lower())
                if phrase_clean in text_clean_for_check:
                    found_indicators += 1
            
            # –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏
            found_indicators += sum(1 for indicator in suspicious_indicators if re.search(indicator, text_lower, re.IGNORECASE))
            
            if found_indicators >= 1:  # –ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–∞ —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞ '{matched_pattern}' + –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã ({found_indicators})")
                return True
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å "–∏—â—É/–Ω—É–∂–µ–Ω/—Å—Ä–æ—á–Ω–æ –Ω—É–∂–µ–Ω" + —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞ + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" –∏–ª–∏ "–æ—Ç 18", –±–ª–æ–∫–∏—Ä—É–µ–º
            if re.search(r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞|—Å—Ä–æ—á–Ω–æ\s+–Ω—É–∂–µ–Ω)', text_lower) and re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É|–æ—Ç\s+18|—Å\s+18|—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+18)', text_lower, re.IGNORECASE):
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è '–∏—â—É/–Ω—É–∂–µ–Ω' + —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞ + '–ø–∏—Å–∞—Ç—å –≤ –ª—Å/–æ—Ç 18'")
                return True
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞ + "–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω" + "–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É", –±–ª–æ–∫–∏—Ä—É–µ–º
            if re.search(r'(–æ–ø—ã—Ç\s+–Ω–µ\s+–≤–∞–∂–µ–Ω|–Ω–æ–≤–∏—á–∫–∏\s+–ø–æ–¥–æ–π–¥—É—Ç)', text_lower) and re.search(r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–∫—É|–≤\s+–ª–∏—á–∫—É|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–∫—É)', text_lower, re.IGNORECASE):
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞ + '–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω' + '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É'")
                return True
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑ (–≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        suspicious_combinations = [
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä|–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫)', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞|–æ–ø—ã—Ç.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è|–Ω–∞.*–æ–ø—ã—Ç.*–Ω–µ.*—Å–º–æ—Ç—Ä—é)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç|–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É + –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä)', r'–æ–ø–ª–∞—á—É.*—Å—Ä–∞–∑—É', r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ–±—É—á—É –∏ –Ω–∞—É—á—É + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä)', r'(–æ–±—É—á—É|–Ω–∞—É—á—É|–µ—Å—Ç—å.*–æ–±—É—á–µ–Ω–∏–µ)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–≤.*–¥–∏—Ä–µ–∫—Ç).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + —Å—Ç—Ä–æ–≥–æ –æ—Ç 18 + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä)', r'(—Å—Ç—Ä–æ–≥–æ.*–æ—Ç.*18|–¥–æ—Å—Ç–∏–≥—à–∏–µ.*18|—Å—Ç–∞—Ä—à–µ.*18|—Å.*18.*–ª–µ—Ç)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç|–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –∫–∞—Ä—Ç–æ—á–∫–∏ + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–∫', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç|–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            (r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç', r'(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞)', r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç|–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Ç–æ–≤–∞—Ä–∞ + –æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É + –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*—Ç–æ–≤–∞—Ä', r'–æ–ø–ª–∞—á—É.*—Å—Ä–∞–∑—É', r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Ç–æ–≤–∞—Ä–∞ + —Å—Ç—Ä–æ–≥–æ –æ—Ç 18
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*—Ç–æ–≤–∞—Ä', r'(—Å—Ç—Ä–æ–≥–æ.*–æ—Ç.*18|–¥–æ—Å—Ç–∏–≥—à–∏–µ.*18|—Å—Ç–∞—Ä—à–µ.*18|—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º.*–ª–∏—Ü–∞.*–¥–æ—Å—Ç–∏–≥—à–∏–µ)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –¥–∏–∑–∞–π–Ω–µ—Ä –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –Ω–µ –¥–æ—Ä–æ–≥–æ + –≤ –ª—Å
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', r'(–Ω–µ\s+–¥–æ—Ä–æ–≥–æ|–Ω–µ–¥–æ—Ä–æ–≥–æ|—Ä–∞–±–æ—Ç—ã\s+–º–Ω–æ–≥–æ\s+–Ω–µ\s+–¥–æ—Ä–æ–≥–æ)', r'(–≤\s+–ª—Å|–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.*–≤\s+–ª—Å|—Ü–µ–Ω—ã.*–≤\s+–ª—Å)'),
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ + –Ω–µ –¥–æ—Ä–æ–≥–æ + –≤ –ª—Å
            (r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?', r'(–Ω–µ\s+–¥–æ—Ä–æ–≥–æ|–Ω–µ–¥–æ—Ä–æ–≥–æ|—Ä–∞–±–æ—Ç—ã\s+–º–Ω–æ–≥–æ)', r'(–≤\s+–ª—Å|–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.*–≤\s+–ª—Å|—Ü–µ–Ω—ã.*–≤\s+–ª—Å)'),
        ]
        
        for combo in suspicious_combinations:
            matches = sum(1 for pattern in combo if re.search(pattern, text_lower, re.IGNORECASE))
            if matches >= 2:  # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ 2 –∏–∑ 3 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
                logger.info(f"‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: {combo}")
            return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É
        if len(message_text) > 1000:
            logger.info("‚ùå –°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ")
            return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–º–æ–¥–∑–∏ –∏–∑ SPAM_FILTERS
        # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç –∏–∑-–∑–∞ —ç–º–æ–¥–∑–∏ –¥–µ–Ω–µ–≥ (üí∞, üíµ, üí∏)
        is_exchange_message = bool(re.search(r'(–∫—É–ø–ª—é|–ø—Ä–æ–¥–∞–º|–æ–±–º–µ–Ω—è—é|–æ–±–º–µ–Ω|–º–µ–Ω—è—é).{0,100}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|–Ω–∞–ª|–Ω–∞–ª–∏—á–∫)', text_lower, re.IGNORECASE))
        
        emoji_count = sum(1 for c in message_text if ord(c) > 0x1F600)
        max_emojis = SPAM_FILTERS.get("max_emojis", 3)
        if emoji_count > max_emojis:
            # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ï—Å–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç, —Ä–∞–∑—Ä–µ—à–∞–µ–º –±–æ–ª—å—à–µ —ç–º–æ–¥–∑–∏ (–¥–µ–Ω—å–≥–∏, –æ–±–º–µ–Ω)
            if is_exchange_message:
                logger.info(f"‚ö†Ô∏è –ú–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ ({emoji_count}), –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            else:
                logger.info(f"‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏: {emoji_count}")
                return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º-—Å–ª–æ–≤–∞
        # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç (–∫—É–ø–ª—é/–ø—Ä–æ–¥–∞–º USDT, –æ–±–º–µ–Ω—è—é –Ω–∞–ª –∏ —Ç.–¥.)
        is_exchange_message = bool(re.search(r'(–∫—É–ø–ª—é|–ø—Ä–æ–¥–∞–º|–æ–±–º–µ–Ω—è—é|–æ–±–º–µ–Ω|–º–µ–Ω—è—é).{0,100}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|–Ω–∞–ª|–Ω–∞–ª–∏—á–∫)', text_lower, re.IGNORECASE))
        
        spam_keywords = [
            # –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—Ö–µ–º—ã (–∏—Å–∫–ª—é—á–∞–µ–º "–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞" –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–æ –æ–±–º–µ–Ω)
            "–±–∏–Ω–∞—Ä–Ω—ã–µ –æ–ø—Ü–∏–æ–Ω—ã", "–±—ã—Å—Ç—Ä—ã–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫", "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
            "–∫–∞–∑–∏–Ω–æ", "—Å—Ç–∞–≤–∫–∏", "–ª–æ—Ç–µ—Ä–µ—è", "—Ä–æ–∑—ã–≥—Ä—ã—à", "–ø—Ä–∏–∑", "–≤—ã–∏–≥—Ä—ã—à",
            "–±–µ—Å–ø–ª–∞—Ç–Ω–æ", "–∞–∫—Ü–∏—è", "—Å–∫–∏–¥–∫–∞", "—Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞",
            "–∑–∞—Ä–∞–±–æ—Ç–æ–∫", "–∫—Ä–µ–¥–∏—Ç", "–∑–∞–π–º", 
            
            # –°–ø–∞–º –ø—Ä–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú)
            "–±–∞–∑—ã", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä—Ñ", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–±", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∑",
            "–ø—Ä–æ–¥–∞–∂–∞ –±–∞–∑", "–ø—Ä–æ–¥–∞–º –±–∞–∑—É", "–ø—Ä–µ–¥–ª–∞–≥–∞—é –±–∞–∑—É", "–ø—Ä–µ–¥–ª–∞–≥–∞—é –±–∞–∑—ã",
            "–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "—Å –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏", "–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ",
            "–æ–ø—Ç–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞", "–æ–ø—Ç–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã",
            "—Å –∏–Ω–Ω", "–∏–Ω–Ω", "–≤—ã–±–æ—Ä–∫–∏ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º", "–≤—ã–±–æ—Ä–∫–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤",
            "–≤—ã–±–æ—Ä–∫–∏ –±–∞–Ω–∫–æ–≤", "–≤—ã–±–æ—Ä–∫–∏ –±–∞–Ω–∫", "–ø—Ä–æ–±–∏–≤", "–ø—Ä–æ–±–∏–≤ –ø–æ –±–∞–∑–µ",
            "–ø—Ä–æ–±–∏–≤ –ø–æ –ª–∏–Ω–∏–∏", "–ø—Ä–æ–±–∏–≤ –ø–æ —Ñ–Ω—Å", "–ø—Ä–æ–±–∏–≤ –ø–æ –º–≤–¥",
            "–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "–ø—Ä–æ–¥–∞–º –¥–∞–Ω–Ω—ã–µ",
            "–¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ", "–¥–ª—è –ø–æ–∫—É–ø–∫–∏ –ø–∏—à–∏—Ç–µ",
            "–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ", "–±—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞",
            "—Ä–∞–∑—É–º–Ω—ã–µ —Ü–µ–Ω—ã", "–¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤",
            "—Ñ–∏–∑—ã", "—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞", "–≤—ã–≥—Ä—É–∑–∫–∞ –±–∞–∑", "–≤—ã–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª",
            "—Ç–µ—Å—Ç—ã –±–∞–∑", "–∑–∞–º–µ–Ω–∞ –±–∞–∑", "–ø–æ–ª–Ω–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑",
            "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–µ–º–∞–≥–∞–∑–∏–Ω",
            "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–∞–Ω–∫", "–≤—ã–±–æ—Ä–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É", "–≤—ã–±–æ—Ä–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω—É",
            "–≤—ã–±–æ—Ä–∫–∞ –ø–æ –ø–æ–ª—É", "–≤ –Ω–∞–ª–∏—á–∏–∏ –±–∞–∑–∞", "–æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫",
            "—é–∑–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª", "–ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –≤ –ª–∏—á–∫—É",
            
            # –°–ø–∞–º –ø—Ä–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—É —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ)
            "–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è", "–∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ",
            "–ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º", "—Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º",
            "—Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º –±–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π", "–Ω–∏–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å –Ω–µ –Ω–∞–¥–æ",
            "–±–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π", "—Å—Ä–æ—á–Ω–æ –∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π",
            
            # –°–ø–∞–º –ø—Ä–æ –∑–≤–µ–∑–¥—ã –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
            "–∫–æ–º—É –Ω—É–∂–Ω—ã –∑–≤–µ–∑–¥—ã", "–Ω—É–∂–Ω—ã –∑–≤–µ–∑–¥—ã", "–≤ –±–æ—Ç–µ –¥–∞—é—Ç", "–∑–∞ 1 –ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞",
            "–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞", "–∑–∞ –ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ", "–∑–≤–µ–∑–¥—ã –ø–∏—à–∏—Ç–µ",
            
            # –°–ø–∞–º –ø—Ä–æ –ø—Ä–æ–≤–µ—Ä–∫—É/–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
            "–Ω–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É", "–Ω–µ –ø—Ä–æ—à—ë–ª –ø—Ä–æ–≤–µ—Ä–∫—É", "–Ω–µ –ø—Ä–æ—à–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É",
            "–Ω–µ –ø—Ä–æ—à–ª–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é", "–Ω–µ –ø—Ä–æ—à—ë–ª –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é", "–Ω–µ –ø—Ä–æ—à–ª–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é",
            "–Ω–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –≤ –ª—Å", "–Ω–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É /start", "–±–æ—Ç—É –≤ –ª—Å /start",
            "–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞", "–ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞", "–¥–ª—è –¥–æ—Å—Ç—É–ø–∞",
            "—Ä–µ—à–∏—Ç–µ —ç—Ç—É –∫–∞–ø—á—É", "—Ä–µ—à–∏—Ç–µ –∫–∞–ø—á—É", "–ø—Ä–æ–π–¥–∏—Ç–µ –∫–∞–ø—á—É",
            "–ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É", "–ø—Ä–æ–π–¥–∏—Ç–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é",
            
            # –°–ø–∞–º –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–Ω–∏–∫–æ–≤)
            "prestige –ø–æ–º–æ–∂–µ—Ç —Å –æ–±–º–µ–Ω–æ–º", "cashfriends –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å —Å –æ–±–º–µ–Ω–æ–º",
            "–ø–æ–º–æ–∂–µ—Ç —Å –æ–±–º–µ–Ω–æ–º", "–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ", "–Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ –ª—Å",
            "–≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å —Å –æ–±–º–µ–Ω–æ–º", "–±—ã—Å—Ç—Ä–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ",
            
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É/–ø–æ–¥—Ä–∞–±–æ—Ç–∫—É
            "–Ω—É–∂–Ω—ã –ø–æ–º–æ—â–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —Ä–∞–±–æ—Ç—ã", "—Ä–∞—Å—á—ë—Ç —Å—Ä–∞–∑—É", "–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å –≤ –ª—Å",
            "–∏—â–µ–º –ª—é–¥–µ–π –Ω–∞ —É–±–æ—Ä–∫—É", "–æ–ø–ª–∞—Ç–∞ –Ω–∞ —Ä—É–∫–∏", "–≥–æ—Ç–æ–≤ –ø–∏—à–∏",
            "–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å", "—É–¥–∞–ª–µ–Ω–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å", "—É–¥–∞–ª—ë–Ω–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å",
            "ByBit", "Binance", "–Ω–∞–ø–∏—à–∏—Ç–µ + –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", "–Ω–∞–ø–∏—à–∏—Ç–µ + –≤ –ª—Å",
            "—Å—Ä–æ—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–π", "—Å—Ä–æ—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–π",
            "–∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∏–ª–∏ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞", "–∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ä–∞–±–æ—Ç–∞", "–∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞",
            "—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥", "–±–æ–Ω—É—Å –∑–∞ —Ö–æ—Ä–æ—à–æ —Å–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É", "—Ä–∞—Å—Å–∫–∞–∂—É —á—Ç–æ –¥–µ–ª–∞—Ç—å",
            "–∑–∞–Ω—è—Ç–∏–µ –Ω–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤", "–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É", "–∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—à–∏—Ç–µ",
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É –Ω–∞ WB/–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ)
            "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è wb", "–∏—â—É –ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb", "–ø–æ–º–æ—â–Ω–∏–∫–∞ wb –±–µ–∑ –æ–ø—ã—Ç–∞",
            "–ø–æ–º–æ—â–Ω–∏–∫–∞ wb –±–µ–∑ –æ—Ç–ø—ã—Ç–∞", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb –æ–±—É—á—É", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb –∑–ø",
            "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wildberries", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è wildberries", "–∏—â—É –ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wildberries",
            "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb –±–µ–∑ –æ–ø—ã—Ç–∞", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb –±–µ–∑ –æ—Ç–ø—ã—Ç–∞", "–ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ wb –∑–∞—Ä–ø–ª–∞—Ç–∞",
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É —Å –§–ù–°/–ú–í–î/–≥–æ—Å–æ—Ä–≥–∞–Ω–∞–º–∏ (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ)
            "—Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —Ñ–Ω—Å", "—Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–≤–¥", "—Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –≥–æ—Å–æ—Ä–≥–∞–Ω", "—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —Ñ–Ω—Å",
            "—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–≤–¥", "–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤–µ—Ç–æ–∫ –Ω–¥—Å",
            "–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤–µ—Ç–æ–∫ –Ω–¥—Å", "–ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤–µ—Ç–æ–∫ –Ω–¥—Å",
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π + "–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è"
            "—Ä–∞–±–æ—Ç–∞ —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü—É", "—Ä–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –ø—è—Ç–Ω–∏—Ü–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞",
            "—Ä–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –ø—è—Ç–Ω–∏—Ü–∞ –∑–ø", "—Ä–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –ø—è—Ç–Ω–∏—Ü–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–Ω—ã–µ",
            "—Ä–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –ø—è—Ç–Ω–∏—Ü–∞ –∑–∞ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –Ω–∞–ø–∏—à–∏—Ç–µ",
            
            # –°–ø–∞–º –ø—Ä–æ "—à–∞–±–∞—à–∫—É" –∏ —Ä–∞–±–æ—Ç—É –æ—Ç 1000$
            "—à–∞–±–∞—à–∫–∞", "—à–∞–±–∞—à–µ—á–∫–∞", "—à–∞–±–∞—à–∫", "—à–∞–±–∞—à–µ—á–∫",
            "—Ä–∞–±–æ—Ç–∞ –æ—Ç 1000", "—Ä–∞–±–æ—Ç–∞ –æ—Ç 1000$", "—Ä–∞–±–æ—Ç–∞ –æ—Ç 1000 –¥–æ–ª–ª–∞—Ä",
            "–ø–ª–∞—Ç–∞ –∑–∞ –∫–∞–∂–¥—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∑–∞–¥–∞–Ω–∏–µ–º", "–ø–ª–∞—Ç–∞ –∑–∞ –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ",
            "–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É", "–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ",
            "—Å–∞–º —Ä–µ—à–∞–µ—à—å –∫–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å", "–ø–æ–∫–∞–∂—É –∫–∞–∫ –Ω–∞—á–∞—Ç—å —É–∂–µ —Å–µ–≥–æ–¥–Ω—è",
            "–∞–≤–∞–Ω—Å—ã", "–∞–≤–∞–Ω—Å", 
            
            # –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã –∏ –ª–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
            "–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç", "–ª–∫", "sberbank", "—Å–±–µ—Ä–±–∞–Ω–∫", "–≤—Ç–±", "–∞–ª—å—Ñ–∞ –±–∞–Ω–∫",
            "–ø—Ä–æ–¥–∞–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç", "–∫—É–ø–ª—é –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç", "–ø—Ä–æ–¥–∞–º –ª–∫", "–∫—É–ø–ª—é –ª–∫",
            "–ø—Ä–æ–¥–∞–º –∫–∞—Ä—Ç—É", "–∫—É–ø–ª—é –∫–∞—Ä—Ç—É", "–ø–ª–∞—Å—Ç–∏–∫ –∫–∞—Ä—Ç—É", "–ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞",
            "–ø—Ä–æ–¥–∞–º –ø—É—à–∫–∏–Ω—Å–∫—É—é –∫–∞—Ä—Ç—É", "–∫—É–ø–ª—é –ø—É—à–∫–∏–Ω—Å–∫—É—é –∫–∞—Ä—Ç—É", "–æ–ø–ª–∞—Ç–∞ –Ω–∞ –ª—é–±—É—é –∫–∞—Ä—Ç—É",
            "swift", "sepa", "–±–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞", "–¥–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞", "–∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞",
            
            # –ü—Ä–æ–±–∏–≤ –∏ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ (—É–∂–µ –µ—Å—Ç—å –≤—ã—à–µ, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
            "–ø—Ä–æ–±–∏–≤ –ø–æ –ª–∏–Ω–∏–∏", "–ø—Ä–æ–±–∏–≤ –ø–æ –±–∞–∑–µ", "–ø—Ä–æ–±–∏–≤ –ø–æ —Ñ–Ω—Å", "–ø—Ä–æ–±–∏–≤ –ø–æ –º–≤–¥",
            "–ø—Ä–æ–±–∏–≤ –ø–æ –≥–∏–±–¥–¥", "–ø—Ä–æ–±–∏–≤ –ø–æ –∑–∞–≥—Å", "–ø—Ä–æ–±–∏–≤ –ø–æ –ø—Ñ—Ä", "–ø—Ä–æ–±–∏–≤ –ø–æ –Ω–∞–ª–æ–≥–æ–≤–æ–π",
            "–ø—Ä–æ–±–∏–≤ –ø–æ –ø–æ–ª–∏—Ü–∏–∏", "–ø—Ä–æ–±–∏–≤",
            
            # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
            "–æ–Ω–ª–∞–π–Ω-–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞", "–±–µ–∑ –æ–ø—ã—Ç–∞", "–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω—É–∂–Ω—ã", 
            "–≥–∞—Ä–∞–Ω—Ç –≤—Å–µ–≥–¥–∞ –∑–∞", "–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞", "–æ–ø–ª–∞—Ç–∞ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è",
            "–æ–ø–ª–∞—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç—É", "–æ–ø–ª–∞—Ç–∞ –Ω–∞ –ª—é–±—É—é –∫–∞—Ä—Ç—É", "—Ä–∞–±–æ—Ç–∞ –Ω–∞ –¥–æ–º—É", 
            "—É–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞", "—Ñ—Ä–∏–ª–∞–Ω—Å", "–º–ª–º", "–ø–∏—Ä–∞–º–∏–¥–∞", "—Å–µ—Ç–µ–≤–æ–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥",
            "–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω", "–æ–ø—ã—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è", "–æ–ø—ã—Ç –Ω–µ –Ω—É–∂–µ–Ω", "–±–µ–∑ –æ–ø—ã—Ç–∞ —Ä–∞–±–æ—Ç—ã",
            "–æ–±—É—á—É –∏ –Ω–∞—É—á—É", "–≤—Å–µ–º—É –æ–±—É—á—É", "–Ω–∞—É—á—É –∏ –æ–±—É—á—É", "–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—é",
            "–æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É", "–æ–ø–ª–∞—Ç–∞ —Å—Ä–∞–∑—É", "–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞",
            "—Ä–∞–±–æ—Ç–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö", "—Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å", "–Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –º–µ–±–µ–ª—å",
            "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∞–º", "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–∞–º",
            "–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞", "–∫–æ—Ä–æ–±–∫–∏ –±–µ–∑ –ø–æ–≥—Ä—É–∑–∫–∏", "–∫–æ—Ä–æ–±–∫–∏ –Ω–µ–±–æ–ª—å—à–∏–µ",
            "–¥–µ–Ω—å–≥–∏ –≤ –¥–µ–Ω—å —Ä–∞–±–æ—Ç—ã", "–∫–æ–º—É –Ω—É–∂–Ω—ã –¥–µ–Ω—å–≥–∏ —Å–µ–≥–æ–¥–Ω—è", "–¥–µ–Ω—å–≥–∏ —Å–µ–≥–æ–¥–Ω—è",
            "6000 –∑–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤", "–∑–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤",
            "–Ω–∞–∫–∏–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç", "–Ω–∞–∫–∏–¥—ã–≤–∞—é –ø—Ä–æ—Ü–µ–Ω—Ç", "–¥–æ–±–∞–≤–ª—é –ø—Ä–æ—Ü–µ–Ω—Ç", "–Ω–∞–∫–∏–Ω—É –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤",
            "–Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Ç–∞–∫—Å–∏", "–ø–ª–∞—á—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏", "–ø–ª–∞—á—É –≤—Ä–µ–º—è",
            "gsm-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "gsm —Ç–µ–ª–µ—Ñ–æ–Ω–∏—è", "–º–æ—â–Ω—ã–π –¥–æ–∑–≤–æ–Ω", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–≤–æ–Ω–∫–æ–≤",
            "–Ω–æ–º–µ—Ä–∞ –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞–ª–∏—á–∏–∏", "–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7", "–∞–≤—Ç–æ–∑–∞–º–µ–Ω–∞ –Ω–æ–º–µ—Ä–æ–≤",
            "–∑–≤–æ–Ω–∫–∏ –ø–∞–¥–∞—é—Ç", "–ø–æ—Å—Ç–∞–≤—â–∏–∫ –ø–æ–¥–≤–µ–ª", "–ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∏–µ–π",
            "–¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è —Å –∞–≤—Ç–æ", "–∫–æ—Ä–æ—Ç–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã", "–¥–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É",
            "–±—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏", "–∞–∫—Ç—É–∞–ª—å–Ω—ã –±—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏", "–Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã",
            
            # –°–ø–∞–º –∏ —Ä–µ–∫–ª–∞–º–∞
            "–∏–Ω–≤–∞–π—Ç", "—Ä–∞—Å—Å—ã–ª–∫–∞", "–ø–∞—Ä—Å–∏–Ω–≥", "–±–æ—Ç—ã ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è", 
            "–¥–∏–∑–∞–π–Ω ‚Äî –≥—Ä–∞—Ñ–∏–∫–∞", "–Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –Ω–∞–∫—Ä—É—Ç–æ–∫", "–Ω–∞–∫—Ä—É—Ç–∫–∞",
            "–ø–∏—à–∏: @", "–∫–æ–Ω—Ç–∞–∫—Ç—ã: @", "–∫–æ–Ω—Ç–∞–∫—Ç: @", "–ø–∏—à–∏ –≤ –ª—Å", "–ø–∏—à–∏—Ç–µ –≤ –ª—Å",
            "–ø–∏—à–∏—Ç–µ: @", "–ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è", "–ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –ø–∏—à–∏—Ç–µ",
            "–ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –≤ –ª—Å", "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å", "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫—É",
            "–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", "–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å", "–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç",
            "–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", "–ø–∏—Å–∞—Ç—å –≤ –ª—Å", "–ø–∏—Å–∞—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç",
            "–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", "–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª—Å", "–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç",
            "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å", "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫—É", "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç",
            
            # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–ø–∞–º–µ)
            "—Å—Ç—Ä–æ–≥–æ –æ—Ç 18", "–æ—Ç 18 –ª–µ—Ç", "–¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18", "—Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç",
            "—Ç–æ–ª—å–∫–æ –æ—Ç 18", "–Ω–µ –¥–æ—Å—Ç–∏–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞", "–∫—Ç–æ –Ω–µ –¥–æ—Å—Ç–∏–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞",
            
            # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–ø–∞–º-–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
            "–¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫", "–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫", "—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫",
            "–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞", "–º–µ–Ω–µ–¥–∂–µ—Ä –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞",
            "–≤–µ–¥–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞", "–º–µ–Ω–µ–¥–∂–µ—Ä –ª–∫", "–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ª–∫",
            "–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞", "—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏", "–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏",
            "–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏", "–Ω—É–∂–Ω–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞", "–Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏",
            "–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞", "–¥–∏–∑–∞–π–Ω–µ—Ä —Ç–æ–≤–∞—Ä–∞",
            
            # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
            "üî§üî§üî§üî§", "üá∑üá∫", "üá∫üá∏", "üá™üá∫", "üí≥", "üí∏", "üí∞", "ü§ë",
            
            # –ù–∞—Ä–∫–æ—Ç–∏–∫–∏ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞
            "–ø–æ–Ω–∏–∫–∞", "–≤–¥–æ–≤–∞ –≥–æ–ª–æ–≤—ã", "–±–æ–ª–∏–≤–∏—è", "–ø–µ—Ä–≤—ã–π", "–≥–∞—Ä–∞–Ω—Ç–∏—è —Å—å–µ–º–∞",
            "–Ω–µ–¥–æ—Ä–æ–≥–æ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π", "–æ—Ç–∑—ã–≤—ã –∏ –≥–∞—Ä–∞–Ω—Ç–∏—è", "–ø–∏—à–∏—Ç–µüòâ", "–µ—â—ë –µ—Å—Ç—å",
            "–Ω–∞—Ä–∫–æ—Ç–∏–∫", "–≤–µ—â–µ—Å—Ç–≤–æ", "—Ç—Ä–∞–≤–∞", "–º–∞—Ä–∏—Ö—É–∞–Ω–∞", "–∫–æ–∫–∞–∏–Ω", "–≥–µ—Ä–æ–∏–Ω",
            "–∞–º—Ñ–µ—Ç–∞–º–∏–Ω", "—ç–∫—Å—Ç–∞–∑–∏", "–ª—Å–¥", "–º–µ—Ñ–µ–¥—Ä–æ–Ω", "—Å–æ–ª—å", "—Å–ø–∞–π—Å", "–º–∏–∫—Å",
            "–≥–∞—à–∏—à", "–∞–Ω–∞—à–∞", "–ø–ª–∞–Ω", "–¥—Ä–æ–≤–∞", "–¥—É—Ä—å", "–¥—É—Ä–º–∞–Ω", "—à–∏—à–∫–∏",
            "—Å–æ—Ä—Ç", "–≥–∏–¥—Ä–æ–ø–æ–Ω–∏–∫–∞", "—Å–∫—É–Ω—Å", "–¥–∂–∞", "—Ç—Ä–∞–≤–∫–∞", "–∑–µ–ª–µ–Ω—å"
        ]

        for keyword in spam_keywords:
            if keyword in text_lower:
                # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å —Å–ø–∞–º-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
                # –†–∞—Å—à–∏—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç
                exchange_exceptions = ["–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞", "–¥–µ–Ω—å–≥–∏", "üí∞", "üíµ", "üí∏", "ü§ë"]
                if is_exchange_message and keyword in exchange_exceptions:
                    logger.info(f"‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ —Å–ø–∞–º-—Å–ª–æ–≤–æ '{keyword}', –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                    continue
                logger.info(f"‚ùå –ù–∞–π–¥–µ–Ω–æ —Å–ø–∞–º-—Å–ª–æ–≤–æ: {keyword}")
                return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã
        if re.search(r'(.)\1{4,}', message_text):
            logger.info("‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã")
            return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ URL (—Ç–æ–ª—å–∫–æ —è–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏, –Ω–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è @username)
        # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å URL (—ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
        is_exchange_message = bool(re.search(r'(–∫—É–ø–ª—é|–ø—Ä–æ–¥–∞–º|–æ–±–º–µ–Ω—è—é|–æ–±–º–µ–Ω|–º–µ–Ω—è—é).{0,100}(usdt|usdc|—Ç–µ–∑–µ—Ä|–∫—Ä–∏–ø—Ç|–¥–æ–ª–ª–∞—Ä|–µ–≤—Ä–æ|—Ä—É–±–ª|–Ω–∞–ª|–Ω–∞–ª–∏—á–∫)', text_lower, re.IGNORECASE))
        
        # –ë–ª–æ–∫–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —è–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (http://, https://, t.me/), –Ω–æ –Ω–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è @username
        if re.search(r'https?://\S+|t\.me/\S+', message_text):
            # –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –ï—Å–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º (—Å—Å—ã–ª–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
            if is_exchange_message:
                logger.info("‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã URL, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            else:
                logger.info("‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã URL –∏–ª–∏ —Å—Å—ã–ª–∫–∏")
                return True
        # –£–ø–æ–º–∏–Ω–∞–Ω–∏—è @username –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
        
        # –≠—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏, —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞" + "–Ω–µ –¥–æ—Ä–æ–≥–æ" + "–≤ –ª—Å" = —Å–ø–∞–º
        if re.search(r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?', text_lower, re.IGNORECASE):
            if (re.search(r'(–Ω–µ\s+–¥–æ—Ä–æ–≥–æ|–Ω–µ–¥–æ—Ä–æ–≥–æ|—Ä–∞–±–æ—Ç—ã\s+–º–Ω–æ–≥–æ\s+–Ω–µ\s+–¥–æ—Ä–æ–≥–æ)', text_lower, re.IGNORECASE) and 
                re.search(r'(–≤\s+–ª—Å|–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.*–≤\s+–ª—Å|—Ü–µ–Ω—ã.*–≤\s+–ª—Å)', text_lower, re.IGNORECASE)):
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ + –Ω–µ –¥–æ—Ä–æ–≥–æ + –≤ –ª—Å): {message_text[:100]}...")
                return True
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ" + "–Ω–µ –¥–æ—Ä–æ–≥–æ" + "–≤ –ª—Å" = —Å–ø–∞–º
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', text_lower, re.IGNORECASE):
            if (re.search(r'(–Ω–µ\s+–¥–æ—Ä–æ–≥–æ|–Ω–µ–¥–æ—Ä–æ–≥–æ|—Ä–∞–±–æ—Ç—ã\s+–º–Ω–æ–≥–æ)', text_lower, re.IGNORECASE) and 
                re.search(r'(–≤\s+–ª—Å|–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.*–≤\s+–ª—Å|—Ü–µ–Ω—ã.*–≤\s+–ª—Å)', text_lower, re.IGNORECASE)):
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –Ω–µ –¥–æ—Ä–æ–≥–æ + –≤ –ª—Å): {message_text[:100]}...")
            return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        suspicious_patterns = [
            # –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú: –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            r'–±–∞–∑[–∞—ã].*–ø–∞—Å–ø–æ—Ä—Ç–Ω',      # –ë–∞–∑—ã —Å –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            r'–ø–∞—Å–ø–æ—Ä—Ç–Ω.*–¥–∞–Ω–Ω',         # –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            r'–æ–ø—Ç–æ–≤–∞—è.*–ø—Ä–æ–¥–∞–∂–∞.*—Ä–∞–±–æ—Ç', # –û–ø—Ç–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã
            r'—Å\s+–∏–Ω–Ω',                # –° –ò–ù–ù
            r'–≤—ã–±–æ—Ä–∫–∏.*–æ–ø–µ—Ä–∞—Ç–æ—Ä',      # –í—ã–±–æ—Ä–∫–∏ –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º
            r'–≤—ã–±–æ—Ä–∫–∏.*–±–∞–Ω–∫',          # –í—ã–±–æ—Ä–∫–∏ –ë–ê–ù–ö–û–í
            r'–¥–ª—è\s+–ø–æ–∫—É–ø–∫–∏.*–ø—Ä–æ–≤–µ—Ä–∫–∏.*–ø–∏—à–∏—Ç–µ',  # –î–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ
            r'–¥–ª—è\s+–ø–æ–∫—É–ø–∫–∏.*–ø–∏—à–∏—Ç–µ',  # –î–ª—è –ø–æ–∫—É–ø–∫–∏ –ø–∏—à–∏—Ç–µ
            r'–¥–ª—è\s+–ø—Ä–æ–≤–µ—Ä–∫–∏.*–ø–∏—à–∏—Ç–µ', # –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—à–∏—Ç–µ
            
            # –°–ü–ê–ú: –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø–∞—Å–ø–æ—Ä—Ç–∞, ID, –í–ù–ñ (–ö—Ä–∏–º–∏–Ω–∞–ª)
            r'–æ—Ç—Ä–∏—Å–æ–≤–∫–∞.*–¥–æ–∫—É–º–µ–Ω—Ç', r'—Ñ–æ—Ç–æ—à–æ–ø.*—É—Å–ª—É–≥', r'–¥–µ–ª–∞–µ–º.*–ø–∞—Å–ø–æ—Ä—Ç–∞', 
            r'id\s+–∫–∞—Ä—Ç—ã', r'–∂–∏–≤—ã–º–∏\s+—à—Ç–∞–º–ø–∞–º–∏', r'–≥–æ–ª–æ–≥—Ä–∞–º–º', r'–ø—Ä–∞–≤–∞.*–¥–æ–∫—É–º–µ–Ω—Ç—ã',
            r'—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º.*pdf', r'–≤–Ω–∂.*–ø–∞—Å–ø–æ—Ä—Ç', r'—á–µ—Ä–Ω—ã–π.*—Å–ø–∏—Å–æ–∫',
            r'–ø–µ—á–∞—Ç–∞–µ–º.*–¥–æ–∫—É–º–µ–Ω—Ç—ã', r'—Å–∫–∏–¥–∫–∞.*–Ω–∞.*–ø–µ—Ä–≤—ã–π.*–∑–∞–∫–∞–∑', # —á–∞—Å—Ç–æ —É —Å–ø–∞–º–µ—Ä–æ–≤
            
            # –°–ü–ê–ú: IP-—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è, VoIP, –ö–æ–ª–ª-—Ü–µ–Ω—Ç—Ä—ã
            r'ip[- ]—Ç–µ–ª–µ—Ñ–æ–Ω–∏—è', r'sip[- ]—Ç—Ä–∞–Ω–∫–∏–Ω–≥', r'did\s+–Ω–æ–º–µ—Ä–∞', 
            r'caller\s+id', r'–∫–æ–ª–ª[- ]—Ü–µ–Ω—Ç—Ä', r'–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.*–±–∏–ª–ª–∏–Ω–≥–æ–º',
            r'–º–∞—Å—Å–æ–≤–∞—è.*sms', r'sms.*—Ä–∞—Å—Å—ã–ª–∫–∞', r'voip', r'–æ–±–ª–∞—á–Ω–∞—è\s+–∞—Ç—Å',
            
            # –°–ü–ê–ú: –õ–∏–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∏–Ω–≤–∞–π—Ç–∏–Ω–≥
            r'–∏—â–µ—Ç–µ\s+–∫–ª–∏–µ–Ω—Ç–æ–≤', r'–ø–æ–∏—Å–∫\s+–∫–ª–∏–µ–Ω—Ç–æ–≤\s+–≤\s+—á–∞—Ç', 
            r'–ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å\s+–±–æ–ª—å—à–µ\s+–∫–ª–∏–µ–Ω—Ç–æ–≤', r'–Ω—É–∂–Ω—ã\s+–∫–ª–∏–µ–Ω—Ç—ã',
            r'—Ä–∞—Å—Å—ã–ª–∫[–∞–∏]\s+–≤\s+–ª—Å', r'–∏–Ω–≤–∞–π—Ç–∏–Ω–≥', r'–ø–∞—Ä—Å–∏–Ω–≥',
            r'–±–∞–∑[–∞—ã]\s+–∫–ª–∏–µ–Ω—Ç–æ–≤', r'—Å–±–æ—Ä\s+–∞—É–¥–∏—Ç–æ—Ä–∏–∏', r'–ø–æ–ª–Ω—ã–π\s+–æ—Ç—á—ë—Ç\s+–ø–æ\s+—ç—Ç–∞–ø—É',
            
            # –°–ü–ê–ú: –•–∞–∫–µ—Ä—Å—Ç–≤–æ –∏ —Ä–∞–∑–±–∞–Ω (Instagram Recovery)
            r'recover.*account', r'b@nned', r'unban', r'—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤', 
            r'–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏[–µ—è].*–¥–æ—Å—Ç—É–ø', r'–≤–∑–ª–æ–º', r'hack', 
            r'instagram.*support', r'meta.*support', r'copyright.*strikes',
            
            # –†–µ–∫–ª–∞–º–∞ –∫–∞–Ω–∞–ª–æ–≤ —Å "–±–∏–∑–Ω–µ—Å –∏–¥–µ—è–º–∏"
            r'–Ω–µ\s+–Ω—É–∂–Ω–æ\s+–±—ã—Ç—å\s+–≥–µ–Ω–∏–µ–º', r'–±–∏–∑–Ω–µ—Å[- ]–∏–¥–µ–∏', r'–ª—É—á—à–∏–µ\s+–∏–∑\s+–Ω–∏—Ö\s+–≤\s+@',
            
            # –°–ü–ê–ú: –ö—Ä–∏–ø—Ç–∞ (–ø–æ–∫—É–ø–∫–∞ —Å–∫–∞–º-–º–æ–Ω–µ—Ç/–æ–±–º–µ–Ω –≤–Ω–µ —Ä–∞–∑–¥–µ–ª–æ–≤)
            r'–∫—É–ø–ª—é.*trx', r'–∫—É–ø–ª—é.*eth', r'–∫—É–ø–ª—é.*ton', 
            r'–≤—ã–≥–æ–¥–Ω–æ–º—É\s+–∫—É—Ä—Å—É.*–ø–∏—à–∏—Ç–µ', r'jessep2p',

            # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞–∑–æ–π–ª–∏–≤—ã—Ö –±–æ—Ç–æ–≤ –ø–æ –∏—Ö –ø–æ–¥–ø–∏—Å—è–º (BaliForumRuBot, MyBaliTrips –∏ –¥—Ä.)
            r'–≤–∞—à\s+–±–æ—Ç—è',
            r'—Å\s+–ª—é–±–æ–≤—å—é\s+–∏\s+–∑–∞–±–æ—Ç–æ–π',
            r'mybalitrips',
            r'baliforum\.ru',
            r'–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–µ\s+–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.*–æ—Å—Ç—Ä–æ–≤',
            
            # –°–ü–ê–ú: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ (–∏–∑ –≤–∞—à–∏—Ö –ª–æ–≥–æ–≤)
            r'–∏—â–µ—Ç–µ\s+–∫–ª–∏–µ–Ω—Ç–æ–≤\s+–≤\s+—Ç–µ–ª–µ–≥—Ä–∞–º', r'–ø–æ–º–æ—â—å\s+–ø–æ\s+–ø–æ–∏—Å–∫—É\s+–∫–ª–∏–µ–Ω—Ç–æ–≤',
            r'—Ä—ã–Ω–∫–µ\s+—Ä–µ–∫–ª–∞–º–Ω—ã—Ö\s+—É—Å–ª—É–≥', r'–Ω–∞—á–Ω–∏—Ç–µ\s+–ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å\s+–±–æ–ª—å—à–µ',
            
            # --- –ù–û–í–´–ï –ü–ê–¢–¢–ï–†–ù–´ –ò–ó –õ–û–ì–û–í ---
            
            # –°–ü–ê–ú: –ß–µ–∫–∏, –ù–î–°, –£–ü–î (–ê–Ω–∞—Ç–æ–ª–∏–π) - —É–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
            r'—á–µ–∫–∏.*–¥–æ–∫—É–º–µ–Ω—Ç', r'–Ω—É–∂–Ω—ã\s+—á–µ–∫–∏', r'–∞—Ä—Ö–∏–≤–Ω—ã–µ\s+—á–µ–∫–∏', 
            r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*—É–ø–¥', r'–ø–∞–∫–µ—Ç.*–¥–æ–∫—É–º–µ–Ω—Ç.*–Ω–∞–∫–ª–∞–¥–Ω', 
            r'—É–ø–¥.*–Ω–∞–∫–ª–∞–¥–Ω', r'–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏[—è–∏].*–Ω–∞–ª–æ–≥', r'—Å\s+–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å',
            r'–Ω–¥—Å.*–±–µ–∑\s+–Ω–¥—Å', r'–±–µ–∑–Ω–∞–ª–∏—á–Ω.*–æ–ø–ª–∞—Ç', r'–æ—Å–æ–±—ã–µ\s+—É—Å–ª–æ–≤–∏—è.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', 
            
            # –°–ü–ê–ú: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/–°—Ç—Ä–æ–π–∫–∞ (–ò–≤–∞–Ω ProPlan)
            r'—Ü–∏–∫–ª\s+–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', r'–∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö\s+—Ä–∞—Å—á[—ë–µ]—Ç–æ–≤', r'—Ä–∞–±–æ—á–∏—Ö\s+—á–µ—Ä—Ç–µ–∂–µ–π',
            r'–ø—Ä–æ–µ–∫—Ç–Ω.*—É—Å–ª—É–≥', r'—Ä–∞–∑–¥–µ–ª\s+–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', # –†–µ–∫–ª–∞–º–∞ —Ñ–æ—Ä—É–º–∞
            
            # –°–ü–ê–ú: –†–∞–±–æ—Ç–∞ "–ù—É–∂–Ω—ã –±–∞–±–∫–∏" / TikTok
            r'–Ω—É–∂–Ω—ã\s+–±–∞–±–∫–∏', r'–¥–æ—Å—Ç–∞–≤–∫–∞\s+–∑–∞–∫–∞–∑–æ–≤.*–ø–µ—à–∫–æ–º', r'—Å–≤—è–∑—å\s+@', # –ö–æ—Ä–æ—Ç–∫–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ —Ä–∞–±–æ—Ç–µ
            r'–ø—Ä–æ–≤–æ–¥–∏—Ç—å\s+–ª–∞–π–≤—ã', r'—Ñ–æ—Ä–º–∞—Ç–µ\s+tiktok', r'—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è\s+–æ–ø–ª–∞—Ç–∞',
            
            # –°–ü–ê–ú: –†–µ–∫–ª–∞–º–∞ –∫–∞–Ω–∞–ª–æ–≤/–±–æ—Ç–æ–≤ (Ask AI, BaliForum)
            r'–∑–∞–¥–∞–π—Ç–µ\s+–º–Ω–µ\s+–ª—é–±–æ–π\s+–≤–æ–ø—Ä–æ—Å', r'—è\s+–ø–æ–Ω–∏–º–∞—é\s+—Ä–∞–∑–Ω—ã–µ\s+—è–∑—ã–∫–∏', # Ask AI
            r'–∫—Ä–∞—Ç–∫–æ\s+–∏\s+–ø–æ–ª–µ–∑–Ω–æ', r'—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\s+–±–∞–ª–∏—Ñ–æ—Ä—É–º–∞', r'–Ω–∞—Ä–æ–¥–Ω–∞—è\s+–∫–∞—Ä—Ç–∞',
            r'–ª—É—á—à–∏–µ\s+—Å—Ç—Ä–∞—Ö–æ–≤–∫–∏', r'–Ω–∞—à\s+—á–∞—Ç\s+–∑–Ω–∞–∫–æ–º—Å—Ç–≤', r'premium\s+—Ä–µ–∫–ª–∞–º–∞',
            
            # –°–ü–ê–ú: –†–µ–∫–ª–∞–º–∞ —á–∞—Ç–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª (–±–æ—Ç—ã-–∏–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä—ã)
            r'–Ω–∞—à\s+—á–∞—Ç\s+–ø–ª–æ—â–∞–¥–∫', r'—á–∞—Ç–∞.*–ø—Ä–∞–≤–∏–ª', r'–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è\s+—Å\s+–ø—Ä–∞–≤–∏–ª–∞–º–∏',
            r'–ø—Ä–∞–≤–∏–ª–∞–º–∏\s+—á–∞—Ç–∞', r'–±–æ—Ç.*–ø–æ–º–æ—â–Ω–∏–∫', r'–±–æ—Ç.*–ø—Ä–∞–≤–∏–ª', r'–≤—ã–∑–≤–∞—Ç—å\s+–±–æ—Ç–∏–∫–∞',
            r'–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å\s+–ø—É–±–ª–∏–∫–∞—Ü–∏—é', r'–ø—Ä–æ–≤–µ—Ä–∏—Ç—å\s+—Å—Ç–∞—Ç—É—Å\s+–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π',
            r'–ø–ª–∞—Ç–Ω—ã–µ\s+–ø–∞–∫–µ—Ç—ã', r'–ø—É–±–ª–∏–∫–∞—Ü–∏—è.*–±–µ–∑\s+–æ–ø–ª–∞—Ç', r'—É—Å–ª–æ–∂–Ω—è—é—â–∏–µ.*–º–æ—à–µ–Ω–Ω–∏–∫',
            # ----------------------------------------------------------------
            
            r'–±—ã—Å—Ç—Ä–æ–µ\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.*–∑–∞–∫–∞–∑',  # –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            r'—Ä–∞–∑—É–º–Ω—ã–µ\s+—Ü–µ–Ω—ã',        # –†–∞–∑—É–º–Ω—ã–µ —Ü–µ–Ω—ã
            r'–¥–ª—è\s+–ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö\s+–∫–ª–∏–µ–Ω—Ç',  # –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
            r'–ø—Ä–æ–¥–∞–º.*–±–∞–∑',            # –ü—Ä–æ–¥–∞–º –±–∞–∑—É/–±–∞–∑—ã
            r'–ø—Ä–æ–¥–∞–∂–∞.*–±–∞–∑',           # –ü—Ä–æ–¥–∞–∂–∞ –±–∞–∑
            r'–±–∞–∑–∞.*–¥–∞–Ω–Ω.*—Ä—Ñ',         # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –†–§
            r'–±–∞–∑[–∞—ã].*–¥–∞–Ω–Ω',          # –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            # –£–õ–£–ß–®–ï–ù–ù–´–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–ø–∞–º–∞ –ø—Ä–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω[–∞—ã]?\s+(—Ä—Ñ|—Ä–±|–∫–∑)',  # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –†–§/–†–ë/–ö–ó
            r'–ø—Ä–µ–¥–ª–∞–≥[–∞—é–µ–º].*–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω',  # –ü—Ä–µ–¥–ª–∞–≥–∞—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            r'—Ñ–∏–∑[—ã—ã]',                 # –§–∏–∑—ã (—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞)
            r'–≤—ã–≥—Ä—É–∑–∫[–∞–∏].*–±–∞–∑',        # –í—ã–≥—Ä—É–∑–∫–∞ –±–∞–∑
            r'–≤—ã–≥—Ä—É–∑–∫[–∞–∏].*–∫–æ–ª–ª',       # –í—ã–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–æ–≤
            r'—Ç–µ—Å—Ç[—ã—ã].*–±–∞–∑',           # –¢–µ—Å—Ç—ã –±–∞–∑
            r'–∑–∞–º–µ–Ω[–∞—É].*–±–∞–∑',          # –ó–∞–º–µ–Ω–∞ –±–∞–∑
            r'–ø–æ–ª–Ω–æ–µ\s+–Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\s+–±–∞–∑',  # –ü–æ–ª–Ω–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑
            r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*–∏–Ω—Ç–µ—Ä–Ω–µ—Ç.*–º–∞–≥–∞–∑–∏–Ω',  # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–≤
            r'–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω.*—Ç–µ–ª–µ.*–º–∞–≥–∞–∑–∏–Ω',  # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–µ–º–∞–≥–∞–∑–∏–Ω–æ–≤
            r'–≤—ã–±–æ—Ä–∫[–∞–∏].*–ø–æ\s+(–≤–æ–∑—Ä–∞—Å—Ç—É|—Ä–µ–≥–∏–æ–Ω—É|–ø–æ–ª—É)',  # –í—ã–±–æ—Ä–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É/—Ä–µ–≥–∏–æ–Ω—É/–ø–æ–ª—É
            r'–≤\s+–Ω–∞–ª–∏—á–∏–∏.*–±–∞–∑[–∞—ã]?\s+–¥–∞–Ω–Ω',  # –í –Ω–∞–ª–∏—á–∏–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
            r'–æ–≥—Ä–æ–º–Ω[–æ–µ]?\s+–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.*—Å—Ç—Ä–æ–∫',  # –û–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
            r'—é–∑–∞–Ω–Ω[—ã–π–æ–≥–æ]?\s+–º–∞—Ç–µ—Ä–∏–∞–ª',  # –Æ–∑–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª
            r'–ø–æ\s+–≤—Å–µ–º\s+–≤–æ–ø—Ä–æ—Å–∞–º\s+–≤\s+–ª–∏—á–∫—É',  # –ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –≤ –ª–∏—á–∫—É
            
            r'–ø—Ä–æ–¥–∞–º.*–ª–∫.*sberbank',  # –ü—Ä–æ–¥–∞–º –õ–ö Sberbank
            r'–ø—Ä–æ–¥–∞–º.*–∫–∞—Ä—Ç—É.*–≥–æ—Ä–æ–¥',   # –ü—Ä–æ–¥–∞–º –∫–∞—Ä—Ç—É –≤ –≥–æ—Ä–æ–¥
            r'–ø–ª–∞—Å—Ç–∏–∫.*–∫–∞—Ä—Ç–∞.*–≥–æ—Ä–æ–¥',  # –ü–ª–∞—Å—Ç–∏–∫ –∫–∞—Ä—Ç–∞ –≤ –≥–æ—Ä–æ–¥
            r'üî§üî§üî§üî§',              # –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã
            r'üá∑üá∫.*–ø—Ä–æ–¥–∞–º',           # –§–ª–∞–≥ + –ø—Ä–æ–¥–∞–º
            r'üá∫üá∏.*–ø—Ä–æ–¥–∞–º',           # –§–ª–∞–≥ + –ø—Ä–æ–¥–∞–º
            r'üá™üá∫.*–ø—Ä–æ–¥–∞–º',           # –§–ª–∞–≥ + –ø—Ä–æ–¥–∞–º
            
            # –ù–∞—Ä–∫–æ—Ç–∏–∫–∏ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞
            r'–ø–æ–Ω–∏–∫–∞.*–≤–¥–æ–≤–∞.*–≥–æ–ª–æ–≤—ã',  # –ü–æ–Ω–∏–∫–∞ (–≤–¥–æ–≤–∞ –≥–æ–ª–æ–≤—ã)
            r'–±–æ–ª–∏–≤–∏—è.*–ø–µ—Ä–≤—ã–π',        # –ë–æ–ª–∏–≤–∏—è –ø–µ—Ä–≤—ã–π
            r'–≥–∞—Ä–∞–Ω—Ç–∏—è.*—Å—å–µ–º–∞',        # –ì–∞—Ä–∞–Ω—Ç–∏—è —Å—å–µ–º–∞
            r'–Ω–µ–¥–æ—Ä–æ–≥–æ.*–¥–æ—Å—Ç–∞–≤–∫–∞',     # –ù–µ–¥–æ—Ä–æ–≥–æ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π
            r'–æ—Ç–∑—ã–≤—ã.*–≥–∞—Ä–∞–Ω—Ç–∏—è',       # –û—Ç–∑—ã–≤—ã –∏ –≥–∞—Ä–∞–Ω—Ç–∏—è
            r'–ø–∏—à–∏—Ç–µüòâ',               # –ü–∏—à–∏—Ç–µ —Å —ç–º–æ–¥–∑–∏
            r'–µ—â—ë.*–µ—Å—Ç—å',              # –ï—â—ë –µ—Å—Ç—å
            r'–¥–æ—Å—Ç–∞–≤–∫–∞.*–Ω–∞—Ä–∫–æ—Ç–∏–∫',     # –î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞—Ä–∫–æ—Ç–∏–∫–æ–≤
            r'–ø—Ä–æ–¥–∞–º.*–≤–µ—â–µ—Å—Ç–≤–æ',       # –ü—Ä–æ–¥–∞–º –≤–µ—â–µ—Å—Ç–≤–æ
            r'—Å–æ—Ä—Ç.*–∫–∞—á–µ—Å—Ç–≤–æ',         # –°–æ—Ä—Ç –∫–∞—á–µ—Å—Ç–≤–∞
            r'–≥–∏–¥—Ä–æ–ø–æ–Ω–∏–∫–∞',            # –ì–∏–¥—Ä–æ–ø–æ–Ω–∏–∫–∞
            r'—Å–∫—É–Ω—Å.*—Å–æ—Ä—Ç',            # –°–∫—É–Ω—Å —Å–æ—Ä—Ç
            
            # –°–ø–∞–º-–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ (–±–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫',     # –î–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ / –¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*–∫–∞—Ä—Ç–æ—á–µ–∫',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è/–ø–æ –∫–∞—Ä—Ç–æ—á–µ–∫
            r'–∏—â—É.*–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫',  # –ò—â—É –¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
            r'–Ω—É–∂–µ–Ω.*–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫',  # –ù—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*(–¥–ª—è|–ø–æ).*–≤–µ–¥–µ–Ω–∏—è.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∫',           # –ú–µ–Ω–µ–¥–∂–µ—Ä –õ–ö
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*(–¥–ª—è|–ø–æ).*–ª–∫',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è/–ø–æ –õ–ö
            r'–≤–µ–¥–µ–Ω–∏–µ.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',  # –í–µ–¥–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
            r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫.*(–¥–ª—è|–ø–æ).*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',  # –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É
            r'–ø–æ–º–æ—â—å.*(–ø–æ|—Å).*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',  # –ü–æ–º–æ—â—å –ø–æ/—Å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',   # –î–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è/–ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏
            r'–Ω—É–∂–Ω–∞.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',      # –ù—É–∂–Ω–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞
            r'–Ω—É–∂–µ–Ω.*–¥–∏–∑–∞–π–Ω–µ—Ä.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',  # –ù—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*—Ç–æ–≤–∞—Ä',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è/–ø–æ —Ç–æ–≤–∞—Ä–∞
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*–º–æ–µ–≥–æ.*—Ç–æ–≤–∞—Ä',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*–æ—Ñ–æ—Ä–º–ª–µ–Ω.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*—Å–æ–∑–¥–∞–Ω.*–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*(–¥–ª—è|–ø–æ).*—Å–æ–∑–¥–∞–Ω.*–∫–∞—Ä—Ç–æ—á–µ–∫',  # –î–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*(–¥–ª—è|–ø–æ).*–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*(–¥–ª—è|–ø–æ).*—Ä–∞–±–æ—Ç.*(ozon|wb|wildberries)',  # –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ozon/WB
            
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑ (–≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ø–∞–º–∞)
            r'–æ–ø–ª–∞—á—É.*—Å—Ä–∞–∑—É.*–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*–ª—Å',  # –û–ø–ª–∞—á—É —Å—Ä–∞–∑—É, –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å
            r'–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω',        # –û–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω
            r'–æ–ø—ã—Ç.*–Ω–µ.*—Ç—Ä–µ–±—É–µ—Ç—Å—è',    # –û–ø—ã—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
            r'–±–µ–∑.*–æ–ø—ã—Ç–∞',             # –ë–µ–∑ –æ–ø—ã—Ç–∞
            r'–æ–±—É—á—É.*–Ω–∞—É—á—É',           # –û–±—É—á—É –∏ –Ω–∞—É—á—É
            r'—Å—Ç—Ä–æ–≥–æ.*–æ—Ç.*18',         # –°—Ç—Ä–æ–≥–æ –æ—Ç 18
            r'–¥–æ—Å—Ç–∏–≥—à–∏–µ.*—Å—Ç–∞—Ä—à–µ.*18',  # –î–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18
            r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è.*–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è',  # –û–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            r'–ø–∏—Å–∞—Ç—å.*–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è',  # –ü–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            r'–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è.*–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è',  # –û—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*–ª—Å',        # –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å
            r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*–ª–∏—á–∫—É',     # –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫—É
            r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*–¥–∏—Ä–µ–∫—Ç',    # –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç
            
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏: –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã
            r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä|–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫).*(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞|–æ–±—É—á—É|–Ω–∞—É—á—É|–Ω–∞.*–æ–ø—ã—Ç.*–Ω–µ.*—Å–º–æ—Ç—Ä—é)',  # –î–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω
            r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä|–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫).*(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–Ω–∞–ø–∏—à–∏—Ç–µ).*(–ª—Å|–ª–∏—á–Ω—ã–µ|–¥–∏—Ä–µ–∫—Ç|–ª–∏—á–Ω—ã–µ.*—Å–æ–æ–±—â–µ–Ω–∏—è)',  # –î–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä|–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫).*(—Å—Ç—Ä–æ–≥–æ.*–æ—Ç.*18|–¥–æ—Å—Ç–∏–≥—à–∏–µ.*18|—Å—Ç–∞—Ä—à–µ.*18)',  # –î–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –æ—Ç 18
            r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞).*(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä).*(–∫–∞—Ä—Ç–æ—á–µ–∫|–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫|–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç|–ª–∫)',  # –ò—â—É/–Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è...
            r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä).*(–∫–∞—Ä—Ç–æ—á–µ–∫|–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫|–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç|–ª–∫).*(–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω|–±–µ–∑.*–æ–ø—ã—Ç–∞)',  # –î–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –∫–∞—Ä—Ç–æ—á–µ–∫/–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ + –æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω
            r'(–¥–∏–∑–∞–π–Ω–µ—Ä|–º–µ–Ω–µ–¥–∂–µ—Ä).*(–∫–∞—Ä—Ç–æ—á–µ–∫|–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫|–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç|–ª–∫).*(–æ–±—Ä–∞—â–∞—Ç—å—Å—è|–ø–∏—Å–∞—Ç—å|–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è|–≤.*–ª—Å|–≤.*–ª–∏—á–Ω—ã–µ)',  # –î–∏–∑–∞–π–Ω–µ—Ä/–º–µ–Ω–µ–¥–∂–µ—Ä + –∫–∞—Ä—Ç–æ—á–µ–∫/–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ + –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª—Å
            
            # –°–ø–∞–º –ø—Ä–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—É —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è
            r'–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ',  # –ò—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ
            r'–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è.*—Ä–∞–±–æ—Ç–∞.*—Ç–µ–ª–µ—Ñ–æ–Ω',  # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'—Ä–∞–±–æ—Ç–∞\s+—Å\s+—Ç–µ–ª–µ—Ñ–æ–Ω[–æ–º]?',  # –†–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'–Ω–∏–∫—É–¥–∞\s+—Ö–æ–¥–∏—Ç—å\s+–Ω–µ\s+–Ω–∞–¥–æ',  # –ù–∏–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å –Ω–µ –Ω–∞–¥–æ
            r'–±–µ–∑\s+–≤–ª–æ–∂–µ–Ω–∏–π.*—Ä–∞–±–æ—Ç–∞',  # –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞
            r'—Å—Ä–æ—á–Ω–æ\s+–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª',  # –°—Ä–æ—á–Ω–æ –∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
        ]
        
        for pattern in suspicious_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.info(f"‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: {pattern}")
                return True

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ñ–ª–∞–≥–æ–≤
        flag_count = text_lower.count('üá∑üá∫') + text_lower.count('üá∫üá∏') + text_lower.count('üá™üá∫')
        if flag_count > 1:
            logger.info(f"‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ñ–ª–∞–≥–æ–≤: {flag_count}")
            return True

        return False

    async def handle_source_message(self, message_text: str, chat_title: str = None, message_link: str = None, sender_username: str = None):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —á–∞—Ç–∞"""
        if not message_text:
            return

        # –õ–æ–≥–∏—Ä—É–µ–º, –æ—Ç –∫–æ–≥–æ –ø—Ä–∏—à–ª–æ (–ø–æ–º–æ–∂–µ—Ç –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –Ω–æ–≤—ã—Ö –±–æ—Ç–æ–≤)
        logger.info(f"üì• –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑: {chat_title}. –û—Ç: {sender_username}")
        logger.info(f"üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è: {message_text[:100]}...")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º (–¢–ï–ü–ï–†–¨ –ü–ï–†–ï–î–ê–ï–ú sender_username!)
        if self.is_spam_message(message_text, sender_username=sender_username):
            logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–∞–º: {message_text[:100]}...")
            return

        # –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –î–ï–î–£–ü–õ–ò–ö–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –ª–∏ –º—ã —É–∂–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ (–∏–∑ –ª—é–±–æ–≥–æ —á–∞—Ç–∞)
        if self._is_global_duplicate_text(message_text):
            logger.info(f"üîÑ –°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ (–≥–ª–æ–±–∞–ª—å–Ω—ã–π –¥—É–±–ª–∏–∫–∞—Ç –ø–æ —Ç–µ–∫—Å—Ç—É), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            return

        # Create a unique message identifier (–¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∫—ç—à–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º)
        message_id = f"{chat_title}:{message_text}"
        
        # Check if we've already processed this message
        if message_id in self.message_cache:
            logger.info(f"üîÑ –°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –±—ã–ª–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ä–∞–Ω–µ–µ: {message_id}")
            return
            
        # Initialize cache for this message
        self.message_cache[message_id] = set()
        
        # Keep only last 1000 messages in cache to prevent memory issues
        if len(self.message_cache) > 1000:
            # Remove oldest message
            oldest_key = next(iter(self.message_cache))
            del self.message_cache[oldest_key]
            logger.info(f"üßπ –£–¥–∞–ª–µ–Ω–æ —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –∫—ç—à–∞: {oldest_key}")

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç—Ä–∞–Ω—É —á–∞—Ç–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
        chat_country = None
        if chat_title:
            chat_country = self._get_country_from_chat_title(chat_title)
            if chat_country:
                logger.info(f"üåç –°—Ç—Ä–∞–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞ '{chat_title}': {chat_country}")
        
        # For each niche, send to subscribers who haven't received this message yet
        for niche in NICHES_KEYWORDS.keys():
            subscribers = await self.db.get_subscribers_for_niche(niche, country=chat_country)
            logger.info(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—à–∏ '{niche}': –Ω–∞–π–¥–µ–Ω–æ {len(subscribers)} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤" + (f" –¥–ª—è —Å—Ç—Ä–∞–Ω—ã '{chat_country}'" if chat_country else ""))
            
            notification = (
                f"üîî –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –Ω–∏—à–µ <b>{niche}</b>:\n\n"
                f"üí¨ –ß–∞—Ç: {chat_title or '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —á–∞—Ç'}\n\n"
                f"üìù –°–æ–æ–±—â–µ–Ω–∏–µ:\n{message_text}\n\n"
            )
            if message_link:
                notification += f"üîó –°—Å—ã–ª–∫–∞: {message_link}"
                
            # –°–æ–∑–¥–∞–µ–º —Ö–µ—à —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (sender_id –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º 0)
            message_hash = self._create_message_hash(message_text, 0)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É (–µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º –∏–ª–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)
            if self._is_message_globally_blocked(message_hash):
                logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_hash} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∏–∫–æ–º—É")
                continue
            
            for subscriber_id in subscribers:
                # Skip if subscriber already received this message
                if subscriber_id in self.message_cache[message_id]:
                    logger.info(f"‚è≠Ô∏è –ü—Ä–æ–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫—É {subscriber_id} (—É–∂–µ –ø–æ–ª—É—á–∏–ª)")
                    continue
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª –ª–∏ —ç—Ç–æ—Ç message_id –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if self._is_message_marked_as_not_relevant(message_hash, str(subscriber_id)):
                    logger.info(f"üö´ –ü—Ä–æ–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è {message_hash} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {subscriber_id} (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ)")
                    continue
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å—ã–ª–∫–∏)
                if self._is_message_globally_blocked(message_hash):
                    logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_hash} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å—ã–ª–∫–∏, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É")
                    break
                    
                try:
                    await self.bot.send_message(
                        subscriber_id,
                        notification,
                        parse_mode="HTML"
                    )
                    # Mark subscriber as having received this message
                    self.message_cache[message_id].add(subscriber_id)
                    logger.info(f"‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–¥–ø–∏—Å—á–∏–∫—É {subscriber_id}")
                except Exception as e:
                    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å—á–∏–∫—É {subscriber_id}: {e}")

    async def update_user_keywords(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        users = await self.db.get_all_users()
        for user in users:
            self.user_keywords[user['user_id']] = await self.db.get_user_keywords(user['user_id'])

    def should_monitor_message(self, message: Message) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω—É–∂–Ω–æ –ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        """
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –Ω—É–∂–Ω–æ–≥–æ —á–∞—Ç–∞
        if not message.chat.username or message.chat.username.lower() not in [chat.lower() for chat in self.listening_chats]:
            return False
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö
        if message.from_user and message.from_user.username and message.from_user.username.lower() in [user.lower() for user in self.disallowed_users]:
            return False
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
        if message.text:
            message_lower = message.text.lower()
            for keyword in self.disallowed_keywords:
                if re.search(keyword, message_lower, re.IGNORECASE):
                    return False
                    
        return True
    
    async def find_matching_users(self, message: Message) -> Set[int]:
        """–ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"""
        matching_users = set()
        
        if not message.text:
            return matching_users
            
        text_lower = message.text.lower()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        for user_id, keywords in self.user_keywords.items():
            for category, words in keywords.items():
                if any(word.lower() in text_lower for word in words):
                    matching_users.add(user_id)
                    break
        
        return matching_users

    async def send_notification(self, user_id: int, message: Message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        settings = self.user_settings.get(user_id, {})
        frequency = settings.get("notification_frequency", "instant")
        
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_niches = await self.db.get_user_niches(user_id)
        niches_text = "\n\nüéØ –í–∞—à–∏ –ø–æ–¥–ø–∏—Å–∫–∏: " + (", ".join(user_niches) if user_niches else "–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫")
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        formatted_message = (
            f"üì® –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:\n\n"
            f"{message.text}\n"
            f"{niches_text}\n\n"
            f"üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /settings –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
        )
        
        if frequency == "instant":
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
            await self.bot.send_message(user_id, formatted_message)
        else:
            # –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ—á–µ—Ä–µ–¥—å
            self.message_queue[user_id].append(formatted_message)
            
            # –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥–∏, –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            if len(self.message_queue[user_id]) == 1:
                if frequency == "daily":
                    await self.schedule_daily_digest(user_id)
                elif frequency == "weekly":
                    await self.schedule_weekly_digest(user_id)

    async def handle_message(self, message: Message):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"""
        if not self.should_monitor_message(message):
            return
            
        # –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        matching_users = await self.find_matching_users(message)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        for user_id in matching_users:
            await self.send_notification(user_id, message)

    async def initialize(self):
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ –∏—Ö –Ω–∏—à–∏ –∏–∑ –±–∞–∑—ã"""
        logger.info("=== –ù–∞—á–∞–ª–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∞ ===")
        logger.info("–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ –∏—Ö –Ω–∏—à...")
        users = await self.db.get_all_users()
        for user in users:
            user_id = user['user_id']
            niches = await self.db.get_user_niches(user_id)
            self.subscribers[user_id] = set(niches)
        logger.info(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.subscribers)} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤")
        await self.update_user_data()
        await self.update_user_keywords()
        logger.info("=== –ú–æ–Ω–∏—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω ===")

    async def get_status(self) -> dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∞"""
        return {
            "active_subscribers": len(self.subscribers),
            "monitored_topics": list(self.topic_keywords.keys()),
            "active_patterns": len(self.patterns),
            "message_cache_size": len(self.message_cache),
            "is_initialized": bool(self.subscribers)
        }

    async def start(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"""
        logger.info("=== –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ===")
        # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        await self.update_user_data()
        # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        asyncio.create_task(self.update_user_keywords())
        logger.info("=== –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω ===")

    async def update_subscribers(self):
        """–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∏ –∏—Ö –Ω–∏—à–∏ –∏–∑ –±–∞–∑—ã (–º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏)"""
        await self.initialize() 

    async def process_message_from_subscriber(self, message_text: str, chat_title: str = None, message_link: str = None, sender_username: str = None, sender_id: int = None, sender_first_name: str = None, sender_last_name: str = None, chat_id: int = None):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –æ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–∞"""
        if not message_text:
            logger.warning("‚ùå –ü—É—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            return

        logger.info("=== –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è ===")
        logger.info(f"üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è: {message_text[:100]}...")
        logger.info(f"üí¨ –ß–∞—Ç: {chat_title} (ID: {chat_id})")
        logger.info(f"üë§ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: {sender_username} (ID: {sender_id})")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
        if sender_id and self._is_sender_blocked(sender_id):
            logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è {sender_id}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
            return

        # –ü–†–ò–û–†–ò–¢–ï–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –î–û –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ (–û–°–õ–ê–ë–õ–ï–ù–ù–ê–Ø - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º)
        logger.info(f"üîç [–®–ê–ì 1] –ù–∞—á–∏–Ω–∞—é –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Å–ø–∞–º (–æ—Å–ª–∞–±–ª–µ–Ω–Ω–∞—è - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º) –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è: {message_text[:100]}...")
        spam_check_result = self.is_critical_spam_only(message_text)
        logger.info(f"üîç [–®–ê–ì 1] –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º: {spam_check_result}")
        if spam_check_result:
            logger.warning(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): {message_text[:100]}...")
            return
        logger.info(f"‚úÖ [–®–ê–ì 1] –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∞–º, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É (AI –ø—Ä–æ–≤–µ—Ä–∏—Ç –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ–∑–∂–µ)")
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ø–∞–º-—Ñ—Ä–∞–∑—ã (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞)
        import re
        # –£–±–∏—Ä–∞–µ–º markdown –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π
        text_clean_md = re.sub(r'\*+', '', message_text)  # –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏
        text_clean_md = re.sub(r'_+', '', text_clean_md)  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
        text_clean_md = re.sub(r'`+', '', text_clean_md)  # –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        text_lower = text_clean_md.lower()
        text_clean = re.sub(r'[^\w\s]', ' ', text_lower)
        text_clean = re.sub(r'\s+', ' ', text_clean).strip()
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE) and re.search(r'(—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18|–æ—Ç\s+18\s+–ª–µ—Ç|–±–µ—Ä–µ–º\s+—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å + –æ—Ç 18): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞" + "–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?', text_lower, re.IGNORECASE):
            if re.search(r'–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', text_lower, re.IGNORECASE) and re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞ + –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞" + "–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?', text_lower, re.IGNORECASE):
            if re.search(r'–Ω–∞\s+–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π\s+–æ—Å–Ω–æ–≤–µ', text_lower, re.IGNORECASE) and re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ + –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "—Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" + –Ω–∏–∑–∫–∞—è –æ–ø–ª–∞—Ç–∞ = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'—Ç–µ—Å—Ç–æ–≤[–æ–µ]?\s+–∑–∞–¥–∞–Ω–∏[–µ—è]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ–ø–ª–∞—Ç–∞\s+–∑–∞\s+—Å–ª–∞–π–¥|–æ–ø–ª–∞—Ç–∞\s+\d+\s+—Ä|300\s+—Ä)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å + –Ω–∏–∑–∫–∞—è –æ–ø–ª–∞—Ç–∞): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É" + "–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—Å–∞—Ç—å –≤ –ª—Å" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–∏—â—É\s+–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª—Å|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–Ω—ã–µ)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—Å–∞—Ç—å –≤ –ª—Å): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—à–∏—Ç–µ" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–Ω—É–∂–µ–Ω\s+–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—à–∏—Ç–µ|–ø–∏—Å–∞—Ç—å|–Ω–∞–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ—Ç\s+18\s+–ª–µ—Ç|—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18|–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞|–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—à–∏—Ç–µ + –æ—Ç 18): {message_text[:100]}...")
                return
        
        # –°–¢–†–û–ì–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏" + "–ø–∏—à–∏—Ç–µ" + "–æ—Ç 18" = –±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£
        if re.search(r'–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', text_lower, re.IGNORECASE):
            if re.search(r'(–ø–∏—à–∏—Ç–µ|–ø–∏—Å–∞—Ç—å|–Ω–∞–ø–∏—à–∏—Ç–µ)', text_lower, re.IGNORECASE) and re.search(r'(–æ—Ç\s+18\s+–ª–µ—Ç|—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18|–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞|–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞)', text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ + –ø–∏—à–∏—Ç–µ + –æ—Ç 18): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –∑–≤–µ–∑–¥—ã (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        stars_spam_patterns = [
            r'–∫–æ–º—É\s+–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–Ω—É–∂–Ω—ã\s+–∑–≤–µ–∑–¥—ã', r'–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç',
            r'–∑–∞\s+\d+\s+–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞', r'–ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ\s+—á–µ–ª–æ–≤–µ–∫–∞',
            r'–∑–≤–µ–∑–¥—ã\s+–ø–∏—à–∏—Ç–µ', r'–∑–≤–µ–∑–¥—ã\s+–≤\s+–ª—Å', r'–ø–∏—à–∏—Ç–µ\s+–º–Ω–µ\s+–≤\s+–ª—Å.*–∑–≤–µ–∑–¥—ã',
            r'–∑–≤–µ–∑–¥.*–≤\s+–ª—Å', r'–∑–≤–µ–∑–¥—ã.*–≤\s+–±–æ—Ç–µ', r'–≤\s+–±–æ—Ç–µ\s+–¥–∞—é—Ç.*–∑–≤–µ–∑–¥',
        ]
        for pattern in stars_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∑–≤–µ–∑–¥—ã): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –ø—Ä–æ–≤–µ—Ä–∫—É/–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        verification_spam_patterns = [
            r'–Ω–µ\s+–ø—Ä–æ—à–ª–∏\s+–ø—Ä–æ–≤–µ—Ä–∫—É', r'–Ω–µ\s+–ø—Ä–æ—à—ë–ª\s+–ø—Ä–æ–≤–µ—Ä–∫—É', r'–Ω–µ\s+–ø—Ä–æ—à–ª–∞\s+–ø—Ä–æ–≤–µ—Ä–∫—É',
            r'–Ω–µ\s+–ø—Ä–æ—à–ª–∏\s+–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é', r'–Ω–µ\s+–ø—Ä–æ—à—ë–ª\s+–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é', r'–Ω–µ\s+–ø—Ä–æ—à–ª–∞\s+–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é',
            r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É\s+–≤\s+–ª—Å', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É.*–ª—Å', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É.*start',
            r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–±–æ—Ç—É.*/start', r'–±–æ—Ç—É\s+–≤\s+–ª—Å.*start', r'–±–æ—Ç—É.*–ª—Å.*start',
            r'–¥–ª—è\s+–ø–æ–ª—É—á–µ–Ω–∏—è\s+–¥–æ—Å—Ç—É–ø–∞', r'–ø–æ–ª—É—á–µ–Ω–∏—è\s+–¥–æ—Å—Ç—É–ø–∞', r'–¥–ª—è\s+–¥–æ—Å—Ç—É–ø–∞',
            r'—Ä–µ—à–∏—Ç–µ\s+—ç—Ç—É\s+–∫–∞–ø—á—É', r'—Ä–µ—à–∏—Ç–µ\s+–∫–∞–ø—á—É', r'–ø—Ä–æ–π–¥–∏—Ç–µ\s+–∫–∞–ø—á—É',
            r'–ø—Ä–æ–π–¥–∏—Ç–µ\s+–ø—Ä–æ–≤–µ—Ä–∫—É', r'–ø—Ä–æ–π–¥–∏—Ç–µ\s+–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é',
        ]
        for pattern in verification_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞/–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –æ–±–º–µ–Ω –≤–∞–ª—é—Ç (—Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–Ω–∏–∫–æ–≤)
        exchange_spam_patterns = [
            (r'(prestige|cashfriends|–æ–±–º–µ–Ω–Ω–∏–∫|–æ–±–º–µ–Ω.*–≤–∞–ª—é—Ç).*(–ø–æ–º–æ–∂–µ—Ç|–ø–æ–º–æ–≥—É|–≥–æ—Ç–æ–≤—ã.*–ø–æ–º–æ—á—å)', r'(–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ|–±–µ–∑–æ–ø–∞—Å–Ω–æ|–±—ã—Å—Ç—Ä–æ|–Ω–∞–¥—ë–∂–Ω–æ)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–Ω–∞–º)'),
            (r'–ø–æ–º–æ–∂–µ—Ç\s+—Å\s+–æ–±–º–µ–Ω–æ–º', r'(–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ|–±–µ–∑–æ–ø–∞—Å–Ω–æ)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–Ω–∞–º)'),
            (r'–≥–æ—Ç–æ–≤—ã\s+–ø–æ–º–æ—á—å\s+—Å\s+–æ–±–º–µ–Ω–æ–º', r'(–±—ã—Å—Ç—Ä–æ|–Ω–∞–¥—ë–∂–Ω–æ)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏|–ø–∏—à–∏—Ç–µ).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–Ω–∞–º)'),
        ]
        for pattern_combo in exchange_spam_patterns:
            matches = sum(1 for pattern in pattern_combo if re.search(pattern, text_lower, re.IGNORECASE))
            if matches >= 2:  # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ 2 –∏–∑ 3 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–Ω–∏–∫–∞): {message_text[:100]}...")
                return
        
        # –ü—Ä–æ—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∫–ª–∞–º—ã –æ–±–º–µ–Ω–Ω–∏–∫–æ–≤
        simple_exchange_spam = [
            r'prestige.*–ø–æ–º–æ–∂–µ—Ç.*–æ–±–º–µ–Ω–æ–º.*–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ.*–Ω–∞–ø–∏—à–∏—Ç–µ',
            r'cashfriends.*–≥–æ—Ç–æ–≤—ã.*–æ–±–º–µ–Ω–æ–º.*–Ω–∞–ø–∏—à–∏—Ç–µ',
            r'–ø–æ–º–æ–∂–µ—Ç\s+—Å\s+–æ–±–º–µ–Ω–æ–º.*–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ.*–±–µ–∑–æ–ø–∞—Å–Ω–æ.*–Ω–∞–ø–∏—à–∏—Ç–µ\s+–Ω–∞–º',
        ]
        for pattern in simple_exchange_spam:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ä–µ–∫–ª–∞–º–∞ –æ–±–º–µ–Ω–Ω–∏–∫–∞): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—É —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        simple_tasks_spam_check = [
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è
            r'–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ',  # –ò—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ
            r'–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è.*—Ä–∞–±–æ—Ç–∞.*—Ç–µ–ª–µ—Ñ–æ–Ω',  # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'—Ä–∞–±–æ—Ç–∞\s+—Å\s+—Ç–µ–ª–µ—Ñ–æ–Ω[–æ–º]?',  # –†–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'–Ω–∏–∫—É–¥–∞\s+—Ö–æ–¥–∏—Ç—å\s+–Ω–µ\s+–Ω–∞–¥–æ',  # –ù–∏–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å –Ω–µ –Ω–∞–¥–æ
            r'–±–µ–∑\s+–≤–ª–æ–∂–µ–Ω–∏–π.*—Ä–∞–±–æ—Ç–∞',  # –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞
            r'—Å—Ä–æ—á–Ω–æ\s+–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª',  # –°—Ä–æ—á–Ω–æ –∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
            r'–∑–∞–Ω—è—Ç–∏–µ\s+–Ω–∞\s+–ø–∞—Ä—É\s+—á–∞—Å–æ–≤',  # –ó–∞–Ω—è—Ç–∏–µ –Ω–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤
            r'–∑–∞\s+–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ\s+–∫–∞–∂–¥–æ–º—É',  # –ó–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É
            r'–∫–æ–º—É\s+–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ\s+–ø–∏—à–∏—Ç–µ',  # –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—à–∏—Ç–µ (—á–∞—Å—Ç–æ –≤ —Å–ø–∞–º–µ –ø—Ä–æ —Ä–∞–±–æ—Ç—É)
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É –Ω–∞ WB/–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wildberries',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ Wildberries
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–¥–ª—è\s+wb',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è WB
            r'–∏—â—É\s+–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb',  # –ò—â—É –ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB
            r'–∏—â—É\s+–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–¥–ª—è\s+wb',  # –ò—â—É –ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è WB
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+wb\s+–±–µ–∑\s+–æ–ø—ã—Ç',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ WB –±–µ–∑ –æ–ø—ã—Ç–∞
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+wb\s+–±–µ–∑\s+–æ—Ç–ø—ã—Ç',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ WB –±–µ–∑ –æ—Ç–ø—ã—Ç–∞
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb.*–±–µ–∑\s+–æ–ø—ã—Ç',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB –±–µ–∑ –æ–ø—ã—Ç–∞
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb.*–±–µ–∑\s+–æ—Ç–ø—ã—Ç',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB –±–µ–∑ –æ—Ç–ø—ã—Ç–∞
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb.*–æ–±—É—á—É',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB –æ–±—É—á—É
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb.*–∑–ø',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB –ó–ü
            r'–ø–æ–º–æ—â–Ω–∏–∫[–∞–µ—ã]?\s+–Ω–∞\s+wb.*–∑–∞—Ä–ø–ª–∞—Ç',  # –ü–æ–º–æ—â–Ω–∏–∫–∞ –Ω–∞ WB –∑–∞—Ä–ø–ª–∞—Ç–∞
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É —Å –§–ù–°/–ú–í–î/–≥–æ—Å–æ—Ä–≥–∞–Ω–∞–º–∏ (–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ)
            r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫\s+—Ñ–Ω—Å',  # –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –§–ù–°
            r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫\s+–º–≤–¥',  # –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ú–í–î
            r'—Å–æ—Ç—Ä—É–¥–Ω–∏–∫\s+–≥–æ—Å–æ—Ä–≥–∞–Ω',  # –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –≥–æ—Å–æ—Ä–≥–∞–Ω–∞
            r'—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+—Å–æ—Ç—Ä—É–¥–Ω–∏–∫\s+—Ñ–Ω—Å',  # –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –§–ù–°
            r'—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+—Å–æ—Ç—Ä—É–¥–Ω–∏–∫\s+–º–≤–¥',  # –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –ú–í–î
            r'–¥–ª—è\s+–ø—Ä–æ–≤–µ—Ä–∫–∏.*—Ü–µ–ø[–µ–π]?.*—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏[–π—è]?.*–≤–µ—Ç–æ–∫.*–Ω–¥—Å',  # –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤–µ—Ç–æ–∫ –Ω–¥—Å
            r'–ø—Ä–æ–≤–µ—Ä–∫[–∞–∏—ã]?\s+—Ü–µ–ø[–µ–π]?.*—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏[–π—è]?.*–≤–µ—Ç–æ–∫.*–Ω–¥—Å',  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–µ–π –Ω–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤–µ—Ç–æ–∫ –Ω–¥—Å
            # –°–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π + "–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è"
            r'—Ä–∞–±–æ—Ç–∞\s+—Å\s+–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫[–∞]?\s+–ø–æ\s+–ø—è—Ç–Ω–∏—Ü[—É—ã]?',  # –†–∞–±–æ—Ç–∞ —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü—É
            r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*–ø—è—Ç–Ω–∏—Ü.*–∑–∞—Ä–ø–ª–∞—Ç',  # –†–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞ –∑–∞—Ä–ø–ª–∞—Ç–∞
            r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*–ø—è—Ç–Ω–∏—Ü.*–∑–ø',  # –†–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞ –ó–ü
            r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*–ø—è—Ç–Ω–∏—Ü.*–Ω–∞–ø–∏—à–∏—Ç–µ\s+–º–Ω–µ\s+–≤\s+–ª–∏—á–Ω—ã–µ',  # –†–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–Ω—ã–µ
            r'—Ä–∞–±–æ—Ç–∞.*–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.*–ø—è—Ç–Ω–∏—Ü.*–∑–∞\s+–¥–æ–ø.*–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏[–µ–π—é]?.*–Ω–∞–ø–∏—à–∏—Ç–µ',  # –†–∞–±–æ—Ç–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞ –∑–∞ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –Ω–∞–ø–∏—à–∏—Ç–µ
        ]
        for pattern in simple_tasks_spam_check:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è/—Ä–∞–±–æ—Ç–∞ –Ω–∞ WB/–§–ù–°): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É/–ø–æ–¥—Ä–∞–±–æ—Ç–∫—É (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        work_spam_check = [
            r'–∫–æ–º—É\s+–∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞\s+—Ä–∞–±–æ—Ç[–∞—ã]?\s+–∏–ª–∏\s+–ø–æ–¥—Ä–∞–±–æ—Ç–∫',  # –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∏–ª–∏ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞
            r'–∫–æ–º—É\s+–∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞\s+–ø–æ–¥—Ä–∞–±–æ—Ç–∫',  # –ö–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞
            r'—Å—Ç–∞–±–∏–ª—å–Ω—ã–π\s+–¥–æ—Ö–æ–¥',  # –°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥
            r'–±–æ–Ω—É—Å\s+–∑–∞\s+—Ö–æ—Ä–æ—à–æ\s+—Å–¥–µ–ª–∞–Ω–Ω—É—é\s+—Ä–∞–±–æ—Ç—É',  # –ë–æ–Ω—É—Å –∑–∞ —Ö–æ—Ä–æ—à–æ —Å–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É
            r'—Ä–∞—Å—Å–∫–∞–∂—É\s+—á—Ç–æ\s+–¥–µ–ª–∞—Ç—å',  # –†–∞—Å—Å–∫–∞–∂—É —á—Ç–æ –¥–µ–ª–∞—Ç—å
            r'–ø–∏—à–∏—Ç–µ\s+–º–Ω–µ\s+–≤\s+–ª–∏—á–∫—É.*—Ä–∞—Å—Å–∫–∞–∂—É',  # –ü–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–∫—É —Ä–∞—Å—Å–∫–∞–∂—É
        ]
        for pattern in work_spam_check:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ä–∞–±–æ—Ç–∞/–ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞): {message_text[:100]}...")
                return
        
        # –ê–ë–°–û–õ–Æ–¢–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø—Ä–æ —Ä–∞–±–æ—Ç—É/–ø–æ–¥—Ä–∞–±–æ—Ç–∫—É (–±–ª–æ–∫–∏—Ä—É–µ–º –°–†–ê–ó–£)
        work_spam_patterns = [
            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Å–ø–∞–º–∞ –ø—Ä–æ —Ä–∞–±–æ—Ç—É
            (r'(–Ω—É–∂–Ω—ã|–∏—â–µ–º|–∏—â—É).*(–ø–æ–º–æ—â–Ω–∏–∫|–ø–æ–º–æ—â–Ω–∏–∫–∏|–ª—é–¥–∏|–ø–µ—Ä—Å–æ–Ω–∞–ª).*(–Ω–∞|–¥–ª—è).*(–ø—Ä–æ—Å—Ç—ã–µ\s+—Ä–∞–±–æ—Ç—ã|—É–±–æ—Ä–∫|—Ä–∞–±–æ—Ç)', r'(—Ä–∞—Å—á—ë—Ç|–æ–ø–ª–∞—Ç–∞).*(—Å—Ä–∞–∑—É|–Ω–∞\s+—Ä—É–∫–∏|–Ω–∞–ª–∏—á–Ω—ã–º–∏)', r'(–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å|–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ|–≥–æ—Ç–æ–≤\s+–ø–∏—à–∏).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É)'),
            (r'(–Ω—É–∂–Ω—ã|–∏—â–µ–º|–∏—â—É).*(–ø–æ–º–æ—â–Ω–∏–∫|–ø–æ–º–æ—â–Ω–∏–∫–∏|–ª—é–¥–∏|–ø–µ—Ä—Å–æ–Ω–∞–ª).*(–Ω–∞|–¥–ª—è).*(–ø—Ä–æ—Å—Ç—ã–µ\s+—Ä–∞–±–æ—Ç—ã|—É–±–æ—Ä–∫|—Ä–∞–±–æ—Ç)', r'(–æ–ø–ª–∞—Ç–∞|—Ä–∞—Å—á—ë—Ç).*\d+[—Ä‚ÇΩ]', r'(–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å|–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ|–≥–æ—Ç–æ–≤\s+–ø–∏—à–∏).*(–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É)'),
            (r'(–∏—â–µ–º|–∏—â—É).*(–ª—é–¥–∏|–ø–µ—Ä—Å–æ–Ω–∞–ª).*(–Ω–∞|–¥–ª—è).*(—É–±–æ—Ä–∫|—Ä–∞–±–æ—Ç)', r'(–æ–ø–ª–∞—Ç–∞|—Ä–∞—Å—á—ë—Ç).*(–Ω–∞\s+—Ä—É–∫–∏|–Ω–∞–ª–∏—á–Ω—ã–º–∏|—Å—Ä–∞–∑—É)', r'(–≥–æ—Ç–æ–≤|–ø–∏—à–∏|–Ω–∞–ø–∏—à–∏—Ç–µ|–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å)'),
            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Å–ø–∞–º–∞ –ø—Ä–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É/ByBit/Binance
            (r'(–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å|–∑–∞—Ä–∞–±–æ—Ç–æ–∫|—Ä–∞–±–æ—Ç–∞).*(—É–¥–∞–ª–µ–Ω–Ω|—É–¥–∞–ª—ë–Ω–Ω)', r'(ByBit|Binance|–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–ø–∏—à–∏—Ç–µ|–Ω–∞–ø–∏—à–∏).*(–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è|–≤\s+–ª—Å|–≤\s+–ª–∏—á–∫—É|\+\s*–≤\s+–ª–∏—á–Ω—ã–µ)'),
            (r'(—Å—Ä–æ—á–Ω–æ\s+—Ç—Ä–µ–±—É–µ—Ç—Å—è|—Ç—Ä–µ–±—É–µ—Ç—Å—è).*(–ø–µ—Ä—Å–æ–Ω–∞–ª|–ª—é–¥–∏).*(—É–¥–∞–ª–µ–Ω–Ω|—É–¥–∞–ª—ë–Ω–Ω)', r'(ByBit|Binance)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–ø–∏—à–∏—Ç–µ|\+).*(–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª—Å)'),
            (r'(–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å\s+–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å|–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å)', r'(—É–¥–∞–ª–µ–Ω–Ω|—É–¥–∞–ª—ë–Ω–Ω).*(–∑–∞–Ω—è—Ç–æ—Å—Ç—å|—Ä–∞–±–æ—Ç–∞)', r'(ByBit|Binance)', r'(–Ω–∞–ø–∏—à–∏—Ç–µ|–ø–∏—à–∏—Ç–µ|\+).*(–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª—Å)'),
        ]
        
        for pattern_combo in work_spam_patterns:
            matches = sum(1 for pattern in pattern_combo if re.search(pattern, text_lower, re.IGNORECASE))
            if matches >= len(pattern_combo) - 1:  # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–ª–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ä–∞–±–æ—Ç–∞/–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞): {message_text[:100]}...")
                return
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
        simple_work_spam = [
            r'–Ω—É–∂–Ω—ã\s+–ø–æ–º–æ—â–Ω–∏–∫–∏\s+–Ω–∞\s+–ø—Ä–æ—Å—Ç—ã–µ\s+—Ä–∞–±–æ—Ç—ã.*—Ä–∞—Å—á—ë—Ç.*—Å—Ä–∞–∑—É.*–æ—Ç–ø–∏—à–∏—Ç–µ—Å—å\s+–≤\s+–ª—Å',
            r'–∏—â–µ–º\s+–ª—é–¥–µ–π.*–Ω–∞\s+—É–±–æ—Ä–∫.*–æ–ø–ª–∞—Ç–∞\s+–Ω–∞\s+—Ä—É–∫–∏.*–≥–æ—Ç–æ–≤\s+–ø–∏—à–∏',
            r'–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å.*—É–¥–∞–ª–µ–Ω–Ω.*ByBit.*–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–Ω—ã–µ',
            r'–ø–æ–¥–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å.*—É–¥–∞–ª–µ–Ω–Ω.*Binance.*–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–Ω—ã–µ',
            r'—Å—Ä–æ—á–Ω–æ\s+—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+–ø–µ—Ä—Å–æ–Ω–∞–ª.*—É–¥–∞–ª–µ–Ω–Ω.*ByBit',
            r'—Å—Ä–æ—á–Ω–æ\s+—Ç—Ä–µ–±—É–µ—Ç—Å—è\s+–ø–µ—Ä—Å–æ–Ω–∞–ª.*—É–¥–∞–ª–µ–Ω–Ω.*Binance',
        ]
        for pattern in simple_work_spam:
            if re.search(pattern, text_lower, re.IGNORECASE):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ä–∞–±–æ—Ç–∞/–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞): {message_text[:100]}...")
                return
        
        critical_spam_phrases = [
            '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫',
            '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞', '–º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞',
            '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫—É –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É',
            '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞', '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞',
            '–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫', '—Å–¥–µ–ª–∞—Ç—å –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫',
            '—Ç–æ–≥–æ –∫—Ç–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫—É', '–∫—Ç–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫—É',
            '–¥–∏–∑–∞–π–Ω–µ—Ä–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ', '–¥–∏–∑–∞–π–Ω–µ—Ä –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ',
        ]
        
        critical_indicators = [
            '–æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –Ω–µ –≤–∞–∂–µ–Ω', '–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω',
            '–æ–±—É—á—É –∏ –Ω–∞—É—á—É', '–≤—Å–µ–º—É –æ–±—É—á—É –∏ –Ω–∞—É—á—É', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –µ—Å—Ç—å –æ–±—É—á–µ–Ω–∏–µ',
            '–æ–±—É—á–∞—é –µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ', '–µ—Å–ª–∏ –Ω–µ —É–º–µ–µ—Ç–µ –æ–±—É—á—É',
            '–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
            '–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è', '–Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
            '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç', '–≤ –¥–∏—Ä–µ–∫—Ç',
            '–æ–ø–ª–∞—Ç–∞ —Ö–æ—Ä–æ—à–∞—è', '–æ–ø–ª–∞—Ç–∞ –µ—Å—Ç—å', '–æ–ø–ª–∞—Ç–∞ –¥–æ—Å—Ç–æ–π–Ω–∞—è',
            '–æ–ø–ª–∞—á—É —Å—Ä–∞–∑—É', '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª—Å', '–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ –ª–∏—á–∫–µ',
            '–æ—Ç 18 –ª–µ—Ç', '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç',
            '—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–∏—Ü–∞ –¥–æ—Å—Ç–∏–≥—à–∏–µ', '–¥–æ—Å—Ç–∏–≥—à–∏–µ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç',
            '–∫–æ–º—É –Ω—É–∂–Ω—ã –∑–≤–µ–∑–¥—ã', '–≤ –±–æ—Ç–µ –¥–∞—é—Ç', '–∑–∞ 1 –ø—Ä–∏–≥–ª–∞–∂–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞',
            '–Ω–µ –¥–æ—Ä–æ–≥–æ', '–Ω–µ–¥–æ—Ä–æ–≥–æ', '—Ä–∞–±–æ—Ç—ã –º–Ω–æ–≥–æ –Ω–µ –¥–æ—Ä–æ–≥–æ',
            '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏ –≤–∞—à–∏ —Ü–µ–Ω—ã –≤ –ª—Å', '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –≤ –ª—Å', '—Ü–µ–Ω—ã –≤ –ª—Å',
        ]
        
        found_critical_phrase = False
        found_critical_indicator = False
        
        for phrase in critical_spam_phrases:
            phrase_clean = re.sub(r'[^\w\s]', ' ', phrase.lower())
            phrase_clean = re.sub(r'\s+', ' ', phrase_clean).strip()
            if phrase_clean in text_clean:
                found_critical_phrase = True
                logger.warning(f"‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–ø–∞–º-—Ñ—Ä–∞–∑–∞: '{phrase}'")
                break
        
        for indicator in critical_indicators:
            indicator_clean = re.sub(r'[^\w\s]', ' ', indicator.lower())
            indicator_clean = re.sub(r'\s+', ' ', indicator_clean).strip()
            if indicator_clean in text_clean:
                found_critical_indicator = True
                logger.warning(f"‚ö†Ô∏è –ù–∞–π–¥–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: '{indicator}'")
                break
        
        # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–∑–∞ –ò –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä - –±–ª–æ–∫–∏—Ä—É–µ–º
        if found_critical_phrase and found_critical_indicator:
            logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): {message_text[:100]}...")
            return
        
        # –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û: –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–∑–∞ + –µ—Å—Ç—å "–∏—â—É/–Ω—É–∂–µ–Ω" + –µ—Å—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ - –±–ª–æ–∫–∏—Ä—É–µ–º
        if found_critical_phrase:
            if '–∏—â—É' in text_clean or '–Ω—É–∂–µ–Ω' in text_clean or '–Ω—É–∂–Ω–∞' in text_clean:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤
                suspicious_words = ['–ø–∏—Å–∞—Ç—å', '–æ–±—Ä–∞—â–∞—Ç—å—Å—è', '–≤ –ª–∏—á–Ω—ã–µ', '–≤ –ª—Å', '–≤ –¥–∏—Ä–µ–∫—Ç', '–æ–ø–ª–∞—á—É', '–æ–ø–ª–∞—Ç–∞', '–æ–±—É—á—É', '–Ω–∞—É—á—É', '–æ–ø—ã—Ç –Ω–µ', '–æ—Ç 18', '–¥–æ—Å—Ç–∏–≥—à–∏–µ', '–Ω–µ –¥–æ—Ä–æ–≥–æ', '–Ω–µ–¥–æ—Ä–æ–≥–æ', '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ', '—Ü–µ–Ω—ã –≤ –ª—Å', '–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è', '–∞ —Ç–∞–∫ –∂–µ', '—Ç–∞–∫ –∂–µ –∏—â—É']
                if any(word in text_clean for word in suspicious_words):
                    logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–Ω–∞–π–¥–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–∑–∞ + –∏—â—É/–Ω—É–∂–µ–Ω + –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞): {message_text[:100]}...")
                    return
        
        # –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞: "–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞" + "–Ω–µ –¥–æ—Ä–æ–≥–æ" + "–≤ –ª—Å" = —Å–ø–∞–º
        if '–∏—â—É' in text_clean and '–¥–∏–∑–∞–π–Ω–µ—Ä' in text_clean:
            if ('–Ω–µ –¥–æ—Ä–æ–≥–æ' in text_clean or '–Ω–µ–¥–æ—Ä–æ–≥–æ' in text_clean or '—Ä–∞–±–æ—Ç—ã –º–Ω–æ–≥–æ –Ω–µ –¥–æ—Ä–æ–≥–æ' in text_clean) and ('–≤ –ª—Å' in text_clean or '–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ' in text_clean and '–≤ –ª—Å' in text_clean):
                logger.error(f"üö´üö´üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ü–ê–ú –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù (–∏—â—É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ + –Ω–µ –¥–æ—Ä–æ–≥–æ + –≤ –ª—Å): {message_text[:100]}...")
                return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
        logger.info(f"üîç [–®–ê–ì 2] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç {sender_id}")
        if self._is_duplicate_message(message_text, sender_id):
            logger.info(f"üîÑ [–®–ê–ì 2] –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {sender_id} —É–∂–µ –±—ã–ª–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ä–∞–Ω–µ–µ")
            return
        logger.info(f"‚úÖ [–®–ê–ì 2] –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç–æ–º")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ—Ö–æ–∂–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏—è (–≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
        logger.info(f"üîç [–®–ê–ì 3] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ—Ö–æ–∂–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏—è")
        if self._is_similar_spam_blocked(message_text):
            logger.info(f"üö´ [–®–ê–ì 3] –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∞–º")
            return
        logger.info(f"‚úÖ [–®–ê–ì 3] –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∞–º")

        # –ì–∏–±—Ä–∏–¥–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
        logger.info(f"üîç [–®–ê–ì 4] –ù–∞—á–∏–Ω–∞—é –≥–∏–±—Ä–∏–¥–Ω—É—é –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏—è...")
        classification_result = await self._hybrid_classify_message(message_text, sender_username=sender_username)
        logger.info(f"üîç [–®–ê–ì 4] –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: is_spam={classification_result.get('is_spam', False)}, niches={classification_result.get('niches', [])}, reason={classification_result.get('reason', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞')}, confidence={classification_result.get('confidence', 0)}")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º
        if classification_result.get('is_spam', False):
            logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–∞–º: {classification_result.get('reason', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞')}")
            return

        # –ü–æ–ª—É—á–∞–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∏—à–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        found_niches = set(classification_result.get('niches', []))
        confidence = classification_result.get('confidence', 0)
        reason = classification_result.get('reason', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞')
        message_type = classification_result.get('message_type', '–û–ë–©–ï–ù–ò–ï')
        context = classification_result.get('context', '')
        urgency = classification_result.get('urgency', '–Ω–µ —Å—Ä–æ—á–Ω–æ')
        budget = classification_result.get('budget', '')

        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–∞–º –ø–æ—Å–ª–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Å–ø–∞–º –ø—Ä–æ—à–µ–ª –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é)
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ø–∞–º-—Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ
        # –£–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        import re
        text_clean = re.sub(r'\*+', '', message_text)  # –£–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏
        text_clean = re.sub(r'_+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
        text_clean = re.sub(r'`+', '', text_clean)  # –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        text_lower = text_clean.lower()
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —É—á–µ—Ç–∞ —Ä–∞–∑–Ω—ã—Ö –ø–∞–¥–µ–∂–µ–π
        hard_spam_patterns = [
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–º–æ–µ–≥–æ\s+—Ç–æ–≤–∞—Ä', '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è –º–æ–µ–≥–æ —Ç–æ–≤–∞—Ä–∞'),
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫'),
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∫–∞—Ä—Ç–æ—á–µ–∫', '–¥–∏–∑–∞–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫'),
            (r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∏—á–Ω–æ–≥–æ\s+–∫–∞–±–∏–Ω–µ—Ç–∞', '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞'),
            (r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+–≤–µ–¥–µ–Ω–∏—è\s+–ª–∫', '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–∫'),
            (r'–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫[–∞–∏—ã]?\s+–¥–ª—è\s+–ø–æ–º–æ—â–∏\s+–ø–æ\s+–ª–∏—á–Ω–æ–º—É\s+–∫–∞–±–∏–Ω–µ—Ç—É', '–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∫–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –ø–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É'),
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Å–æ–∑–¥–∞–Ω–∏[—è–µ]\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', '–¥–∏–∑–∞–π–Ω–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏'),
            (r'–¥–∏–∑–∞–π–Ω–µ—Ä[–∞–µ—ã]?\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', '–¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏'),
            (r'–Ω—É–∂–µ–Ω\s+–¥–∏–∑–∞–π–Ω–µ—Ä\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∏—ã]', '–Ω—É–∂–µ–Ω –¥–∏–∑–∞–π–Ω–µ—Ä –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏'),
            (r'–Ω—É–∂–Ω–∞\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–∞–∏—ã]', '–Ω—É–∂–Ω–∞ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞'),
            (r'—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç[–∞–µ—ã]?\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]', '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ'),
            (r'–Ω—É–∂–µ–Ω\s+—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]', '–Ω—É–∂–µ–Ω —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ'),
            (r'–∏—â—É\s+—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç[–∞–µ—ã]?\s+–ø–æ\s+–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫[–µ–∏—ã]', '–∏—â—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–µ'),
            (r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å', '–º–µ–Ω–µ–¥–∂–µ—Ä –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞'),
            (r'–º–µ–Ω–µ–¥–∂–µ—Ä[–∞–µ—ã]?\s+–¥–ª—è\s+—Ä–∞–±–æ—Ç[—ã—ã]?\s+—Å\s+(ozon|wb|wildberries)', '–º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å ozon/wb'),
        ]
        
        # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è)
        suspicious_patterns = [
            r'–æ–ø—ã—Ç\s+–Ω–µ\s+–≤–∞–∂–µ–Ω', r'–±–µ–∑\s+–æ–ø—ã—Ç–∞', r'–Ω–∞\s+–æ–ø—ã—Ç\s+–Ω–µ\s+—Å–º–æ—Ç—Ä—é', r'–æ–ø—ã—Ç\s+—Ä–∞–±–æ—Ç—ã\s+–Ω–µ\s+–≤–∞–∂–µ–Ω', r'–Ω–æ–≤–∏—á–∫–∏\s+–ø–æ–¥–æ–π–¥—É—Ç',
            r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª—Å', r'–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å', r'–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è', r'–æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è',
            r'–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–Ω—ã–µ\s+—Å–æ–æ–±—â–µ–Ω–∏—è',
            r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–∫—É', r'–≤\s+–ª–∏—á–∫—É', r'–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–∫—É', r'–Ω–∞–ø–∏—à–∏—Ç–µ\s+–≤\s+–ª–∏—á–∫—É',
            r'–æ–ø–ª–∞—á—É\s+—Å—Ä–∞–∑—É', r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏\s+–≤\s+–ª—Å',
            r'–æ–±—É—á—É', r'–Ω–∞—É—á—É', r'–µ—Å—Ç—å\s+–æ–±—É—á–µ–Ω–∏–µ', r'–µ—Å–ª–∏\s+–Ω–µ\s+—É–º–µ–µ—Ç–µ\s+–æ–±—É—á—É',
            r'—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18', r'–æ—Ç\s+18\s+–ª–µ—Ç', r'–¥–æ—Å—Ç–∏–≥—à–∏–µ\s+—Å—Ç–∞—Ä—à–µ\s+18', r'—Ç–æ–ª—å–∫–æ\s+–æ—Ç\s+18', 
            r'–∫—Ç–æ\s+–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞', r'–Ω–µ\s+–¥–æ—Å—Ç–∏–≥\s+–≤–æ–∑—Ä–∞—Å—Ç–∞', r'—Å\s+18\s+–ª–µ—Ç',
            r'–±–µ—Ä–µ–º\s+—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18', r'—Å—Ç—Ä–æ–≥–æ\s+–æ—Ç\s+18\s+–ª–µ—Ç', r'—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+18\s+–ª–µ—Ç',
            # –°–ø–∞–º –ø—Ä–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—É —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è',  # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è
            r'–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª[–µ–π—è].*–ø—Ä–æ—Å—Ç—ã–µ',  # –ò—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ
            r'–ø—Ä–æ—Å—Ç—ã–µ.*–∑–∞–¥–∞–Ω–∏—è.*—Ä–∞–±–æ—Ç–∞.*—Ç–µ–ª–µ—Ñ–æ–Ω',  # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'—Ä–∞–±–æ—Ç–∞\s+—Å\s+—Ç–µ–ª–µ—Ñ–æ–Ω[–æ–º]?',  # –†–∞–±–æ—Ç–∞ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
            r'–Ω–∏–∫—É–¥–∞\s+—Ö–æ–¥–∏—Ç—å\s+–Ω–µ\s+–Ω–∞–¥–æ',  # –ù–∏–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å –Ω–µ –Ω–∞–¥–æ
            r'–±–µ–∑\s+–≤–ª–æ–∂–µ–Ω–∏–π.*—Ä–∞–±–æ—Ç–∞',  # –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞
            r'—Å—Ä–æ—á–Ω–æ\s+–∏—â—É\s+–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª',  # –°—Ä–æ—á–Ω–æ –∏—â—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
        ]
        
        for pattern, phrase_name in hard_spam_patterns:
            if re.search(pattern, text_lower, re.IGNORECASE):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                found_suspicious = any(re.search(sp, text_lower, re.IGNORECASE) for sp in suspicious_patterns)
                if found_suspicious:
                    logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–∞–º (–∂–µ—Å—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏): –Ω–∞–π–¥–µ–Ω–∞ —Ñ—Ä–∞–∑–∞ '{phrase_name}' —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º–∏")
                    return
                # –ï—Å–ª–∏ —Ñ—Ä–∞–∑–∞ –Ω–∞–π–¥–µ–Ω–∞, –Ω–æ –Ω–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
                # –ë–ª–æ–∫–∏—Ä—É–µ–º, –µ—Å–ª–∏ –µ—Å—Ç—å "–∏—â—É/–Ω—É–∂–µ–Ω/—Å—Ä–æ—á–Ω–æ –Ω—É–∂–µ–Ω" + —Ñ—Ä–∞–∑–∞
                if re.search(r'(–∏—â—É|–Ω—É–∂–µ–Ω|–Ω—É–∂–Ω–∞|–∏—â–µ–º|—Å—Ä–æ—á–Ω–æ\s+–Ω—É–∂–µ–Ω)', text_lower) and re.search(pattern, text_lower, re.IGNORECASE):
                    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ "–ø–∏—Å–∞—Ç—å –≤ –ª—Å/–ª–∏—á–∫—É" –∏–ª–∏ "–æ—Ç 18"
                    if re.search(r'(–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª—Å|–≤\s+–ª–∏—á–Ω—ã–µ|–≤\s+–ª–∏—á–∫—É|–æ—Ç\s+18|—Å\s+18|–¥–ª—è\s+–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å|—Ä–∞–±–æ—Ç–∞\s+–æ—Ç\s+18)', text_lower, re.IGNORECASE):
                        logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–∞–º (–∂–µ—Å—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è '–∏—â—É/–Ω—É–∂–µ–Ω' + '{phrase_name}' + –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã")
                        return
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å "–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω" + "–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É", –±–ª–æ–∫–∏—Ä—É–µ–º
                if re.search(r'(–æ–ø—ã—Ç\s+–Ω–µ\s+–≤–∞–∂–µ–Ω|–Ω–æ–≤–∏—á–∫–∏\s+–ø–æ–¥–æ–π–¥—É—Ç)', text_lower) and re.search(r'(–æ–±—Ä–∞—â–∞—Ç—å—Å—è\s+–≤\s+–ª–∏—á–∫—É|–≤\s+–ª–∏—á–∫—É|–ø–∏—Å–∞—Ç—å\s+–≤\s+–ª–∏—á–∫—É)', text_lower, re.IGNORECASE):
                    logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Å–ø–∞–º (–∂–µ—Å—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞): –Ω–∞–π–¥–µ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è '{phrase_name}' + '–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω' + '–æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ª–∏—á–∫—É'")
                    return

        if not found_niches:
            logger.info("‚ùå –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–∑–æ—Å–ª–∞–Ω–æ")
            return

        logger.info(f"üìä –ù–∞–π–¥–µ–Ω–æ –Ω–∏—à: {found_niches} (—Ç–∏–ø: {message_type}, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence}%, –ø—Ä–∏—á–∏–Ω–∞: {reason})")
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç—Ä–∞–Ω—É —á–∞—Ç–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
        chat_country = None
        if chat_id:
            chat_country = self._get_chat_country(chat_id)
            logger.info(f"üåç –ß–∞—Ç {chat_id} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ —Å—Ç—Ä–∞–Ω–∞: {chat_country}")
        elif chat_title:
            # –ü—ã—Ç–∞–µ–º—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞–Ω—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞, –µ—Å–ª–∏ chat_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            chat_country = self._get_country_from_chat_title(chat_title)
            if chat_country:
                logger.info(f"üåç –°—Ç—Ä–∞–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞ '{chat_title}': {chat_country}")
        
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à —Å —É—á–µ—Ç–æ–º —Å—Ç—Ä–∞–Ω—ã
        all_subscribers = set()
        for niche in found_niches:
            subscribers = await self.db.get_subscribers_for_niche(niche, country=chat_country)
            logger.info(f"üë• –ù–∞–π–¥–µ–Ω–æ {len(subscribers)} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –¥–ª—è –Ω–∏—à–∏ '{niche}'" + (f" –∏ —Å—Ç—Ä–∞–Ω—ã '{chat_country}'" if chat_country else "") + f": {subscribers}")
            all_subscribers.update(subscribers)
        
        if not all_subscribers:
            logger.info("‚ùå –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–∑–æ—Å–ª–∞–Ω–æ")
            return

        logger.info(f"üë• –í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ {len(all_subscribers)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: {all_subscribers}")
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ
        sender_info = ""
        if sender_first_name or sender_last_name:
            full_name = f"{sender_first_name or ''} {sender_last_name or ''}".strip()
            sender_info = f"üë§ {full_name}"
            if sender_username:
                sender_info += f" (@{sender_username})"
        elif sender_username:
            sender_info = f"üë§ @{sender_username}"
        
        # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫
        message_id = self._create_message_hash(message_text, sender_id or 0)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É (–µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º –∏–ª–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)
        if self._is_message_globally_blocked(message_id):
            logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∏–∫–æ–º—É")
            return
        
        # –†–∞—Å—Å—ã–ª–∫–∞ –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à
        for user_id in all_subscribers:
            try:
                user = await self.db.get_user(user_id)
                if not user:
                    logger.warning(f"‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ")
                    continue

                # –ü–æ–ª—É—á–∞–µ–º –Ω–∏—à–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
                user_niches = await self.db.get_user_niches(user_id)
                logger.info(f"üìã –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–∏—à–∏: {user_niches}")

                # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ï—Å–ª–∏ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∏—à–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è), –∏—Å–ø–æ–ª—å–∑—É–µ–º –¢–û–õ–¨–ö–û –∏—Ö
                # –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–æ —Å–¥–∞—á—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º –Ω–∞ –∞—Ä–µ–Ω–¥—É –∞–≤—Ç–æ/–±–∞–π–∫–æ–≤
                if reason != '–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º' and found_niches:
                    # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è AI, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä–æ–≥–æ - —Ç–æ–ª—å–∫–æ —Ç–µ –Ω–∏—à–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª AI
                    ai_niches_lower = [n.lower() for n in found_niches]
                    user_niches_lower = [n.lower() for n in user_niches]
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏—à–∞–º–∏ AI –∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    ai_user_intersection = set(ai_niches_lower) & set(user_niches_lower)
                    if not ai_user_intersection:
                        logger.info(f"ü§ñ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∏—à–∏ {found_niches}, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–∏—Ö (–ø–æ–¥–ø–∏—Å–∫–∏: {user_niches}), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                        continue
                    else:
                        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω–∏—à AI –∏ –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        common_niches = ai_user_intersection
                        logger.info(f"ü§ñ ‚úÖ AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω–∏—à–∏ {found_niches}, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ {ai_user_intersection}, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º")
                else:
                    # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –Ω–∏—à
                    common_niches = set(n.lower() for n in user_niches) & set(n.lower() for n in found_niches)
                    if not common_niches:
                        logger.info(f"‚ö†Ô∏è –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} –Ω–µ—Ç –æ–±—â–∏—Ö –Ω–∏—à —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_niches}, –Ω–∞–π–¥–µ–Ω–æ: {found_niches})")
                        continue
                    else:
                        logger.info(f"üìã –ù–∞–π–¥–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∏—à –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏: {found_niches}, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ: {common_niches}")
                
                # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è)
                user_countries = await self.db.get_user_countries(user_id)
                logger.info(f"üåç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω—ã: {user_countries}, —á–∞—Ç –∏–∑ —Å—Ç—Ä–∞–Ω—ã: {chat_country}")
                
                # –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω—ã –≤—ã–±—Ä–∞–Ω—ã - —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, –µ—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω—ã - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                if user_countries:
                    # –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–±—Ä–∞–Ω—ã —Å—Ç—Ä–∞–Ω—ã, –Ω–æ —á–∞—Ç –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–æ —Å—Ç—Ä–∞–Ω–∞–º - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
                    # (–Ω–µ –∑–Ω–∞–µ–º, –∏–∑ –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω—ã —á–∞—Ç, –ø–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å, —á–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
                    if not chat_country:
                        logger.info(f"üåç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –≤—ã–±—Ä–∞–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, –Ω–æ —á–∞—Ç {chat_id} –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π")
                        # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É, —Ç–∞–∫ –∫–∞–∫ —Å—Ç—Ä–∞–Ω–∞ —á–∞—Ç–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞
                    else:
                        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É)
                        user_countries_lower = [c.lower().strip() if c else '' for c in user_countries]
                        chat_country_lower = chat_country.lower().strip() if chat_country else ''
                        
                        # –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç—Ä–∞–Ω (–ë–∞–ª–∏ -> bali, –¢–∞–∏–ª–∞–Ω–¥ -> thailand, –¢—É—Ä—Ü–∏—è -> turkey, –ì—Ä—É–∑–∏—è -> georgia)
                        # –ò –æ–±—Ä–∞—Ç–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ (bali -> –ë–∞–ª–∏)
                        country_mapping = {
                            '–±–∞–ª–∏': 'bali',
                            '—Ç–∞–∏–ª–∞–Ω–¥': 'thailand',
                            '—Ç—É—Ä—Ü–∏—è': 'turkey',
                            '–≥—Ä—É–∑–∏—è': 'georgia',
                            'bali': '–±–∞–ª–∏',
                            'thailand': '—Ç–∞–∏–ª–∞–Ω–¥',
                            'turkey': '—Ç—É—Ä—Ü–∏—è',
                            'georgia': '–≥—Ä—É–∑–∏—è'
                        }
                        
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä—è–º–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
                        country_match = False
                        if chat_country_lower in user_countries_lower:
                            country_match = True
                            logger.info(f"üåç –ü—Ä—è–º–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: {chat_country_lower} –Ω–∞–π–¥–µ–Ω–æ –≤ {user_countries_lower}")
                        else:
                            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –º–∞–ø–ø–∏–Ω–≥
                            # –ï—Å–ª–∏ chat_country = "–ë–∞–ª–∏", –∏—â–µ–º "bali" –≤ user_countries
                            if chat_country_lower in country_mapping:
                                mapped_country = country_mapping[chat_country_lower]
                                if mapped_country in user_countries_lower:
                                    country_match = True
                                    logger.info(f"üåç –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞–ø–ø–∏–Ω–≥: {chat_country_lower} -> {mapped_country} –Ω–∞–π–¥–µ–Ω–æ –≤ {user_countries_lower}")
                            
                            # –û–±—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –≤ user_countries –µ—Å—Ç—å "–ë–∞–ª–∏", –∞ chat_country = "bali"
                            for user_country in user_countries_lower:
                                if user_country in country_mapping:
                                    mapped_user_country = country_mapping[user_country]
                                    if mapped_user_country == chat_country_lower:
                                        country_match = True
                                        logger.info(f"üåç –û–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞–ø–ø–∏–Ω–≥: {user_country} -> {mapped_user_country} —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å {chat_country_lower}")
                                        break
                        
                        if not country_match:
                            logger.info(f"üåç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –≤—ã–±—Ä–∞–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, –Ω–æ —á–∞—Ç –∏–∑ {chat_country} –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                            continue
                        else:
                            logger.info(f"üåç ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω—É {chat_country} (—á–∞—Ç –∏–∑ {chat_country}), –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ")
                else:
                    # –°—Ç—Ä–∞–Ω—ã –Ω–µ –≤—ã–±—Ä–∞–Ω—ã - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                    logger.info(f"üåç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –≤—ã–±—Ä–∞–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å—Ç—Ä–∞–Ω–∞–º, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω")

                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª –ª–∏ —ç—Ç–æ—Ç message_id –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if self._is_message_marked_as_not_relevant(message_id, str(user_id)):
                    logger.info(f"üö´ –ü—Ä–æ–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è {message_id} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id} (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ)")
                    continue
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å—ã–ª–∫–∏)
                if self._is_message_globally_blocked(message_id):
                    logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å—ã–ª–∫–∏, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É")
                    return

                # –§–æ—Ä–º–∏—Ä—É–µ–º —É–ª—É—á—à–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–∏—Å–ø–æ–ª—å–∑—É–µ–º HTML –≤–º–µ—Å—Ç–æ Markdown)
                notification = f"üîî <b>–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</b>\n\n"
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
                type_emoji = {
                    "–ü–û–ò–°–ö": "üîç",
                    "–ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï": "üíº", 
                    "–û–ë–©–ï–ù–ò–ï": "üí¨",
                    "–°–ü–ê–ú": "üö´"
                }
                type_emoji_str = type_emoji.get(message_type, "üí¨")
                notification += f"{type_emoji_str} <b>–¢–∏–ø:</b> {self._escape_html(message_type)}\n"
                
                # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∏—à–∏
                niches_str = ', '.join([self._escape_html(niche) for niche in common_niches])
                notification += f"üìÇ <b>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:</b> {niches_str}\n"
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ä–æ—á–Ω–æ—Å—Ç—å –µ—Å–ª–∏ –µ—Å—Ç—å
                if urgency != "–Ω–µ —Å—Ä–æ—á–Ω–æ":
                    notification += f"‚ö° <b>–°—Ä–æ—á–Ω–æ—Å—Ç—å:</b> {self._escape_html(urgency)}\n"
                
                # –î–æ–±–∞–≤–ª—è–µ–º –±—é–¥–∂–µ—Ç –µ—Å–ª–∏ –µ—Å—Ç—å
                if budget:
                    notification += f"üí∞ <b>–ë—é–¥–∂–µ—Ç:</b> {self._escape_html(budget)}\n"
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –µ—Å–ª–∏ –µ—Å—Ç—å
                if context and context != "–û–±—ã—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ":
                    notification += f"üìù <b>–ö–æ–Ω—Ç–µ–∫—Å—Ç:</b> {self._escape_html(context)}\n"
                
                # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã HTML –≤ —Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                escaped_message_text = self._escape_html(message_text)
                notification += f"\nüìÑ <b>–°–æ–æ–±—â–µ–Ω–∏–µ:</b>\n{escaped_message_text}\n\n"
                
                if sender_info:
                    # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º sender_info –µ—Å–ª–∏ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç HTML
                    escaped_sender_info = self._escape_html(sender_info) if sender_info else ""
                    notification += f"{escaped_sender_info}\n\n"
                
                notification += f"üí¨ <b>–ß–∞—Ç:</b> {self._escape_html(chat_title or '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —á–∞—Ç')}"
                
                if message_link:
                    notification += f"\nüîó <b>–°—Å—ã–ª–∫–∞:</b> {message_link}"

                # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
                keyboard = InlineKeyboardMarkup(row_width=2)
                keyboard.add(
                    InlineKeyboardButton("‚úÖ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ", callback_data=f"relevant_{message_id}_{user_id}"),
                    InlineKeyboardButton("‚ùå –ù–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ", callback_data=f"not_relevant_{message_id}_{user_id}")
                )
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –∫–∞–∫ —Å–ø–∞–º (–≤–∫–ª—é—á–∞–µ–º sender_id –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
                sender_id_str = str(sender_id) if sender_id else "0"
                keyboard.add(
                    InlineKeyboardButton("üö´ –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Å–ø–∞–º", callback_data=f"spam_{message_id}_{user_id}_{sender_id_str}")
                )
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
                keyboard.add(
                    InlineKeyboardButton("üîß –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é", callback_data=f"correct_{message_id}_{user_id}")
                )

                try:
                    await self.bot.send_message(
                        user_id, 
                        notification, 
                        parse_mode="HTML",
                        reply_markup=keyboard
                    )
                except Exception as e:
                    # –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML, –ø—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    if "parse" in str(e).lower() or "entity" in str(e).lower() or "html" in str(e).lower():
                        logger.warning(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {e}")
                        # –£–±–∏—Ä–∞–µ–º –≤—Å–µ HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
                        plain_notification = re.sub(r'<[^>]+>', '', notification)  # –£–±–∏—Ä–∞–µ–º –≤—Å–µ HTML —Ç–µ–≥–∏
                        plain_notification = re.sub(r'&lt;', '<', plain_notification)  # –†–∞—Å–∫–æ–¥–∏—Ä—É–µ–º &lt;
                        plain_notification = re.sub(r'&gt;', '>', plain_notification)  # –†–∞—Å–∫–æ–¥–∏—Ä—É–µ–º &gt;
                        plain_notification = re.sub(r'&amp;', '&', plain_notification)  # –†–∞—Å–∫–æ–¥–∏—Ä—É–µ–º &amp;
                        await self.bot.send_message(
                            user_id,
                            plain_notification,
                            parse_mode=None,
                            reply_markup=keyboard
                        )
                    else:
                        raise
                logger.info(f"‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}")
                
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}: {e}")
        
        logger.info("=== –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ===")

    async def cleanup(self):
        """–û—á–∏—â–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã"""
        try:
            # –û—á–∏—â–∞–µ–º –≤—Å–µ –æ—á–µ—Ä–µ–¥–∏ –∏ –∫—ç—à–∏
            self.message_queue.clear()
            self.message_cache.clear()
            self.message_hashes.clear()  # –û—á–∏—â–∞–µ–º —Ö–µ—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
            self.global_message_text_hashes.clear()  # –û—á–∏—â–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ö–µ—à–∏
            self.user_keywords.clear()
            self.topic_keywords.clear()
            self.user_topics.clear()
            self.user_settings.clear()
            self.subscribers.clear()
            
            # –û—á–∏—â–∞–µ–º AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
            if self.ai_classifier:
                self.ai_classifier.clear_cache()
            
            logger.info("‚úÖ –†–µ—Å—É—Ä—Å—ã –º–æ–Ω–∏—Ç–æ—Ä–∞ —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã")
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∞: {e}")

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
    async def handle_relevant_button(self, callback_query: types.CallbackQuery):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ '–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ'"""
        try:
            # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ callback_data
            parts = callback_query.data.split('_')
            if len(parts) >= 3:
                message_id = parts[1]
                user_id = parts[2]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ —Å–≤–æ—é –∫–Ω–æ–ø–∫—É
                if str(callback_query.from_user.id) == user_id:
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    message_text = self._extract_message_text_from_notification(callback_query.message.text)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É
                    await self.save_relevance_feedback(message_id, user_id, True, is_spam=False, message_text=message_text)
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    await callback_query.message.edit_reply_markup(
                        InlineKeyboardMarkup(inline_keyboard=[
                            [InlineKeyboardButton("‚úÖ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)", callback_data="confirmed_relevant")]
                        ])
                    )
                    
                    await callback_query.answer("‚úÖ –°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ —É—á—Ç–µ–Ω–∞")
                    logger.info(f"‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è {message_id}")
                else:
                    await callback_query.answer("‚ùå –≠—Ç–æ –Ω–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                    
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–∫–∏ '–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ': {e}")
            await callback_query.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏")

    async def handle_not_relevant_button(self, callback_query: types.CallbackQuery):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ '–ù–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ'"""
        try:
            # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ callback_data
            parts = callback_query.data.split('_')
            if len(parts) >= 3:
                message_id = parts[1]
                user_id = parts[2]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ —Å–≤–æ—é –∫–Ω–æ–ø–∫—É
                if str(callback_query.from_user.id) == user_id:
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    message_text = self._extract_message_text_from_notification(callback_query.message.text)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É
                    await self.save_relevance_feedback(message_id, user_id, False, is_spam=False, message_text=message_text)
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ
                    is_blocked = self._is_message_globally_blocked(message_id)
                    blocked_text = "\n\nüö´ –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ (–ø—Ä–µ–≤—ã—à–µ–Ω –ø–æ—Ä–æ–≥ –æ—Ç–º–µ—Ç–æ–∫)" if is_blocked else ""
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    await callback_query.message.edit_reply_markup(
                        InlineKeyboardMarkup(inline_keyboard=[
                            [InlineKeyboardButton("‚ùå –ù–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)", callback_data="confirmed_not_relevant")]
                        ])
                    )
                    
                    await callback_query.answer(f"‚úÖ –°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ —É—á—Ç–µ–Ω–∞{blocked_text}")
                    logger.info(f"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –æ—Ç–º–µ—Ç–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ")
                    
                    if is_blocked:
                        logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ –æ—Ç–º–µ—Ç–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º {user_id}")
                else:
                    await callback_query.answer("‚ùå –≠—Ç–æ –Ω–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                    
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–∫–∏ '–ù–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ': {e}")
            await callback_query.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏")

    async def handle_spam_button(self, callback_query: types.CallbackQuery):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ '–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Å–ø–∞–º'"""
        try:
            # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ callback_data: spam_message_id_user_id_sender_id
            parts = callback_query.data.split('_')
            if len(parts) >= 3:
                message_id = parts[1]
                user_id = parts[2]
                sender_id = int(parts[3]) if len(parts) >= 4 and parts[3].isdigit() else None
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ —Å–≤–æ—é –∫–Ω–æ–ø–∫—É
                if str(callback_query.from_user.id) == user_id:
                    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    message_text = self._extract_message_text_from_notification(callback_query.message.text)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ —Å–ø–∞–º (–≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
                    await self.save_relevance_feedback(message_id, user_id, False, is_spam=True, message_text=message_text, sender_id=sender_id)
                    
                    # –ë–ª–æ–∫–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è, –µ—Å–ª–∏ –æ–Ω –∏–∑–≤–µ—Å—Ç–µ–Ω
                    if sender_id:
                        await self._block_sender(sender_id)
                        logger.warning(f"üö´ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å {sender_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ –æ—Ç–º–µ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ —Å–ø–∞–º")
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                    if message_text:
                        spam_patterns = self._extract_spam_patterns(message_text)
                        if spam_patterns:
                            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
                            await self._save_spam_patterns(message_text, spam_patterns)
                            logger.warning(f"üö´ –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö: {spam_patterns[:3]}...")
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    await callback_query.message.edit_reply_markup(
                        InlineKeyboardMarkup(inline_keyboard=[
                            [InlineKeyboardButton("üö´ –û—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ)", callback_data="confirmed_spam")]
                        ])
                    )
                    
                    await callback_query.answer("üö´ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ. –ü–æ—Ö–æ–∂–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∞–∫–∂–µ –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.")
                    logger.warning(f"üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –æ—Ç–º–µ—Ç–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∫–∞–∫ –°–ü–ê–ú (–≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ + –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö)")
                else:
                    await callback_query.answer("‚ùå –≠—Ç–æ –Ω–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                    
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–∫–∏ '–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Å–ø–∞–º': {e}")
            await callback_query.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏")

    async def handle_correct_button(self, callback_query: types.CallbackQuery):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ '–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é'"""
        try:
            # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ callback_data
            parts = callback_query.data.split('_')
            if len(parts) >= 3:
                message_id = parts[1]
                user_id = parts[2]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ —Å–≤–æ—é –∫–Ω–æ–ø–∫—É
                if str(callback_query.from_user.id) == user_id:
                    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
                    await callback_query.message.answer(
                        "üîß **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**\n\n"
                        "–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n"
                        "`—Ç–µ–∫—Å—Ç_—Å–æ–æ–±—â–µ–Ω–∏—è | –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è_–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è`\n\n"
                        "**–ü—Ä–∏–º–µ—Ä:**\n"
                        "`–ò—â—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞ –Ω–∞ —Å–≤–∞–¥—å–±—É | –ü–û–ò–°–ö:–§–æ—Ç–æ–≥—Ä–∞—Ñ:—Å—Ä–æ—á–Ω–æ:500$`\n\n"
                        "**–§–æ—Ä–º–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**\n"
                        "`–¢–ò–ü:–ù–ò–®–ê:–°–†–û–ß–ù–û–°–¢–¨:–ë–Æ–î–ñ–ï–¢`\n\n"
                        "–¢–∏–ø—ã: –ü–û–ò–°–ö, –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï, –û–ë–©–ï–ù–ò–ï, –°–ü–ê–ú\n"
                        "–ù–∏—à–∏: –§–æ—Ç–æ–≥—Ä–∞—Ñ, –í–∏–¥–µ–æ–≥—Ä–∞—Ñ, –∏ —Ç.–¥.\n"
                        "–°—Ä–æ—á–Ω–æ—Å—Ç—å: —Å—Ä–æ—á–Ω–æ/–Ω–µ —Å—Ä–æ—á–Ω–æ\n"
                        "–ë—é–¥–∂–µ—Ç: —Å—É–º–º–∞ –∏–ª–∏ –ø—É—Å—Ç–æ\n\n"
                        "–û—Ç–ø—Ä–∞–≤—å—Ç–µ /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã"
                    )
                    
                    await callback_query.answer("üìù –û–∂–∏–¥–∞—é –≤–∞—à–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...")
                    logger.info(f"üîß –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –∑–∞–ø—Ä–æ—Å–∏–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è {message_id}")
                else:
                    await callback_query.answer("‚ùå –≠—Ç–æ –Ω–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                    
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–∫–∏ '–ò—Å–ø—Ä–∞–≤–∏—Ç—å': {e}")
            await callback_query.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏")

    def _extract_message_text_from_notification(self, notification_text: str) -> str:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        """
        try:
            # –ò—â–µ–º –±–ª–æ–∫ —Å —Ç–µ–∫—Å—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è (–º–µ–∂–¥—É "üìÑ **–°–æ–æ–±—â–µ–Ω–∏–µ:**\n" –∏ —Å–ª–µ–¥—É—é—â–∏–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º)
            if "üìÑ **–°–æ–æ–±—â–µ–Ω–∏–µ:**" in notification_text or "üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ:" in notification_text:
                # –ò—â–µ–º –Ω–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
                start_markers = ["üìÑ **–°–æ–æ–±—â–µ–Ω–∏–µ:**\n", "üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ:\n", "üìÑ **–°–æ–æ–±—â–µ–Ω–∏–µ:**", "üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ:"]
                start_idx = -1
                for marker in start_markers:
                    idx = notification_text.find(marker)
                    if idx != -1:
                        start_idx = idx + len(marker)
                        break
                
                if start_idx != -1:
                    # –ò—â–µ–º –∫–æ–Ω–µ—Ü —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞)
                    end_markers = ["\n\nüë§", "\n\nüí¨", "\n\nüîó", "\nüë§", "\nüí¨", "\nüîó"]
                    end_idx = len(notification_text)
                    for marker in end_markers:
                        idx = notification_text.find(marker, start_idx)
                        if idx != -1 and idx < end_idx:
                            end_idx = idx
                    
                    message_text = notification_text[start_idx:end_idx].strip()
                    # –£–±–∏—Ä–∞–µ–º markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                    message_text = re.sub(r'\*\*', '', message_text)
                    return message_text
            
            return ""
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            return ""
    
    def _extract_sender_id_from_notification(self, notification_text: str) -> int:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç sender_id –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –æ–Ω –±—ã–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ callback_data –∏–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ)
        """
        try:
            # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ sender_id –≤ —Ç–µ–∫—Å—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            # –û–±—ã—á–Ω–æ –æ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–µ, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á—å –∏–∑ message_id
            # –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å sender_id –≤ callback_data –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–Ω–æ–ø–æ–∫
            # –ü–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None, —Ç–∞–∫ –∫–∞–∫ sender_id –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ callback_data
            return None
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è sender_id: {e}")
            return None
    
    async def _block_sender(self, sender_id: int):
        """
        –ë–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
        """
        try:
            blocked_senders_file = "blocked_senders.json"
            try:
                with open(blocked_senders_file, 'r', encoding='utf-8') as f:
                    blocked_senders = json.load(f)
            except FileNotFoundError:
                blocked_senders = []
            
            # –î–æ–±–∞–≤–ª—è–µ–º sender_id, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
            if sender_id not in blocked_senders:
                blocked_senders.append(sender_id)
                with open(blocked_senders_file, 'w', encoding='utf-8') as f:
                    json.dump(blocked_senders, f, ensure_ascii=False, indent=2)
                logger.warning(f"üö´ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å {sender_id} –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö")
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: {e}")
    
    def _is_sender_blocked(self, sender_id: int) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
        """
        try:
            blocked_senders_file = "blocked_senders.json"
            try:
                with open(blocked_senders_file, 'r', encoding='utf-8') as f:
                    blocked_senders = json.load(f)
                    return sender_id in blocked_senders
            except FileNotFoundError:
                return False
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: {e}")
            return False
    
    def _get_chat_country(self, chat_id: int) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω—É —á–∞—Ç–∞ –ø–æ –µ–≥–æ ID
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç MONITORED_CHATS_BY_COUNTRY –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω—ã
        –ï—Å–ª–∏ —á–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ MONITORED_CHATS_BY_COUNTRY, –Ω–æ –µ—Å—Ç—å –≤ MONITORED_CHATS, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º "bali" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        """
        from config import MONITORED_CHATS_BY_COUNTRY, MONITORED_CHATS
        
        # Telegram –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ID –¥–ª—è –≥—Ä—É–ø–ø/–∫–∞–Ω–∞–ª–æ–≤
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
        chat_id_abs = abs(chat_id) if isinstance(chat_id, int) else abs(int(chat_id))
        
        # –ò—â–µ–º —á–∞—Ç –≤ MONITORED_CHATS_BY_COUNTRY
        for country, chat_ids in MONITORED_CHATS_BY_COUNTRY.items():
            if chat_ids and (chat_id_abs in chat_ids or chat_id in chat_ids or -chat_id_abs in chat_ids):
                # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–∞–Ω—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (bali -> –ë–∞–ª–∏)
                country_mapping = {
                    "bali": "–ë–∞–ª–∏",
                    "thailand": "–¢–∞–∏–ª–∞–Ω–¥",
                    "turkey": "–¢—É—Ä—Ü–∏—è",
                    "georgia": "–ì—Ä—É–∑–∏—è"
                }
                mapped_country = country_mapping.get(country.lower(), country.capitalize())
                logger.info(f"üåç –ß–∞—Ç {chat_id} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ —Å—Ç—Ä–∞–Ω–∞ '{mapped_country}' –∏–∑ MONITORED_CHATS_BY_COUNTRY")
                return mapped_country
        
        # –ï—Å–ª–∏ —á–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ MONITORED_CHATS_BY_COUNTRY, –Ω–æ –µ—Å—Ç—å –≤ MONITORED_CHATS - —ç—Ç–æ –ë–∞–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        if chat_id_abs in MONITORED_CHATS or chat_id in MONITORED_CHATS or -chat_id_abs in MONITORED_CHATS:
            logger.info(f"üåç –ß–∞—Ç {chat_id} –Ω–∞–π–¥–µ–Ω –≤ MONITORED_CHATS, –Ω–æ –Ω–µ –≤ MONITORED_CHATS_BY_COUNTRY, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫ –ë–∞–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)")
            return "–ë–∞–ª–∏"
        
        # –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –£–õ–£–ß–®–ï–ù–ò–ï: –ï—Å–ª–∏ —á–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–æ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —á–∞—Ç–∞ –µ—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
        # –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —á–∞—Ç–æ–≤ –ì—Ä—É–∑–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–µ –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ
        logger.warning(f"üåç –ß–∞—Ç {chat_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏ –≤ MONITORED_CHATS, –Ω–∏ –≤ MONITORED_CHATS_BY_COUNTRY. –í–æ–∑–≤—Ä–∞—â–∞–µ–º None –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.")
        return None
    
    def _get_country_from_chat_title(self, chat_title: str) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ chat_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        """
        if not chat_title:
            return None
        
        chat_title_lower = chat_title.lower()
        
        # –ú–∞–ø–ø–∏–Ω–≥ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —á–∞—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω—ã
        country_keywords = {
            "–ë–∞–ª–∏": ["–±–∞–ª–∏", "bali", "–∏–Ω–¥–æ–Ω–µ–∑–∏", "ubud", "—á–∞–Ω–≥—É", "—Å–µ–º–µ–Ω—å—è–∫", "–∫—É—Ç–∞"],
            "–¢–∞–∏–ª–∞–Ω–¥": ["—Ç–∞–∏–ª–∞–Ω–¥", "thailand", "–ø—Ö—É–∫–µ—Ç", "phuket", "—Å–∞–º—É–∏", "samui", "–ø–∞—Ç—Ç–∞–π", "pattaya"],
            "–¢—É—Ä—Ü–∏—è": ["—Ç—É—Ä—Ü–∏", "turkey", "—Ç—É—Ä–∫", "–∞–Ω—Ç–∞–ª–∏", "antalya", "—Å—Ç–∞–º–±—É–ª", "istanbul"],
            "–ì—Ä—É–∑–∏—è": ["–≥—Ä—É–∑–∏", "georgia", "—Ç–±–∏–ª–∏—Å–∏", "tbilisi", "–±–∞—Ç—É–º–∏", "batumi"]
        }
        
        for country, keywords in country_keywords.items():
            if any(keyword in chat_title_lower for keyword in keywords):
                logger.info(f"üåç –°—Ç—Ä–∞–Ω–∞ '{country}' –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —á–∞—Ç–∞ '{chat_title}'")
                return country
        
        return None

    def _escape_markdown(self, text: str) -> str:
        """
        –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã Markdown –≤ —Ç–µ–∫—Å—Ç–µ, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∫–∞–∫ —Ä–∞–∑–º–µ—Ç–∫–∞
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Telegram Markdown V2
        """
        if not text:
            return text
        
        import re
        
        # –°–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ Markdown, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
        # –í Telegram Markdown V2 –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å: _ * [ ] ( ) ~ ` > # + - = | { } . !
        special_chars = ['_', '*', '[', ']', '(', ')', '~', '`', '>', '#', '+', '-', '=', '|', '{', '}', '.', '!']
        
        escaped = text
        
        # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω
        for char in special_chars:
            # –ó–∞–º–µ–Ω—è–µ–º —Å–∏–º–≤–æ–ª –Ω–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é, –Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º lookbehind —á—Ç–æ–±—ã –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
            pattern = r'(?<!\\)' + re.escape(char)
            escaped = re.sub(pattern, '\\' + char, escaped)
        
        return escaped
    
    def _escape_html(self, text: str) -> str:
        """
        –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã HTML –≤ —Ç–µ–∫—Å—Ç–µ, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∫–∞–∫ —Ä–∞–∑–º–µ—Ç–∫–∞
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Telegram HTML
        """
        if not text:
            return text
        
        # –í Telegram HTML –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å: < > &
        escaped = text
        escaped = escaped.replace('&', '&amp;')
        escaped = escaped.replace('<', '&lt;')
        escaped = escaped.replace('>', '&gt;')
        
        return escaped
    
    def _extract_spam_patterns(self, message_text: str) -> List[str]:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–π
        """
        text_lower = message_text.lower()
        patterns = []
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã
        key_phrases = [
            r'–¥–∏–∑–∞–π–Ω–µ—Ä.*–∫–∞—Ä—Ç–æ—á–µ–∫',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∏—á–Ω—ã–π.*–∫–∞–±–∏–Ω–µ—Ç',
            r'–º–µ–Ω–µ–¥–∂–µ—Ä.*–ª–∫',
            r'–∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫',
            r'–æ–ø—ã—Ç.*–Ω–µ.*–≤–∞–∂–µ–Ω',
            r'–±–µ–∑.*–æ–ø—ã—Ç–∞',
            r'–æ–±—É—á—É.*–Ω–∞—É—á—É',
            r'—Å—Ç—Ä–æ–≥–æ.*–æ—Ç.*18',
            r'–¥–æ—Å—Ç–∏–≥—à–∏–µ.*18',
            r'–æ–ø–ª–∞—á—É.*—Å—Ä–∞–∑—É',
            r'–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.*–ª—Å',
            r'–æ–±—Ä–∞—â–∞—Ç—å—Å—è.*–ª–∏—á–Ω—ã–µ',
        ]
        
        for phrase in key_phrases:
            if re.search(phrase, text_lower, re.IGNORECASE):
                patterns.append(phrase)
        
        return patterns

    def _is_similar_spam_blocked(self, message_text: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ –ø–æ—Ö–æ–∂–µ–µ —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è: –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–∞–∂–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        """
        try:
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–ø–∞–º–∞
            spam_patterns_file = "spam_patterns.json"
            try:
                with open(spam_patterns_file, 'r', encoding='utf-8') as f:
                    saved_patterns = json.load(f)
            except FileNotFoundError:
                saved_patterns = []
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            current_patterns = set(self._extract_spam_patterns(message_text))
            if not current_patterns:
                return False
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
            for saved_item in saved_patterns:
                saved_patterns_set = set(saved_item.get("patterns", []))
                # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Ö–æ—Ç—è –±—ã 1 –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω, –±–ª–æ–∫–∏—Ä—É–µ–º
                if len(current_patterns & saved_patterns_set) >= 1:
                    logger.info(f"üö´ –ü–æ—Ö–æ–∂–µ–µ —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å–æ–≤–ø–∞–¥–∞–µ—Ç {len(current_patterns & saved_patterns_set)} –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º —Å–ø–∞–º–æ–º)")
                    return True
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ feedback_file (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
            feedback_file = "relevance_feedback.json"
            try:
                with open(feedback_file, 'r', encoding='utf-8') as f:
                    feedbacks = json.load(f)
            except FileNotFoundError:
                return False
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ—Ö–æ–∂–∏–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
            blocked_count = 0
            for feedback in feedbacks:
                if feedback.get("is_spam", False):  # –¢–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ —Å–ø–∞–º
                    if "message_text" in feedback:
                        blocked_patterns = set(self._extract_spam_patterns(feedback["message_text"]))
                        # –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç 1+ –ø–∞—Ç—Ç–µ—Ä–Ω, —Å—á–∏—Ç–∞–µ–º –ø–æ—Ö–æ–∂–∏–º (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
                        if len(current_patterns & blocked_patterns) >= 1:
                            blocked_count += 1
                            logger.info(f"üö´ –ü–æ—Ö–æ–∂–µ–µ —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (—Å–æ–≤–ø–∞–¥–∞–µ—Ç {len(current_patterns & blocked_patterns)} –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–∞–º–æ–º)")
                            return True  # –ë–ª–æ–∫–∏—Ä—É–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏
            
            return False
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–π: {e}")
            return False
    
    async def _save_spam_patterns(self, message_text: str, patterns: List[str]):
        """
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        """
        try:
            spam_patterns_file = "spam_patterns.json"
            try:
                with open(spam_patterns_file, 'r', encoding='utf-8') as f:
                    saved_patterns = json.load(f)
            except FileNotFoundError:
                saved_patterns = []
            
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
            new_item = {
                "message_text": message_text[:200],  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
                "patterns": patterns,
                "timestamp": datetime.now().isoformat()
            }
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –ø–æ—Ö–æ–∂–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
            existing = False
            for item in saved_patterns:
                if set(item.get("patterns", [])) == set(patterns):
                    existing = True
                    break
            
            if not existing:
                saved_patterns.append(new_item)
                # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (—Ö—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π)
                if len(saved_patterns) > 100:
                    saved_patterns = saved_patterns[-100:]
                
                with open(spam_patterns_file, 'w', encoding='utf-8') as f:
                    json.dump(saved_patterns, f, ensure_ascii=False, indent=2)
                
                logger.info(f"üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏—è: {len(patterns)} –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤")
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–ø–∞–º–∞: {e}")

    def _is_message_marked_as_not_relevant(self, message_id: str, user_id: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –±—ã–ª –ª–∏ message_id –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        try:
            feedback_file = "relevance_feedback.json"
            try:
                with open(feedback_file, 'r', encoding='utf-8') as f:
                    feedbacks = json.load(f)
            except FileNotFoundError:
                return False
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å —Å —ç—Ç–∏–º message_id –∏ user_id, –≥–¥–µ is_relevant = False
            for feedback in feedbacks:
                if (feedback.get("message_id") == message_id and 
                    feedback.get("user_id") == str(user_id) and 
                    feedback.get("is_relevant") == False):
                    logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
                    return True
            
            return False
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            return False

    def _is_message_globally_blocked(self, message_id: str, spam_threshold: int = 2) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º/–Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ N —Ä–∞–∑)
        
        Args:
            message_id: ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            spam_threshold: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ—Ç–æ–∫ "–Ω–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ" –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2)
        
        Returns:
            True –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ, False –∏–Ω–∞—á–µ
        """
        try:
            feedback_file = "relevance_feedback.json"
            try:
                with open(feedback_file, 'r', encoding='utf-8') as f:
                    feedbacks = json.load(f)
            except FileNotFoundError:
                return False
            
            # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ—Ç–æ–∫ "–Ω–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ" –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            not_relevant_count = 0
            is_spam_marked = False
            
            for feedback in feedbacks:
                if feedback.get("message_id") == message_id:
                    if feedback.get("is_relevant") == False:
                        not_relevant_count += 1
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–º–µ—á–µ–Ω–æ –ª–∏ –∫–∞–∫ —Å–ø–∞–º
                    if feedback.get("is_spam", False):
                        is_spam_marked = True
            
            # –ï—Å–ª–∏ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ø–æ—Ä–æ–≥, –±–ª–æ–∫–∏—Ä—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ
            if is_spam_marked:
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º)")
                return True
            
            if not_relevant_count >= spam_threshold:
                logger.info(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ ({not_relevant_count} –æ—Ç–º–µ—Ç–æ–∫ '–Ω–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ')")
                return True
            
            return False
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            return False

    async def save_relevance_feedback(self, message_id: str, user_id: str, is_relevant: bool, is_spam: bool = False, message_text: str = None, sender_id: int = None):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏"""
        try:
            # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ñ–∞–π–ª
            feedback_data = {
                "message_id": message_id,
                "user_id": user_id,
                "is_relevant": is_relevant,
                "is_spam": is_spam,
                "timestamp": datetime.now().isoformat()
            }
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            if message_text:
                feedback_data["message_text"] = message_text
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º sender_id –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
            if sender_id:
                feedback_data["sender_id"] = sender_id
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö)
            feedback_file = "relevance_feedback.json"
            try:
                with open(feedback_file, 'r', encoding='utf-8') as f:
                    feedbacks = json.load(f)
            except FileNotFoundError:
                feedbacks = []
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –∑–∞–ø–∏—Å–∏ (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
            existing = False
            for i, fb in enumerate(feedbacks):
                if (fb.get("message_id") == message_id and 
                    fb.get("user_id") == str(user_id)):
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å
                    feedbacks[i] = feedback_data
                    existing = True
                    break
            
            if not existing:
                feedbacks.append(feedback_data)
            
            with open(feedback_file, 'w', encoding='utf-8') as f:
                json.dump(feedbacks, f, ensure_ascii=False, indent=2)
            
            logger.info(f"üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å: {feedback_data}")
            
            # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ø–∞–º, –ª–æ–≥–∏—Ä—É–µ–º —ç—Ç–æ
            if is_spam:
                logger.warning(f"üö´ –°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –°–ü–ê–ú –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º {user_id}")
            
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: {e}")

async def main():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telethon –∫–ª–∏–µ–Ω—Ç–∞
    client = TelegramClient('monitor_session', API_ID, API_HASH)
    await client.start()
    logger.info("Telethon –∫–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω")

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∞
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–∫–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    main_bot_token = '8233775715:AAGABqq1Qibf2RmxZm-tB97dtMNxLyqs0y8'
    bot = Bot(token=main_bot_token)
    db = Database(dsn=DB_DSN)
    await db.connect()
    
    # –ü–æ–ª—É—á–∞–µ–º OpenAI API –∫–ª—é—á –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
    import os
    openai_api_key = os.getenv('OPENAI_API_KEY')
    if openai_api_key:
        logger.info("üîë OpenAI API –∫–ª—é—á –Ω–∞–π–¥–µ–Ω, AI –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
    else:
        logger.info("‚ö†Ô∏è OpenAI API –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è")
    
    monitor = MessageMonitor(bot, db, openai_api_key=openai_api_key)
    await monitor.initialize()
    logger.info("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–Ω–∏—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã") 