# üí¨ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–¥–∞–∂ —Å–µ–∫—Ä–µ—Ç–∞—Ä—è Bali: –ù–µ–Ω–∞–≤—è–∑—á–∏–≤–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –±–æ—Ç–∞

## üéØ –¶–µ–ª—å

–°–µ–∫—Ä–µ—Ç–∞—Ä—å –¥–æ–ª–∂–µ–Ω –≤–µ—Å—Ç–∏ —Å–µ–±—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π:
1. **–í—ã—è–≤–ª—è–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏** ‚Äî –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ—è–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å
2. **–î–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã** ‚Äî –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ –º–µ—Ä–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
3. **–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ** ‚Äî –∫–æ–≥–¥–∞ –ø–æ–Ω—è—Ç–Ω–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ—Ç–∞ @Lead_Hunbot

## üìã –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç

–°–µ–∫—Ä–µ—Ç–∞—Ä—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ **–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –Ω–∞ –ë–∞–ª–∏**, –∫–æ—Ç–æ—Ä—ã–π:
- –í–µ–¥–µ—Ç —Å–µ–±—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –∫–∞–∫ —Ä–æ–±–æ—Ç
- –ó–∞–¥–∞–µ—Ç —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ü—Ä–æ—è–≤–ª—è–µ—Ç –∏—Å–∫—Ä–µ–Ω–Ω–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º
- **–ù–ï –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç –±–æ—Ç–∞ —Å—Ä–∞–∑—É**

### –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –±–æ—Ç–∞

–ë–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞:

1. **–ú–∏–Ω–∏–º—É–º 2 –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏** ‚Äî –µ—Å—Ç—å –¥–∏–∞–ª–æ–≥
2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏** ‚Äî —á–µ–ª–æ–≤–µ–∫ —è–≤–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è:
   - –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é (–∞—Ä–µ–Ω–¥–∞, –≤–∏–ª–ª–∞, –∫–≤–∞—Ä—Ç–∏—Ä–∞, –¥–æ–º)
   - –£—Å–ª—É–≥–∞–º–∏ (–±–∞–π–∫, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ, –º–∞–Ω–∏–∫—é—Ä, –∏ —Ç.–¥.)
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ (—Ü–µ–Ω–∞, –≥–¥–µ, –∫–∞–∫, –ø–æ–¥—Ä–æ–±–Ω–µ–µ)

3. **–ü–æ–Ω—è—Ç–Ω–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å** ‚Äî GPT —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫—É –Ω—É–∂–Ω–æ

### –§–æ—Ä–º–∞—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è

–ë–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –≤ –∫–æ–Ω—Ü–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ—Å–ª–µ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:

```
[–ü–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç/—Å–æ–≤–µ—Ç]

–ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –µ—Å—Ç—å —É–¥–æ–±–Ω—ã–π –±–æ—Ç @Lead_Hunbot, –≥–¥–µ —Å–æ–±—Ä–∞–Ω—ã –≤—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ 
–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ [—Ç–µ–º–∞]. –¢–∞–º —Ç—ã —Å–º–æ–∂–µ—à—å –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ —Å–≤—è–∑–∞—Ç—å—Å—è 
—Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏. –û—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é! üòä
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –í `config/niches/bali.json`:

```json
"secretary": {
  "system_prompt": "–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∏ –æ—Ç–∑—ã–≤—á–∏–≤—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –∂–∏–≤–µ—Ç –Ω–∞ –ë–∞–ª–∏...",
  "target_action": {
    "bot_username": "@Lead_Hunbot",
    "bot_link": "https://t.me/Lead_Hunbot",
    "min_messages_before_offer": 2,
    "keywords_for_detection": [...]
  },
  "response_style": {
    "ask_questions": true,
    "show_interest": true,
    "be_natural": true
  }
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **`min_messages_before_offer`**: –ú–∏–Ω–∏–º—É–º –æ–±–º–µ–Ω–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–µ—Ä–µ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –±–æ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2)
- **`keywords_for_detection`**: –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
- **`ask_questions`**: –ó–∞–¥–∞–≤–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- **`show_interest`**: –ü—Ä–æ—è–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏–º–µ—Ä –¥–∏–∞–ª–æ–≥–∞:

**–°–æ–æ–±—â–µ–Ω–∏–µ 1 (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):**
```
–ü—Ä–∏–≤–µ—Ç! –ò—â—É –≤–∏–ª–ª—É –Ω–∞ –ë–∞–ª–∏
```

**–û—Ç–≤–µ—Ç 1 (—Å–µ–∫—Ä–µ—Ç–∞—Ä—å):**
```
–ü—Ä–∏–≤–µ—Ç! –ö—Ä—É—Ç–æ, —á—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –ø–µ—Ä–µ–µ–∑–¥ –Ω–∞ –ë–∞–ª–∏! üòä 
–ê –Ω–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –Ω—É–∂–Ω–∞ –≤–∏–ª–ª–∞? –ò –∫–∞–∫–æ–π —Ä–∞–π–æ–Ω —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—à—å?
```

**–°–æ–æ–±—â–µ–Ω–∏–µ 2 (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):**
```
–ù–∞ 3 –º–µ—Å—è—Ü–∞, —Ö–æ—á—É –≤ –ß–∞–Ω–≥—É
```

**–û—Ç–≤–µ—Ç 2 (—Å–µ–∫—Ä–µ—Ç–∞—Ä—å):**
```
–ß–∞–Ω–≥—É ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! –¢–∞–º –æ—á–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–∞—è —ç–∫—Å–ø–∞—Ç-—Ç—É—Å–æ–≤–∫–∞.
–ù–∞ 3 –º–µ—Å—è—Ü–∞ –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ö–æ—Ä–æ—à–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã. 
–ö–∞–∫–∏–µ-—Ç–æ –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —Ü–µ–Ω–µ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ–º–Ω–∞—Ç?

–ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –µ—Å—Ç—å —É–¥–æ–±–Ω—ã–π –±–æ—Ç @Lead_Hunbot, –≥–¥–µ —Å–æ–±—Ä–∞–Ω—ã –≤—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ 
–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –≤ –ß–∞–Ω–≥—É. –¢–∞–º —Ç—ã —Å–º–æ–∂–µ—à—å –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã 
–∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏. –û—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é! üòä
```

## üìä –õ–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ

### `gpt_handler.py`:

1. **`detect_need_keywords()`** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
2. **`count_conversation_exchanges()`** ‚Äî —Å—á–∏—Ç–∞–µ—Ç –æ–±–º–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
3. **`generate_response()`** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç —Å —É—á–µ—Ç–æ–º:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±–º–µ–Ω–æ–≤
   - –ù–∞–ª–∏—á–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–π GPT –æ —Ç–æ–º, –∫–æ–≥–¥–∞ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–æ—Ç–∞

### –£–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è GPT:

GPT –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é:
- –ï—Å–ª–∏ –¥–∏–∞–ª–æ–≥ —Ä–∞–∑–≤–∏–ª—Å—è (‚â•2 —Å–æ–æ–±—â–µ–Ω–∏—è) –ò –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ ‚Üí –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–æ—Ç–∞
- –ï—Å–ª–∏ —Ä–∞–Ω–æ (<2 —Å–æ–æ–±—â–µ–Ω–∏–π) ‚Üí —Å–Ω–∞—á–∞–ª–∞ –≤—ã—è—Å–Ω–∏—Ç—å –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

1. **–ù–µ–Ω–∞–≤—è–∑—á–∏–≤–æ—Å—Ç—å** ‚Äî –±–æ—Ç –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
2. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî —Å–µ–∫—Ä–µ—Ç–∞—Ä—å –≤–µ–¥–µ—Ç —Å–µ–±—è –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫
3. **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å** ‚Äî –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–æ–Ω—è—Ç–Ω–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å
4. **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî GPT —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–æ–≥–¥–∞ —É–º–µ—Å—Ç–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–æ—Ç–∞
5. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** ‚Äî –≤—ã—à–µ –∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:

1. **–ò–∑–º–µ–Ω–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π:**
   ```json
   "min_messages_before_offer": 3  // –≤–º–µ—Å—Ç–æ 2
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:**
   ```json
   "keywords_for_detection": ["–Ω–æ–≤–æ–µ_–∫–ª—é—á–µ–≤–æ–µ_—Å–ª–æ–≤–æ", ...]
   ```

3. **–ò–∑–º–µ–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç:**
   ```json
   "system_prompt": "–¢–≤–æ–π –Ω–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç..."
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ–∫—Ä–µ—Ç–∞—Ä—è:**
   ```bash
   docker-compose restart secretary
   ```

---

*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-01-11*
