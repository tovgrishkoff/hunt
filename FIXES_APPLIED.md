# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

**–î–∞—Ç–∞:** 2026-01-10

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ Account Manager - DetachedInstanceError (–ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ1)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ `group.username` –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏ –ë–î

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `username` –∏ `id` –î–û –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä—É–ø–ø—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `db.refresh(group)` –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–§–∞–π–ª:** `services/account-manager/joiner.py`

---

### 2. ‚úÖ Account Manager - –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ (–ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ1)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å—Ç—É–ø–∞–ª —Ç–æ–ª—å–∫–æ –≤ 1 –≥—Ä—É–ø–ø—É –∑–∞ —Å–ª–æ—Ç (2 —á–∞—Å–∞)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: **3-5 –≥—Ä—É–ø–ø –∑–∞ —Å–ª–æ—Ç** –≤–º–µ—Å—Ç–æ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- –ü–∞—É–∑–∞ –º–µ–∂–¥—É –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏: **300-600 —Å–µ–∫—É–Ω–¥ (5-10 –º–∏–Ω—É—Ç)** –≤–º–µ—Å—Ç–æ 300-900
- –û–±—Ä–∞–±–æ—Ç–∫–∞ FloodWait: –ø—Ä–æ–ø—É—Å–∫ –≥—Ä—É–ø–ø—ã, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: `[1/5]`, `[2/5]` –∏ —Ç.–¥.

**–§–∞–π–ª:** `services/account-manager/joiner.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –∑–∞ —Å–ª–æ—Ç –≤—Å—Ç—É–ø–∏—Ç –≤ 3-5 –≥—Ä—É–ø–ø –≤–º–µ—Å—Ç–æ 1

---

### 3. ‚úÖ Marketer - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–µ—Ä–µ–¥ –ø–æ—Å—Ç–∏–Ω–≥–æ–º (–ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ3)

**–ü—Ä–æ–±–ª–µ–º–∞:** 94 –Ω–µ—É–¥–∞—á–∏ "Write forbidden" - –±–æ—Ç—ã –ø—ã—Ç–∞–ª–∏—Å—å –ø–æ—Å—Ç–∏—Ç—å, –Ω–µ –±—É–¥—É—á–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `check_can_post_permissions`:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–∞—Å—Ç–∏—è –≤ —á–∞—Ç–µ —á–µ—Ä–µ–∑ `get_permissions`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `banned_rights`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `default_banned_rights`
- –ì—Ä—É–ø–ø—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ `banned` –∏–ª–∏ `inaccessible` —Å—Ä–∞–∑—É –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ
- –ù–µ —Ç—Ä–∞—Ç—è—Ç—Å—è —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ —Ö–æ–ª–æ—Å—Ç—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ—Å—Ç–∏–Ω–≥–∞

**–§–∞–π–ª:** `services/marketer/poster.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ "Write forbidden", –≥—Ä—É–ø–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ

---

### 4. ‚úÖ Activity - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ4)

**–ü—Ä–æ–±–ª–µ–º–∞:** "–ö–ª–∏–µ–Ω—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω" - –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `ensure_client_connected`
- –ü—Ä–æ–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å

**–§–∞–π–ª:** `services/activity/story_viewer.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Activity —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏

---

### 5. ‚úÖ –°–∫—Ä–∏–ø—Ç –†–µ–≤–∏–∑–æ—Ä –≥—Ä—É–ø–ø (–ü–†–ò–û–†–ò–¢–ï–¢ ‚Ññ2)

**–°–æ–∑–¥–∞–Ω:** `scripts/group_reviewer.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø –≤ –ë–î
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –∞–∫–∫–∞—É–Ω—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –ø–æ—Å—Ç–∏–Ω–≥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä—É–ø–ø—ã:
  - `banned` - –µ—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –ø–æ—Å—Ç–∏—Ç—å
  - `inaccessible` - –µ—Å–ª–∏ –Ω–µ —É—á–∞—Å—Ç–Ω–∏–∫ –∏–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
cd /home/tovgrishkoff/PIAR/telegram_promotion_system_bali
DATABASE_URL=postgresql://telegram_user_bali:telegram_password_bali@localhost:5438/telegram_promotion_bali \
python3 scripts/group_reviewer.py
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–ø—É—Å–∫–∞—Ç—å —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ë–î –æ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥—Ä—É–ø–ø

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Account Manager:**
   - –í—Å—Ç—É–ø–∏—Ç –≤ **3-5 –≥—Ä—É–ø–ø –∑–∞ —Å–ª–æ—Ç** –≤–º–µ—Å—Ç–æ 1
   - –ó–∞ –¥–µ–Ω—å (4 —Å–ª–æ—Ç–∞) = **12-20 –≥—Ä—É–ø–ø** –≤–º–µ—Å—Ç–æ 4
   - –ù–µ—Ç –æ—à–∏–±–æ–∫ DetachedInstanceError

2. **Marketer:**
   - –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ "Write forbidden"
   - –ì—Ä—É–ø–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ
   - –ë–æ–ª—å—à–µ —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤

3. **Activity:**
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
   - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç Stories —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã:**
   ```bash
   cd /home/tovgrishkoff/PIAR/telegram_promotion_system_bali
   docker-compose restart account-manager activity marketer
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –†–µ–≤–∏–∑–æ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   ```bash
   DATABASE_URL=postgresql://telegram_user_bali:telegram_password_bali@localhost:5438/telegram_promotion_bali \
   python3 scripts/group_reviewer.py
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```bash
   docker-compose logs -f account-manager marketer
   ```

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã: 2026-01-10*
